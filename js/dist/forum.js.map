{"version":3,"sources":["webpack://@fof/byobu/webpack/bootstrap","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/byobu/external \"flarum.core.compat['extend']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/ItemList']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/User']\"","webpack://@fof/byobu/external \"flarum.core.compat['Model']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Button']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/Group']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/Discussion']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Notification']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LinkButton']\"","webpack://@fof/byobu/external \"flarum.core.compat['states/DiscussionListState']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/IndexPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Badge']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/EventPost']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/extract']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/username']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/highlight']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/UserPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/SettingsPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Switch']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/classList']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/listItems']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionListItem']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionHero']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/DiscussionControls']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Modal']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/Stream']\"","webpack://@fof/byobu/external \"flarum.core.compat['states/SearchState']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Search']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/avatar']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/extractText']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LoadingIndicator']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/UserControls']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionComposer']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Dropdown']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionList']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LogInModal']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/NotificationGrid']\"","webpack://@fof/byobu/./src/forum/events/RecipientLeft.js","webpack://@fof/byobu/./src/forum/pages/labels/recipientLabel.js","webpack://@fof/byobu/./src/forum/pages/labels/recipientsLabel.js","webpack://@fof/byobu/./src/forum/events/RecipientsModified.js","webpack://@fof/byobu/./src/forum/extend/SettingsPage.js","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/byobu/./src/forum/search/sources/UserSearchSource.js","webpack://@fof/byobu/./src/forum/search/sources/GroupSearchSource.js","webpack://@fof/byobu/./src/forum/search/RecipientSearch.js","webpack://@fof/byobu/./src/forum/modals/AddRecipientModal.js","webpack://@fof/byobu/./src/forum/extend/Discussion.js","webpack://@fof/byobu/./src/forum/pages/discussions/PrivateDiscussionComposer.js","webpack://@fof/byobu/./src/forum/pages/labels/recipientCountLabel.js","webpack://@fof/byobu/./src/forum/extend/User.js","webpack://@fof/byobu/./src/forum/extend/index.js","webpack://@fof/byobu/./src/forum/states/PrivateDiscussionListState.js","webpack://@fof/byobu/./src/forum/pages/discussions/PrivateDiscussionList.js","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://@fof/byobu/./src/forum/pages/PrivateComposing.js","webpack://@fof/byobu/./src/forum/pages/PrivateDiscussionsUserPage.js","webpack://@fof/byobu/./src/forum/pages/index.js","webpack://@fof/byobu/./src/forum/pages/routes.js","webpack://@fof/byobu/./src/forum/pages/PrivateDiscussionsPage.js","webpack://@fof/byobu/./src/forum/notifications/PrivateDiscussionNotification.js","webpack://@fof/byobu/./src/forum/notifications/PrivateDiscussionReplyNotification.js","webpack://@fof/byobu/./src/forum/notifications/PrivateDiscussionUserLeftNotification.js","webpack://@fof/byobu/./src/forum/notifications/PrivateDiscussionAddedNotification.js","webpack://@fof/byobu/./src/forum/notifications/index.js","webpack://@fof/byobu/./src/forum/index.js","webpack://@fof/byobu/./src/forum/events/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_inheritsLoose","subClass","superClass","constructor","__proto__","flarum","core","compat","RecipientLeft","initAttrs","attrs","icon","app","forum","data","attributes","descriptionKey","EventPost","recipientLabel","recipient","label","style","className","href","extract","User","username","title","route","user","Group","namePlural","translator","trans","LinkButton","component","recipientsLabel","recipients","children","link","forEach","push","RecipientsModified","diff","diff1","diff2","store","filter","item","indexOf","map","id","getById","content","post","length","usersAdded","usersRemoved","groupsAdded","groupsRemoved","added","concat","removed","oldRecipients","newRecipients","localeBase","this","descriptionData","extend","SettingsPage","items","add","Switch","state","blocksPd","onchange","blocksPdLoading","save","then","redraw","loading","privacyToggle","unifiedIndex","unifiedIndexLoading","unifiedIndexToggle","_extends","assign","target","arguments","source","apply","UserSearchSource","view","query","cache","byobuResults","highlight","text","data-index","avatar","undefined","find","q","page","limit","pushResults","results","payload","result","GroupSearchSource","search","toLowerCase","all","group","substr","groupName","class","RecipientSearch","oncreate","vnode","$search","$","on","e","addRecipient","focus","parentNode","clearTimeout","typingTimer","doSearch","setTimeout","getValue","setValue","sources","sourceItems","toArray","selected","onclick","removeRecipient","classList","open","focused","active","loadingSources","dom","type","placeholder","extractText","oninput","onfocus","hasFocus","onblur","in","LoadingIndicator","size","ItemList","discussion","attribute","canEditUserRecipients","canEditGroupRecipients","values","split","findRecipient","clear","preventDefault","remove","Search","AddRecipientModal","oninit","Stream","assignInitialRecipients","selectedRecipients","merge","session","recipientSearch","SearchState","isDismissible","recipientUsers","recipientGroups","helpText","Button","hide","select","metaKey","ctrlKey","index","submit","onsubmit","relationships","current","DiscussionPage","stream","update","modal","close","composer","show","Modal","Discussion","Model","hasMany","oldRecipientUsers","oldRecipientGroups","canEditRecipients","badges","Badge","DiscussionListItem","DiscussionHero","params","include","DiscussionListState","controls","long","DiscussionControls","history","back","PrivateDiscussionComposer","fields","param","addDefaultRecipients","users","groups","tags","chooseRecipients","headerItems","count","transChoice","recipientCountLabel","getBy","createRecord","discussionList","refresh","set","loaded","DiscussionComposer","cannotBeDirectMessaged","unreadPrivateMessagesCount","UserControls","Promise","resolve","load","titlePlaceholder","submitLabel","message","UserPage","sharedMessageHistory","PrivateDiscussionLisState","PrivateDiscussionList","DiscussionList","_defineProperties","props","descriptor","configurable","writable","PrivateComposing","Constructor","protoProps","staticProps","action","reject","LogInModal","itemClassName","disabled","canStartDiscussion","PrivateDiscussionsUserPage","changeSort","list","PrivateDiscussionListState","sort","handleChangeSort","loadUser","listItems","actionItems","viewItems","composing","sortMap","sortOptions","Dropdown","buttonClassName","keys","routes","byobuUserPrivate","path","byobuPrivate","IndexPage","setTitle","compose","replace","PrivateDiscussionsPage","PrivateDiscussionNotification","notification","subject","fromUser","Notification","PrivateDiscussionReplyNotification","postNumber","PrivateDiscussionUserLeftNotification","PrivateDiscussionAddedNotification","grid","NotificationGrid","initializers","postComponents","recipientsModified","recipientLeft","events","pages","notificationComponents","byobuPrivateDiscussionCreated","byobuPrivateDiscussionReplied","PrivateDiscussionRepliedNotification","byobuRecipientRemoved","byobuPrivateDiscussionAdded","notifications"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 43);\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['models/User'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['models/Group'];","module.exports = flarum.core.compat['models/Discussion'];","module.exports = flarum.core.compat['components/Notification'];","module.exports = flarum.core.compat['components/LinkButton'];","module.exports = flarum.core.compat['states/DiscussionListState'];","module.exports = flarum.core.compat['components/IndexPage'];","module.exports = flarum.core.compat['components/Badge'];","module.exports = flarum.core.compat['components/EventPost'];","module.exports = flarum.core.compat['utils/extract'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['helpers/highlight'];","module.exports = flarum.core.compat['components/UserPage'];","module.exports = flarum.core.compat['components/SettingsPage'];","module.exports = flarum.core.compat['components/Switch'];","module.exports = flarum.core.compat['utils/classList'];","module.exports = flarum.core.compat['helpers/listItems'];","module.exports = flarum.core.compat['components/DiscussionListItem'];","module.exports = flarum.core.compat['components/DiscussionHero'];","module.exports = flarum.core.compat['utils/DiscussionControls'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['utils/Stream'];","module.exports = flarum.core.compat['states/SearchState'];","module.exports = flarum.core.compat['components/Search'];","module.exports = flarum.core.compat['helpers/avatar'];","module.exports = flarum.core.compat['utils/extractText'];","module.exports = flarum.core.compat['components/LoadingIndicator'];","module.exports = flarum.core.compat['utils/UserControls'];","module.exports = flarum.core.compat['components/DiscussionComposer'];","module.exports = flarum.core.compat['components/Dropdown'];","module.exports = flarum.core.compat['components/DiscussionList'];","module.exports = flarum.core.compat['components/LogInModal'];","module.exports = flarum.core.compat['components/NotificationGrid'];","import EventPost from \"flarum/components/EventPost\";\n\nexport default class RecipientLeft extends EventPost {\n    static initAttrs(attrs) {\n        super.initAttrs(attrs);\n    }\n\n    icon() {\n        return app.forum.data.attributes['byobu.icon-postAction'];\n    }\n\n    descriptionKey() {\n        return 'fof-byobu.forum.post.recipients_modified.removed_self';\n    }\n}\n","import extract from 'flarum/utils/extract';\nimport username from 'flarum/helpers/username';\nimport User from 'flarum/models/User';\nimport Group from 'flarum/models/Group';\nimport LinkButton from 'flarum/components/LinkButton';\n\nexport default function recipientLabel(recipient, attrs = {}) {\n    attrs.style = attrs.style || {};\n    attrs.className = 'RecipientLabel ' + (attrs.className || '');\n    attrs.href = extract(attrs, 'link');\n\n    let label;\n\n    if (recipient instanceof User) {\n        label = username(recipient);\n\n        if (attrs.href) {\n            attrs.title = recipient.username() || '';\n            attrs.href = app.route.user(recipient);\n        }\n    } else if (recipient instanceof Group) {\n        label = recipient.namePlural();\n    } else {\n        attrs.className += ' none';\n        label = app.translator.trans('fof-byobu.forum.labels.user_deleted');\n    }\n\n    return LinkButton.component(attrs, label);\n}\n","import extract from 'flarum/utils/extract';\nimport recipientLabel from './recipientLabel';\n\nexport default function recipientsLabel(recipients, attrs = {}) {\n    const children = [];\n    const link = extract(attrs, 'link');\n\n    attrs.className = 'RecipientsLabel ' + (attrs.className || '');\n\n    if (recipients) {\n        recipients.forEach((recipient) => {\n            children.push(recipientLabel(recipient, { link }));\n        });\n    } else {\n        children.push(recipientLabel());\n    }\n\n    return <span {...attrs}>{children}</span>;\n}\n","import EventPost from \"flarum/components/EventPost\";\nimport recipientsLabel from \"../pages/labels/recipientsLabel\";\n\nexport default class RecipientsModified extends EventPost {\n    static initAttrs(attrs) {\n        super.initAttrs(attrs);\n\n        function diff(diff1, diff2, store) {\n            return diff1.filter((item) => diff2.indexOf(item) === -1).map((id) => app.store.getById(store, id));\n        }\n\n        const content = attrs.post.content();\n\n        // For event posts existing before groups functionality.\n        if (!content['new'] && content.length == 2) {\n            const oldRecipients = attrs.post.content()[0];\n            const newRecipients = attrs.post.content()[1];\n            attrs.added = diff(newRecipients, oldRecipients, 'users');\n            attrs.removed = diff(oldRecipients, newRecipients, 'users');\n        } else {\n            let usersAdded = diff(content['new']['users'], content['old']['users'], 'users');\n            let usersRemoved = diff(content['old']['users'], content['new']['users'], 'users');\n            let groupsAdded = diff(content['new']['groups'], content['old']['groups'], 'groups');\n            let groupsRemoved = diff(content['old']['groups'], content['new']['groups'], 'groups');\n\n            attrs.added = usersAdded.concat(groupsAdded);\n            attrs.removed = usersRemoved.concat(groupsRemoved);\n        }\n    }\n\n    icon() {\n        return app.forum.data.attributes['byobu.icon-postAction'];\n    }\n\n    descriptionKey() {\n        var localeBase = 'fof-byobu.forum.post.recipients_modified.';\n\n        if (this.attrs.added.length) {\n            if (this.attrs.removed.length) {\n                return localeBase + 'added_and_removed';\n            }\n\n            return localeBase + 'added';\n        }\n\n        return localeBase + 'removed';\n    }\n\n    descriptionData() {\n        const data = {};\n\n        if (this.attrs.added.length) {\n            data.added = recipientsLabel(this.attrs.added, { link: true });\n        }\n\n        if (this.attrs.removed.length) {\n            data.removed = recipientsLabel(this.attrs.removed, { link: true });\n        }\n\n        return data;\n    }\n}\n","import { extend } from 'flarum/extend';\nimport SettingsPage from 'flarum/components/SettingsPage';\nimport Switch from 'flarum/components/Switch';\n\nexport default (app) => {\n    privacyToggle(app);\n    unifiedIndexToggle(app);\n}\n\nfunction unifiedIndexToggle(app) {\n    extend(SettingsPage.prototype, 'privacyItems', function (items) {\n        items.add(\n            'byobu-unified-index',\n            Switch.component({\n                state: this.user.unifiedIndex(),\n                onchange: (value) => {\n                    this.unifiedIndexLoading = true;\n\n                    this.user.save({ unifiedIndex: value }).then(() => {\n                        this.unifiedIndexLoading = false;\n                        m.redraw();\n                    });\n                },\n                loading: this.unifiedIndexLoading\n            }, app.translator.trans('fof-byobu.forum.user.settings.unified_index'))\n        );\n    });\n}\n\nfunction privacyToggle(app) {\n    extend(SettingsPage.prototype, 'privacyItems', function (items) {\n        items.add(\n            'byobu-block-dm',\n            Switch.component({\n                state: this.user.blocksPd(),\n                onchange: (value) => {\n                    this.blocksPdLoading = true;\n\n                    this.user.save({ blocksPd: value }).then(() => {\n                        this.blocksPdLoading = false;\n                        m.redraw();\n                    });\n                },\n                loading: this.blocksPdLoading\n            }, app.translator.trans('fof-byobu.forum.user.settings.block_pd'))\n        );\n    });\n}\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","import highlight from 'flarum/helpers/highlight';\nimport avatar from 'flarum/helpers/avatar';\nimport username from 'flarum/helpers/username';\n\nexport default class UserSearchSource {\n    view(query) {\n        if (query.length < 3 || this.loading) return;\n\n        if (!app.cache.byobuResults) {\n            app.cache.byobuResults = [];\n        }\n\n        this.query = query;\n\n        if (!app.cache.byobuResults[this.query]) {\n            this.loading = true;\n\n            app.cache.byobuResults[this.query] = [];\n            app.store\n                .find('users', {\n                    filter: { q: this.query + ' allows-pd' },\n                    page: { limit: 5 },\n                })\n                .then(this.pushResults.bind(this));\n        } else\n            return [\n                <li className=\"Dropdown-header\">{app.translator.trans('core.forum.search.users_heading')}</li>,\n                app.cache.byobuResults[this.query].map((user) => {\n                    const name = username(user);\n                    const children = [highlight(name.text, this.query)];\n\n                    return (\n                        <li className=\"SearchResult\" data-index={'users:' + user.id()}>\n                            <a data-index={'users:' + user.id()}>\n                                {avatar(user)}\n                                {{...name, text: undefined, children}}\n                            </a>\n                        </li>\n                    );\n                }),\n            ];\n    }\n\n    pushResults(results) {\n        results.payload.data.map((result) => {\n            var user = app.store.getById('users', result.id);\n            app.cache.byobuResults[this.query].push(user);\n        });\n        this.loading = false;\n        m.redraw();\n    }\n}\n","import highlight from 'flarum/helpers/highlight';\n\nexport default class GroupSearchSource {\n    search(query) {\n        return app.store.find('groups', {\n            filter: { q: query },\n            page: { limit: 5 },\n        });\n    }\n\n    view(query) {\n        query = query.toLowerCase();\n\n        const results = app.store.all('groups').filter((group) => group.namePlural().toLowerCase().substr(0, query.length) === query);\n\n        if (!results.length) return '';\n\n        return [\n            <li className=\"Dropdown-header\">{app.translator.trans('fof-byobu.forum.search.headings.groups')}</li>,\n            results.map((group) => {\n                const groupName = group.namePlural();\n                var name = highlight(groupName, query);\n\n                return (\n                    <li className=\"SearchResult\" data-index={'groups:' + group.id()}>\n                        <a data-index={'groups:' + group.id()}>\n                            <span class=\"groupName\">{name}</span>\n                        </a>\n                    </li>\n                );\n            }),\n        ];\n    }\n}\n","import Search from 'flarum/components/Search';\nimport UserSearchSource from './sources/UserSearchSource';\nimport GroupSearchSource from './sources/GroupSearchSource';\nimport ItemList from 'flarum/utils/ItemList';\nimport classList from 'flarum/utils/classList';\nimport extractText from 'flarum/utils/extractText';\nimport LoadingIndicator from 'flarum/components/LoadingIndicator';\nimport recipientLabel from '../pages/labels/recipientLabel';\nimport User from 'flarum/models/User';\nimport Group from 'flarum/models/Group';\n\nexport default class RecipientSearch extends Search {\n    oncreate(vnode) {\n        super.oncreate(vnode);\n\n        const $search = this;\n\n        this.$('.Search-results').on('click', (e) => {\n            const target = this.$('.SearchResult.active');\n\n            $search.addRecipient(target.data('index'));\n            $search.$('.RecipientsInput').focus();\n        });\n\n        this.$('.Search-results').on('touchstart', (e) => {\n            const target = this.$(e.target.parentNode);\n\n            $search.addRecipient(target.data('index'));\n            $search.$('.RecipientsInput').focus();\n        });\n\n        $('.RecipientsInput')\n            .on('keyup', () => {\n                clearTimeout(this.typingTimer);\n                this.doSearch = false;\n                this.typingTimer = setTimeout(() => {\n                    this.doSearch = true;\n                    m.redraw();\n                }, 900);\n            })\n            .on('keydown', () => {\n                clearTimeout(this.typingTimer);\n            });\n\n\n        super.oncreate(vnode);\n    }\n\n    view() {\n        if (typeof this.state.getValue() === 'undefined') {\n            this.state.setValue('');\n        }\n\n        const loading = this.state.getValue() && this.state.getValue().length >= 3;\n\n        if (!this.sources) {\n            this.sources = this.sourceItems().toArray();\n        }\n\n        return m(\n            'div',\n            {\n                className: 'AddRecipientModal-form-input',\n            },\n            [\n                m(\n                    'div',\n                    {\n                        className: 'RecipientsInput-selected RecipientsLabel',\n                    },\n                    this.attrs\n                        .selected()\n                        .toArray()\n                        .map((recipient) =>\n                            recipientLabel(recipient, {\n                                onclick: (e) => this.removeRecipient(recipient, e)\n                            })\n                        )\n                ),\n                m('input', {\n                    className:\n                        'RecipientsInput FormControl ' +\n                        classList({\n                            open: !!this.state.getValue(),\n                            focused: !!this.state.getValue(),\n                            active: !!this.state.getValue(),\n                            loading: !!this.loadingSources,\n                        }),\n                    oncreate: function (vnode) {\n                        vnode.dom.focus();\n                    },\n                    type: 'search',\n                    placeholder: extractText(app.translator.trans('fof-byobu.forum.input.search_recipients')),\n                    value: this.state.getValue(),\n                    oninput: e => this.state.setValue(e.target.value),\n                    onfocus: () => (this.hasFocus = true),\n                    onblur: () => (this.hasFocus = false),\n                }),\n                m(\n                    'ul',\n                    {\n                        className:\n                            'Dropdown-menu Search-results fade ' +\n                            classList({\n                                in: !!loading,\n                            }),\n                    },\n                    !this.doSearch\n                        ? LoadingIndicator.component({ size: 'tiny', className: 'Button Button--icon Button--link' })\n                        : this.sources.map((source) => source.view(this.state.getValue()))\n                ),\n            ]\n        );\n    }\n\n    /**\n     * Build an item list of SearchSources.\n     *\n     * @return {ItemList}\n     */\n    sourceItems() {\n        const items = new ItemList();\n\n        // Add user source based on permissions.\n        if (\n            (!this.attrs.discussion && app.forum.attribute('canStartPrivateDiscussionWithUsers')) ||\n            (this.attrs.discussion && this.attrs.discussion.canEditUserRecipients())\n        ) {\n            items.add('users', new UserSearchSource());\n        }\n\n        // Add group source based on permissions.\n        if (\n            (!this.attrs.discussion && app.forum.attribute('canStartPrivateDiscussionWithGroups')) ||\n            (this.attrs.discussion && this.attrs.discussion.canEditGroupRecipients())\n        ) {\n            items.add('groups', new GroupSearchSource());\n        }\n\n        return items;\n    }\n\n    /**\n     * Adds a recipient.\n     *\n     * @param value\n     */\n    addRecipient(value) {\n        let values = value.split(':'),\n            type = values[0],\n            id = values[1];\n\n        let recipient = this.findRecipient(type, id);\n\n        this.attrs.selected().add(value, recipient);\n\n        this.state.clear();\n    }\n\n    /**\n     * Removes a recipient.\n     *\n     * @param recipient\n     */\n    removeRecipient(recipient, e) {\n        e.preventDefault();\n\n        let type;\n\n        if (recipient instanceof User) {\n            type = 'users';\n        }\n        if (recipient instanceof Group) {\n            type = 'groups';\n        }\n\n        this.attrs.selected().remove(type + ':' + recipient.id());\n    }\n\n    /**\n     * Loads a recipient from the global store.\n     *\n     * @param store\n     * @param id\n     * @returns {Model}\n     */\n    findRecipient(store, id) {\n        return app.store.getById(store, id);\n    }\n}\n","import Modal from 'flarum/components/Modal';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\nimport Button from 'flarum/components/Button';\nimport ItemList from 'flarum/utils/ItemList';\nimport Stream from 'flarum/utils/Stream';\nimport SearchState from 'flarum/states/SearchState';\nimport RecipientSearch from '../search/RecipientSearch';\nimport User from 'flarum/models/User';\nimport Group from 'flarum/models/Group';\n\nexport default class AddRecipientModal extends Modal {\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.selected = Stream(new ItemList());\n\n        if (this.attrs.discussion) {\n            // Adds recipients of the currently viewed discussion.\n            this.assignInitialRecipients(this.attrs.discussion);\n        } else if (this.attrs.selectedRecipients && this.attrs.selectedRecipients.toArray().length > 0) {\n            // Adds previously selected recipients.\n            this.selected().merge(this.attrs.selectedRecipients);\n        } else {\n            // Adds the current user in case there are no selected recipients yet and this is a new discussion.\n            this.selected().add('users:' + app.session.user.id(), app.session.user);\n        }\n\n        this.recipientSearch = new SearchState;\n    }\n\n    isDismissible() {\n        return false;\n    }\n\n    assignInitialRecipients(discussion) {\n        discussion.recipientUsers().map((user) => {\n            this.selected().add('users:' + user.id(), user);\n        });\n        discussion.recipientGroups().map((group) => {\n            this.selected().add('groups:' + group.id(), group);\n        });\n    }\n\n    className() {\n        return 'AddRecipientModal';\n    }\n\n    title() {\n        return this.attrs.discussion\n            ? app.translator.trans('fof-byobu.forum.modal.titles.update_recipients', { title: <em>{this.attrs.discussion.title()}</em> })\n            : app.translator.trans('fof-byobu.forum.modal.titles.add_recipients');\n    }\n\n    helpText() {\n        return this.attrs.discussion\n            ? app.translator.trans('fof-byobu.forum.modal.help.update_recipients')\n            : app.translator.trans('fof-byobu.forum.modal.help.add_recipients');\n    }\n\n    content() {\n        return [\n            <div className=\"Modal-body\">\n                <div class=\"AddRecipientModal-help\">{this.helpText()}</div>\n                <div className=\"AddRecipientModal-form\">\n                    {RecipientSearch.component({\n                        state: this.recipientSearch,\n                        selected: this.selected,\n                        discussion: this.attrs.discussion,\n                    })}\n                    <div className=\"AddRecipientModal-form-submit App-primaryControl\">\n                        {Button.component({\n                            type: 'submit',\n                            className: 'Button Button--primary',\n                            icon: 'fas fa-check',\n                        }, app.translator.trans('fof-byobu.forum.buttons.submit'))}\n                        {Button.component({\n                            onclick: this.hide.bind(this),\n                            className: 'Button Button--cancel',\n                        }, app.translator.trans('fof-byobu.forum.buttons.cancel'))}\n                    </div>\n                </div>\n            </div>,\n        ];\n    }\n\n    select(e) {\n        // Ctrl + Enter submits the selection, just Enter completes the current entry\n        if (e.metaKey || e.ctrlKey || this.selected.indexOf(this.index) !== -1) {\n            if (this.selected().length) {\n                this.$('form').submit();\n            }\n        }\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        const discussion = this.attrs.discussion;\n        const recipients = this.selected();\n\n        let recipientGroups = [];\n        let recipientUsers = [];\n\n        recipients.toArray().forEach((recipient) => {\n            if (recipient instanceof User) {\n                recipientUsers.push(recipient);\n            }\n            if (recipient instanceof Group) {\n                recipientGroups.push(recipient);\n            }\n        });\n\n        // Recipients are updated here for existing discussions here.\n        if (discussion) {\n            discussion.save({ relationships: { recipientUsers, recipientGroups } }).then(() => {\n                if (app.current instanceof DiscussionPage) {\n                    app.current.stream.update();\n                }\n                m.redraw();\n            });\n        }\n\n        // Use the onsubmit callback to trigger an update in the DiscussionComposer\n        if (this.attrs.onsubmit) this.attrs.onsubmit(recipients);\n\n        app.modal.close();\n\n        if (! this.attrs.discussion) {\n            app.composer.show();\n        }\n\n        e.redraw = false;\n    }\n}\n","import { extend } from 'flarum/extend';\nimport Model from 'flarum/Model';\nimport Badge from 'flarum/components/Badge';\nimport Discussion from 'flarum/models/Discussion';\nimport User from 'flarum/models/User';\nimport Group from 'flarum/models/Group';\nimport Button from 'flarum/components/Button';\nimport DiscussionListItem from 'flarum/components/DiscussionListItem';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\nimport DiscussionHero from 'flarum/components/DiscussionHero';\nimport DiscussionListState from 'flarum/states/DiscussionListState';\nimport recipientsLabel from '../pages/labels/recipientsLabel';\nimport DiscussionControls from 'flarum/utils/DiscussionControls';\nimport ItemList from 'flarum/utils/ItemList';\nimport AddRecipientModal from './../modals/AddRecipientModal';\n\nexport default (app) => {\n    attributes();\n    badges(app);\n    index();\n    hero();\n    apiInclude();\n    controls();\n}\n\nconst add = function (discussion, items, long) {\n    let recipients = [];\n\n    if (discussion.recipientUsers().length) {\n        recipients = recipients.concat(discussion.recipientUsers());\n    }\n\n    if (discussion.recipientGroups().length) {\n        recipients = recipients.concat(discussion.recipientGroups());\n    }\n\n    if (recipients && recipients.length) {\n        if (long) {\n            items.add('recipients', recipientsLabel(recipients), 10);\n        } else {\n            items.add('recipients', recipientsLabel(recipients, { link: true }), 4);\n        }\n    }\n};\n\nfunction badges(app) {\n    extend(Discussion.prototype, 'badges', function (badges) {\n        if (this.recipientUsers().length || this.recipientGroups().length) {\n            badges.add(\n                'private',\n                Badge.component({\n                    type: 'private',\n                    label: app.translator.trans('fof-byobu.forum.badges.is_private.tooltip'),\n                    icon: app.forum.data.attributes['byobu.icon-badge'],\n                }),\n                10\n            );\n        }\n    });\n}\n\nfunction index() {\n    extend(DiscussionListItem.prototype, 'infoItems', function (items) {\n        const discussion = this.attrs.discussion;\n\n        add(discussion, items, true);\n    });\n}\n\nfunction hero() {\n    extend(DiscussionHero.prototype, 'items', function (items) {\n        const discussion = this.attrs.discussion;\n\n        add(discussion, items, false);\n    });\n}\n\nfunction apiInclude() {\n    extend(DiscussionPage.prototype, 'params', function (params) {\n        params.include.push('recipientUsers');\n        params.include.push('recipientGroups');\n    });\n    extend(DiscussionListState.prototype, 'requestParams', function (params) {\n        params.include.push('recipientUsers');\n        params.include.push('recipientGroups');\n    });\n}\n\nfunction controls() {\n    extend(DiscussionControls, 'moderationControls', function (items, discussion) {\n        if (discussion.canEditRecipients()) {\n            items.add(\n                'recipients',\n                Button.component({\n                    icon: app.forum.data.attributes['byobu.icon-badge'],\n                    onclick: () => app.modal.show(AddRecipientModal, { discussion }),\n                }, app.translator.trans('fof-byobu.forum.buttons.edit_recipients'))\n            );\n        }\n        if (discussion && discussion.recipientUsers().find(user => user.id() === app.session.user.id())) {\n            items.add(\n                'remove',\n                Button.component({\n                    icon: 'fas fa-user-slash',\n                    onclick: () => {\n                        if (discussion) {\n                            let recipients = new ItemList();\n                            discussion.recipientUsers().map((user) => {\n                                if (app.session.user.id() !== user.id()) {\n                                    recipients.add('users:' + user.id(), user);\n                                }\n                            });\n\n                            let recipientGroups = [];\n                            let recipientUsers = [];\n\n                            recipients.toArray().forEach((recipient) => {\n                                if (recipient instanceof User) {\n                                    recipientUsers.push(recipient);\n                                }\n                                if (recipient instanceof Group) {\n                                    recipientGroups.push(recipient);\n                                }\n                            });\n\n                            discussion.save({\n                                relationships: {\n                                    recipientUsers,\n                                    recipientGroups\n                                }\n                            }).then(() => app.history.back());\n                        }\n                    },\n                }, app.translator.trans('fof-byobu.forum.buttons.remove_from_discussion'))\n            );\n        }\n    });\n}\n\nfunction attributes() {\n    Discussion.prototype.recipientUsers = Model.hasMany('recipientUsers');\n    Discussion.prototype.oldRecipientUsers = Model.hasMany('oldRecipientUsers');\n    Discussion.prototype.recipientGroups = Model.hasMany('recipientGroups');\n    Discussion.prototype.oldRecipientGroups = Model.hasMany('oldRecipientGroups');\n\n    Discussion.prototype.canEditRecipients = Model.attribute('canEditRecipients');\n    Discussion.prototype.canEditUserRecipients = Model.attribute('canEditUserRecipients');\n    Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n    Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n}\n","import DiscussionComposer from 'flarum/components/DiscussionComposer';\nimport AddRecipientModal from '../../modals/AddRecipientModal';\nimport ItemList from 'flarum/utils/ItemList';\nimport recipientCountLabel from \"../labels/recipientCountLabel\";\nimport User from 'flarum/models/User';\nimport Group from 'flarum/models/Group';\n\nexport default class PrivateDiscussionComposer extends DiscussionComposer {\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.composer.fields.recipients = this.attrs.recipients || new ItemList();\n\n        this.composer.fields.recipientUsers = this.attrs.recipientUsers || [];\n        this.composer.fields.recipientGroups = this.attrs.recipientGroups || [];\n\n        const username = m.route.param('username');\n\n        if (typeof username !== 'undefined') {\n            this.addDefaultRecipients(username);\n        }\n    }\n\n    data() {\n        let data = super.data();\n\n        const users = [];\n        const groups = [];\n        this.composer.fields.recipients.toArray().forEach((recipient) => {\n            if (recipient instanceof User) {\n                users.push(recipient);\n            }\n\n            if (recipient instanceof Group) {\n                groups.push(recipient);\n            }\n        });\n\n        data.relationships = data.relationships || {};\n\n        if (users.length) {\n            data.relationships.recipientUsers = users;\n        }\n\n        if (groups.length) {\n            data.relationships.recipientGroups = groups;\n        }\n\n        delete data.relationships.tags;\n\n        return data;\n    }\n\n    chooseRecipients() {\n        app.modal.show(AddRecipientModal, {\n            selectedRecipients: this.composer.fields.recipients,\n            onsubmit: (recipients) => {\n                this.composer.fields.recipients = recipients;\n\n                // Focus on recipient autocomplete field.\n                this.$('.RecipientsInput').focus();\n            },\n        });\n    }\n\n    headerItems() {\n        let items = super.headerItems();\n\n        items.remove('tags');\n\n        if (app.session.user && app.forum.attribute('canStartPrivateDiscussion')) {\n            const recipients = this.composer.fields.recipients.toArray();\n\n            items.add(\n                'recipients',\n                <a className=\"PrivateDiscussionComposer-changeRecipients\" onclick={this.chooseRecipients.bind(this)}>\n                    {recipients.length ? (\n                        recipientCountLabel(recipients.length)\n                    ) : (\n                        <span className=\"RecipientLabel none\">{app.translator.trans('fof-byobu.forum.buttons.add_recipients')}</span>\n                    )}\n                </a>,\n                5\n            );\n        }\n\n        return items;\n    }\n\n    addDefaultRecipients(username) {\n        const user = app.store.getBy('users', 'username', username);\n\n        this.composer.fields.recipients.add('users:' + app.session.user.id(), app.session.user);\n\n        if (user.id() !== app.session.user.id()) {\n            this.composer.fields.recipients.add('users:' + user.id(), user);\n        }\n    };\n\n    onsubmit() {\n        this.loading = true;\n\n        const recipients = this.composer.fields.recipients.toArray();\n\n        if (recipients.length < 2) {\n            this.chooseRecipients();\n\n            this.loading = false;\n        } else {\n            const data = this.data();\n\n            app.store\n                .createRecord('discussions')\n                .save(data)\n                .then((discussion) => {\n                    if (app.cache.discussionList) {\n                        app.cache.discussionList.refresh();\n                    }\n                    m.route.set(app.route.discussion(discussion));\n\n                    app.composer.hide();\n                }, this.loaded.bind(this));\n        }\n    }\n}\n","export default function recipientCountLabel(count, attrs = {}) {\n    attrs.style = attrs.style || {};\n    attrs.className = 'RecipientLabel ' + (attrs.className || '');\n\n    var label = app.translator.transChoice('fof-byobu.forum.labels.recipients', count, { count });\n\n    return m('span', attrs, <span className=\"RecipientLabel-text\">{label}</span>);\n}\n","import { extend } from 'flarum/extend';\nimport Model from \"flarum/Model\";\nimport User from \"flarum/models/User\";\nimport UserControls from 'flarum/utils/UserControls';\nimport PrivateDiscussionComposer from './../pages/discussions/PrivateDiscussionComposer';\nimport Button from 'flarum/components/Button';\nimport ItemList from 'flarum/utils/ItemList';\nimport UserPage from 'flarum/components/UserPage';\nimport LinkButton from 'flarum/components/LinkButton';\n\nexport default (app) => {\n    attributes();\n    message(app);\n    sharedMessageHistory(app);\n}\n\nfunction message(app) {\n    extend(UserControls, 'userControls', function (items, user) {\n        if (\n            app.session.user &&\n            app.session.user.id() !== user.id() &&\n            app.forum.attribute('canStartPrivateDiscussion') &&\n            (user.blocksPd() === false || (app.forum.attribute('canStartPrivateDiscussionWithBlockers') && user.cannotBeDirectMessaged()))\n        ) {\n            items.add(\n                'private-discussion',\n                Button.component({\n                    icon: app.forum.data.attributes['byobu.icon-badge'],\n                    onclick: (e) => {\n                        e.preventDefault();\n\n                        return new Promise((resolve) => {\n                            let recipients = new ItemList();\n                            recipients.add('users:' + app.session.user.id(), app.session.user);\n                            recipients.add('users:' + user.id(), user);\n\n                            PrivateDiscussionComposer.prototype.recipients = recipients;\n\n                            app.composer.load(PrivateDiscussionComposer, {\n                                user: app.session.user,\n                                recipients: recipients,\n                                recipientUsers: recipients,\n                                titlePlaceholder: app.translator.trans('fof-byobu.forum.composer_private_discussion.title_placeholder'),\n                                submitLabel: app.translator.trans('fof-byobu.forum.composer_private_discussion.submit_button'),\n                            });\n                            app.composer.show();\n\n                            return resolve(app.composer);\n                        })\n                    },\n                }, app.translator.trans('fof-byobu.forum.buttons.send_pd', { username: user.username() }))\n            );\n        }\n\n        return items;\n    });\n}\n\nfunction sharedMessageHistory(app) {\n    extend(UserPage.prototype, 'navItems', function (items) {\n        const href = app.route('byobuUserPrivate', { username: this.user.username() });\n\n        // Hide links from guests if they are not already on the page\n        if (!app.session.user && m.route.get() !== href) return;\n        // Hide link for your own page.\n        if (app.session.user && app.session.user.username() === this.user.username()) return;\n\n        items.add(\n            'byobu',\n            LinkButton.component({\n                href,\n                icon: app.forum.data.attributes['byobu.icon-badge'],\n            }, app.translator.trans('fof-byobu.forum.user.byobu_link')),\n            85\n        );\n    });\n}\n\nfunction attributes() {\n    User.prototype.blocksPd = Model.attribute('blocksPd');\n    User.prototype.unifiedIndex = Model.attribute('unifiedIndex');\n    User.prototype.cannotBeDirectMessaged = Model.attribute('cannotBeDirectMessaged');\n    User.prototype.unreadPrivateMessagesCount = Model.attribute('unreadPrivateMessagesCount');\n}\n","import SettingsPage from \"./SettingsPage\";\nimport Discussion from \"./Discussion\";\nimport User from \"./User\";\n\nexport default (app) => {\n    Discussion(app);\n    SettingsPage(app);\n    User(app);\n}\n","import DiscussionListState from 'flarum/states/DiscussionListState';\n\nexport default class PrivateDiscussionLisState extends DiscussionListState { }\n","import DiscussionList from 'flarum/components/DiscussionList';\n\nexport default class PrivateDiscussionList extends DiscussionList {}\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","\nimport Button from 'flarum/components/Button';\nimport LogInModal from 'flarum/components/LogInModal';\nimport ItemList from 'flarum/utils/ItemList';\nimport PrivateDiscussionComposer from \"./discussions/PrivateDiscussionComposer\";\n\nexport default class PrivateComposing {\n    constructor(recipient) {\n        this.recipient = recipient;\n    }\n\n    action(e) {\n        e.preventDefault();\n\n        return new Promise((resolve, reject) => {\n            if (app.session.user) {\n                let recipients = new ItemList();\n\n                recipients.add('users:' + app.session.user.id(), app.session.user);\n\n                if (this.recipient && app.session.user.id() !== this.recipient.id()) {\n                    recipients.add('users:' + this.recipient.id(), this.recipient);\n                }\n\n                app.composer.load(PrivateDiscussionComposer, {\n                    user: app.session.user,\n                    recipients: recipients,\n                    recipientUsers: recipients,\n                    titlePlaceholder: app.translator.trans('fof-byobu.forum.composer_private_discussion.title_placeholder'),\n                    submitLabel: app.translator.trans('fof-byobu.forum.composer_private_discussion.submit_button'),\n                });\n\n                app.composer.show();\n\n                return resolve();\n            } else {\n                app.modal.show(LogInModal);\n\n                return reject();\n            }\n        });\n    }\n\n    component() {\n        return Button.component({\n            icon: 'fas fa-pen',\n            className: 'Button Button--primary IndexPage-newDiscussion',\n            itemClassName: 'fof-byobu_primaryControl',\n            onclick: this.action.bind(this),\n            disabled: ! this.canStartDiscussion,\n        }, app.translator.trans(\n            this.canStartDiscussion ? 'fof-byobu.forum.nav.start_button' : 'core.forum.index.cannot_start_discussion_button'\n        ))\n    }\n\n    get canStartDiscussion() {\n        return app.session.user && app.forum.attribute('canStartPrivateDiscussion');\n    }\n}\n","import UserPage from 'flarum/components/UserPage';\nimport PrivateDiscussionListState from '../states/PrivateDiscussionListState';\nimport Button from 'flarum/components/Button';\nimport Dropdown from 'flarum/components/Dropdown';\nimport ItemList from 'flarum/utils/ItemList';\nimport listItems from 'flarum/helpers/listItems';\nimport PrivateDiscussionList from './discussions/PrivateDiscussionList';\nimport PrivateComposing from \"./PrivateComposing\";\n\nexport default class PrivateDiscussionsUserPage extends UserPage {\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.changeSort('latest');\n    }\n\n    show(user) {\n        // We can not create the list in init because the user will not be available if it has to be loaded asynchronously\n        this.list = new PrivateDiscussionListState({\n                q: `byobu:${user.username()} is:private`,\n                sort: this.sort,\n            });\n\n        this.list.refresh();\n\n        // We call the parent method after creating the list, this way the this.list property\n        // is set before content() is called for the first time\n        super.show(user);\n    }\n\n    handleChangeSort(sort, e) {\n        e.preventDefault();\n\n        this.changeSort(sort);\n    }\n\n    changeSort(sort) {\n        this.sort = sort;\n        this.loadUser(m.route.param('username'));\n    }\n\n    content() {\n        return (\n            <div className=\"DiscussionsUserPage\">\n                <div className=\"DiscussionsUserPage-toolbar\">\n                    <ul className=\"DiscussionsUserPage-toolbar-action\">{listItems(this.actionItems().toArray())}</ul>\n                    <ul className=\"DiscussionsUserPage-toolbar-view\">{listItems(this.viewItems().toArray())}</ul>\n                </div>\n                <PrivateDiscussionList state={this.list}></PrivateDiscussionList>\n            </div>\n        );\n    }\n\n    actionItems() {\n        let composing = new PrivateComposing(this.user);\n\n        const items = new ItemList();\n\n        if (app.session.user && app.forum.attribute('canStartPrivateDiscussion')) {\n            items.add(\n                'start_private',\n                composing.component()\n            );\n        }\n\n        return items;\n    }\n\n    viewItems() {\n        const items = new ItemList();\n        const sortMap = this.list.sortMap();\n\n        const sortOptions = {};\n        for (const i in sortMap) {\n            sortOptions[i] = app.translator.trans('core.forum.index_sort.' + i + '_button');\n        }\n\n        items.add(\n            'sort',\n            Dropdown.component({\n                buttonClassName: 'Button',\n                label: sortOptions[this.sort] || Object.keys(sortMap).map((key) => sortOptions[key])[0],\n            }, Object.keys(sortOptions).map((value) => {\n                const label = sortOptions[value];\n                const active = (this.sort || Object.keys(sortMap)[0]) === value;\n\n                return Button.component({\n                    icon: active ? 'fas fa-check' : true,\n                    onclick: this.handleChangeSort.bind(this, value),\n                    active: active,\n                }, label);\n            }))\n        );\n\n        return items;\n    }\n}\n","import routes from \"./routes\";\nimport PrivateDiscussionsPage from \"./PrivateDiscussionsPage\";\n\nexport default (app) => {\n    routes(app);\n    PrivateDiscussionsPage(app);\n}\n","import IndexPage from \"flarum/components/IndexPage\";\nimport PrivateDiscussionsUserPage from \"./PrivateDiscussionsUserPage\";\n\nexport default (app) => {\n    app.routes.byobuUserPrivate = { path: '/u/:username/private', component: PrivateDiscussionsUserPage };\n    app.routes.byobuPrivate = {path: '/private', component: IndexPage};\n}\n","import { extend } from 'flarum/extend';\nimport LinkButton from 'flarum/components/LinkButton';\nimport IndexPage from 'flarum/components/IndexPage';\nimport DiscussionListState from 'flarum/states/DiscussionListState';\nimport PrivateComposing from \"./PrivateComposing\";\n\nexport default (app) => {\n    extend(IndexPage.prototype, 'navItems', (items) => {\n        const user = app.session.user;\n\n        if (user) {\n            items.add(\n                'privateDiscussions',\n                LinkButton.component({\n                    icon: app.forum.data.attributes['byobu.icon-badge'],\n                    href: app.route('byobuPrivate'),\n                }, app.translator.trans('fof-byobu.forum.nav.nav_item')),\n                75\n            );\n        }\n    });\n\n    extend(IndexPage.prototype, 'setTitle', function () {\n        if (app.current.get('routeName') === 'byobuPrivate') {\n            app.setTitle(app.translator.trans('fof-byobu.forum.user.dropdown_label'));\n        }\n    });\n\n    extend(DiscussionListState.prototype, 'requestParams', function(params) {\n        if (app.current.get('routeName') === 'byobuPrivate') {\n            params.filter.q = (params.filter.q || '') + ' is:private';\n        }\n    });\n\n    extend(IndexPage.prototype, 'sidebarItems', function (items) {\n        if (app.current.get('routeName') === 'byobuPrivate') {\n            let compose = new PrivateComposing;\n\n            items.replace(\n                'newDiscussion',\n                compose.component()\n            );\n        }\n    });\n}\n","import Notification from 'flarum/components/Notification';\n\nexport default class PrivateDiscussionNotification extends Notification {\n    icon() {\n        return app.forum.data.attributes['byobu.icon-badge'];\n    }\n\n    href() {\n        const notification = this.attrs.notification;\n        const discussion = notification.subject();\n\n        return app.route.discussion(discussion);\n    }\n\n    content() {\n        const user = this.attrs.notification.fromUser();\n        return app.translator.trans('fof-byobu.forum.notifications.pd_text', {\n            user: user,\n        });\n    }\n}\n","import Notification from 'flarum/components/Notification';\n\nexport default class PrivateDiscussionReplyNotification extends Notification {\n    icon() {\n        return 'fas fa-reply';\n    }\n\n    href() {\n        const notification = this.attrs.notification;\n        const discussion = notification.subject();\n        const content = notification.content() || {};\n\n        return app.route.discussion(discussion, content.postNumber);\n    }\n\n    content() {\n        const user = this.attrs.notification.fromUser();\n        return app.translator.trans('fof-byobu.forum.notifications.pd_reply_text', {\n            user: user,\n        });\n    }\n}\n","import Notification from 'flarum/components/Notification';\n\nexport default class PrivateDiscussionUserLeftNotification extends Notification {\n    icon() {\n        return app.forum.data.attributes['byobu.icon-badge'];\n    }\n\n    href() {\n        const notification = this.attrs.notification;\n        const discussion = notification.subject();\n\n        return app.route.discussion(discussion);\n    }\n\n    content() {\n        const user = this.attrs.notification.fromUser();\n        return app.translator.trans('fof-byobu.forum.notifications.pd_user_left_text', {\n            user: user,\n        });\n    }\n}\n","import Notification from 'flarum/components/Notification';\n\nexport default class PrivateDiscussionAddedNotification extends Notification {\n    icon() {\n        return app.forum.data.attributes['byobu.icon-badge'];\n    }\n\n    href() {\n        const notification = this.attrs.notification;\n        const discussion = notification.subject();\n\n        return app.route.discussion(discussion);\n    }\n\n    content() {\n        const user = this.attrs.notification.fromUser();\n        return app.translator.trans('fof-byobu.forum.notifications.pd_added_text', {\n            user: user,\n        });\n    }\n}\n","import { extend } from 'flarum/extend';\nimport NotificationGrid from \"flarum/components/NotificationGrid\";\nimport PrivateDiscussionNotification from \"./PrivateDiscussionNotification\";\nimport PrivateDiscussionRepliedNotification from \"./PrivateDiscussionReplyNotification\";\nimport PrivateDiscussionUserLeftNotification from \"./PrivateDiscussionUserLeftNotification\";\nimport PrivateDiscussionAddedNotification from \"./PrivateDiscussionAddedNotification\";\n\nexport default function (app) {\n    app.notificationComponents.byobuPrivateDiscussionCreated = PrivateDiscussionNotification;\n    app.notificationComponents.byobuPrivateDiscussionReplied = PrivateDiscussionRepliedNotification;\n    app.notificationComponents.byobuRecipientRemoved = PrivateDiscussionUserLeftNotification;\n    app.notificationComponents.byobuPrivateDiscussionAdded = PrivateDiscussionAddedNotification;\n\n    grid();\n}\n\nfunction grid() {\n    // Add notification preferences.\n    extend(NotificationGrid.prototype, 'notificationTypes', function (items) {\n        items.add('byobuPrivateDiscussionCreated', {\n            name: 'byobuPrivateDiscussionCreated',\n            icon: app.forum.data.attributes['byobu.icon-badge'],\n            label: app.translator.trans('fof-byobu.forum.notifications.pd_label'),\n        });\n        items.add('byobuPrivateDiscussionReplied', {\n            name: 'byobuPrivateDiscussionReplied',\n            icon: app.forum.data.attributes['byobu.icon-badge'],\n            label: app.translator.trans('fof-byobu.forum.notifications.pd_reply_label'),\n        });\n        items.add('byobuPrivateDiscussionAdded', {\n            name: 'byobuPrivateDiscussionAdded',\n            icon: app.forum.data.attributes['byobu.icon-badge'],\n            label: app.translator.trans('fof-byobu.forum.notifications.pd_added_label'),\n        });\n        items.add('byobuRecipientRemoved', {\n            name: 'byobuRecipientRemoved',\n            icon: app.forum.data.attributes['byobu.icon-badge'],\n            label: app.translator.trans('fof-byobu.forum.notifications.pd_user_left_label'),\n        });\n    });\n}\n","import events from './events';\nimport extend from './extend';\nimport pages from './pages';\nimport notifications from './notifications';\n\napp.initializers.add('fof-byobu', function (app) {\n    events(app);\n    extend(app);\n\n    pages(app);\n    notifications(app);\n});\n","import RecipientLeft from \"./RecipientLeft\";\nimport RecipientsModified from \"./RecipientsModified\";\n\nexport default (app) => {\n    app.postComponents.recipientsModified = RecipientsModified;\n    app.postComponents.recipientLeft = RecipientLeft;\n}\n"],"sourceRoot":""}