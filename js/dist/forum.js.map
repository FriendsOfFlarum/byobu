{"version":3,"sources":["webpack://@fof/byobu/webpack/bootstrap","webpack://@fof/byobu/external \"flarum.core.compat['extend']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/ItemList']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Button']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/User']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/Discussion']\"","webpack://@fof/byobu/external \"flarum.core.compat['Model']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/Group']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LinkButton']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Notification']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Switch']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Select']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/highlight']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/username']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/extract']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionList']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/UserPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LogInModal']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/listItems']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/classList']\"","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionComposer.js","webpack://@fof/byobu/./src/forum/components/sources/UserSearchSource.js","webpack://@fof/byobu/./src/forum/components/sources/GroupSearchSource.js","webpack://@fof/byobu/./src/common/helpers/recipientLabel.js","webpack://@fof/byobu/./src/forum/components/RecipientSearch.js","webpack://@fof/byobu/./src/forum/components/AddRecipientModal.js","webpack://@fof/byobu/./src/common/helpers/recipientCountLabel.js","webpack://@fof/byobu/./src/forum/addRecipientComposer.js","webpack://@fof/byobu/./src/common/helpers/recipientsLabel.js","webpack://@fof/byobu/./src/forum/addRecipientLabels.js","webpack://@fof/byobu/./src/forum/addRecipientsControl.js","webpack://@fof/byobu/./src/forum/addHasRecipientsBadge.js","webpack://@fof/byobu/./src/forum/addDiscussPrivatelyControl.js","webpack://@fof/byobu/./src/forum/addPrivacySetting.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionList.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionsUserPage.js","webpack://@fof/byobu/./src/forum/addPrivateDiscussionsPage.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionNotification.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionAddedNotification.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionReplyNotification.js","webpack://@fof/byobu/./src/forum/addPrivateMessageSessionDropdownLinkButton.js","webpack://@fof/byobu/./src/forum/removeTagComposer.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionIndex.js","webpack://@fof/byobu/./src/forum/components/RecipientsModified.js","webpack://@fof/byobu/./src/forum/index.js","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionComposer']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Modal']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Search']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/avatar']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/extractText']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LoadingIndicator']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionListItem']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionHero']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/DiscussionControls']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Badge']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/UserControls']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/SettingsPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Dropdown']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/NotificationGrid']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/SessionDropdown']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Page']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/icon']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/WelcomeHero']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/SelectDropdown']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/EventPost']\""],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","_inheritsLoose","subClass","superClass","constructor","__proto__","PrivateDiscussionComposer_PrivateDiscussionComposer","a","UserSearchSource_UserSearchSource","view","query","_this","this","length","loading","app","cache","byobuResults","className","translator","trans","map","user","username_default","children","highlight_default","data-index","id","avatar_default","store","find","filter","q","page","limit","then","pushResults","results","_this2","payload","data","result","getById","push","redraw","GroupSearchSource_GroupSearchSource","search","toLowerCase","all","group","namePlural","substr","groupName","class","recipientLabel","recipient","attrs","style","label","link","extract_default","User_default","title","username","href","route","config","Group_default","RecipientSearch_RecipientSearch","isInitialized","$search","$","on","e","target","addRecipient","focus","parentNode","clearTimeout","typingTimer","doSearch","setTimeout","_Search","sources","sourceItems","toArray","props","selected","onclick","removeRecipient","classList_default","open","focused","active","loadingSources","element","type","placeholder","extractText_default","oninput","withAttr","onfocus","hasFocus","onblur","in","source","LoadingIndicator_default","component","size","items","ItemList_default","discussion","forum","attribute","canEditUserRecipients","add","canEditGroupRecipients","clear","values","split","findRecipient","remove","Search_default","AddRecipientModal_AddRecipientModal","init","_Modal","prop","assignInitialRecipients","selectedRecipients","merge","session","recipientSearch","isDismissible","recipientUsers","recipientGroups","content","isDisabled","Button_default","disabled","icon","hide","select","metaKey","ctrlKey","indexOf","index","submit","onsubmit","preventDefault","recipients","forEach","save","relationships","current","DiscussionPage_default","stream","update","modal","close","composer","show","strategy","Modal_default","recipientCountLabel","count","transChoice","recipientsLabel","addRecipientsControl","external_flarum_core_compat_extend_","DiscussionControls_default","canEditRecipients","history","back","addHasRecipientsBadge","Discussion_default","badges","Badge_default","addDiscussPrivatelyControl","UserControls_default","blocksPd","cannotBeDirectMessaged","deferred","load","resolve","promise","addPrivacySetting","SettingsPage_default","Switch_default","state","preferences","onchange","preferenceSaver","PrivateDiscussionList_PrivateDiscussionList","DiscussionList_default","PrivateDiscussionsUserPage_PrivateDiscussionsUserPage","_UserPage","changeSort","list","params","sort","refresh","newDiscussionAction","reject","LogInModal_default","handleChangeSort","loadUser","param","canStartDiscussion","sortMap","sortOptions","itemClassName","Dropdown_default","buttonClassName","keys","render","UserPage_default","addPrivateDiscussionsPage","Number","routes","path","LinkButton_default","PrivateDiscussionNotification_PrivateDiscussionNotification","notification","subject","fromUser","attributes","Notification_default","PrivateDiscussionAddedNotification_PrivateDiscussionNotification","PrivateDiscussionReplyNotification_PrivateDiscussionReplyNotification","postNumber","addPrivateMessageSessionDropdownLinkButton","SessionDropdown_default","removeTagComposer","tags","original","tag","getBy","PrivateDiscussionIndex_PrivateDiscussionIndex","_Page","previous","lastDiscussion","PrivateDiscussionIndex","privateDiscussionList","some","icon_default","bodyClass","onunload","scrollTop","window","hero","listItems_default","sidebarItems","viewItems","actionItems","discussionList","context","apply","arguments","css","setTitle","setTitleCount","oldHeroHeight","heroHeight","outerHeight","height","scroll","$discussion","indexTop","indexBottom","discussionTop","offset","top","discussionBottom","WelcomeHero_default","newDiscussion","SelectDropdown_default","navItems","stickyParams","Select_default","options","markAllAsRead","searching","clearSearch","routeName","composeNewDiscussion","onlogin","confirm","readTime","Date","Page_default","RecipientsModified_RecipientsModified","initProps","diff","diff1","diff2","item","_EventPost","post","usersAdded","usersRemoved","groupsAdded","groupsRemoved","added","concat","removed","oldRecipients","newRecipients","descriptionKey","localeBase","descriptionData","initializers","private_discussions","external_flarum_core_compat_Model_default","hasMany","oldRecipientUsers","oldRecipientGroups","postComponents","recipientsModified","addDefaultRecipients","chooseRecipients","users","groups","addRecipientComposer","addToDiscussion","long","DiscussionListItem_default","include","DiscussionHero_default","addRecipientLabels","notificationComponents","byobuPrivateDiscussionCreated","byobuPrivateDiscussionReplied","byobuPrivateDiscussionAdded","NotificationGrid_default"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 47);\n","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['models/User'];","module.exports = flarum.core.compat['models/Discussion'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['models/Group'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['components/LinkButton'];","module.exports = flarum.core.compat['components/Notification'];","module.exports = flarum.core.compat['components/Switch'];","module.exports = flarum.core.compat['components/Select'];","module.exports = flarum.core.compat['helpers/highlight'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['utils/extract'];","module.exports = flarum.core.compat['components/DiscussionList'];","module.exports = flarum.core.compat['components/UserPage'];","module.exports = flarum.core.compat['components/LogInModal'];","module.exports = flarum.core.compat['helpers/listItems'];","module.exports = flarum.core.compat['utils/classList'];","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","\nimport DiscussionComposer from \"flarum/components/DiscussionComposer\";\n\nexport default class PrivateDiscussionComposer extends DiscussionComposer {\n\n}","import highlight from 'flarum/helpers/highlight';\nimport avatar from 'flarum/helpers/avatar';\nimport username from 'flarum/helpers/username';\n\nexport default class UserSearchSource {\n    view(query) {\n        if (query.length < 3 || this.loading) return;\n\n        if (!app.cache.byobuResults) {\n            app.cache.byobuResults = [];\n        }\n\n        this.query = query;\n\n        if (!app.cache.byobuResults[this.query]) {\n\n            this.loading = true;\n\n            app.cache.byobuResults[this.query] = [];\n            app.store.find('users', {\n                filter: {q: this.query + ' allows-pd'},\n                page: {limit: 5}\n            }).then(this.pushResults.bind(this));\n        } else\n\n            return [\n                <li className=\"Dropdown-header\">{app.translator.trans('core.forum.search.users_heading')}</li>,\n                app.cache.byobuResults[this.query].map(user => {\n                    const name = username(user);\n                    name.children[0] = highlight(name.children[0], this.query);\n\n                    return (\n                        <li className='SearchResult' data-index={'users:' + user.id()}>\n                            <a data-index={'users:' + user.id()}>\n                                {avatar(user)}\n                                {name}\n                            </a>\n                        </li>\n                    );\n                })\n            ];\n    }\n\n    pushResults(results) {\n        results.payload.data.map(result => {\n            var user = app.store.getById('users', result.id);\n            app.cache.byobuResults[this.query].push(user);\n        });\n        this.loading = false;\n        m.redraw();\n    }\n}\n","import highlight from 'flarum/helpers/highlight';\n\nexport default class GroupSearchSource {\n    search(query) {\n        return app.store.find('groups', {\n            filter: {q: query},\n            page: {limit: 5}\n        });\n    }\n\n    view(query) {\n        query = query.toLowerCase();\n\n        const results = app.store.all('groups')\n            .filter(group => group.namePlural().toLowerCase().substr(0, query.length) === query);\n\n        if (!results.length) return '';\n\n        return [\n            <li className=\"Dropdown-header\">{app.translator.trans('fof-byobu.forum.search.headings.groups')}</li>,\n            results.map(group => {\n                const groupName = group.namePlural();\n                var name = highlight(groupName, query);\n\n                return (\n                    <li className=\"SearchResult\" data-index={'groups:' + group.id()}>\n                        <a data-index={'groups:' + group.id()}>\n                            <span class=\"groupName\">{name}</span>\n                        </a>\n                    </li>\n                );\n            })\n        ];\n    }\n}\n","import extract from 'flarum/utils/extract';\nimport username from 'flarum/helpers/username';\nimport User from 'flarum/models/User';\nimport Group from 'flarum/models/Group';\n\nexport default function recipientLabel(recipient, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'RecipientLabel ' + (attrs.className || '');\n\n  const link = extract(attrs, 'link');\n\n  var label;\n\n  if (recipient instanceof User) {\n      label = username(recipient);\n\n      if (link) {\n          attrs.title = recipient.username() || '';\n          attrs.href = app.route.user(recipient);\n          attrs.config = m.route;\n      }\n  } else if (recipient instanceof Group) {\n      label = recipient.namePlural();\n  } else {\n      attrs.className += ' none';\n      label = app.translator.trans('fof-byobu.forum.labels.user_deleted');\n  }\n\n  return (\n    m((link ? 'a' : 'span'), attrs,\n        <span className=\"RecipientLabel-text\">\n            {label}\n        </span>\n    )\n  );\n}\n","import Search from \"flarum/components/Search\";\nimport UserSearchSource from \"./sources/UserSearchSource\";\nimport GroupSearchSource from \"./sources/GroupSearchSource\";\nimport ItemList from \"flarum/utils/ItemList\";\nimport classList from \"flarum/utils/classList\";\nimport extractText from \"flarum/utils/extractText\";\nimport LoadingIndicator from \"flarum/components/LoadingIndicator\";\nimport recipientLabel from \"../../common/helpers/recipientLabel\";\nimport User from \"flarum/models/User\";\nimport Group from \"flarum/models/Group\";\n\nexport default class RecipientSearch extends Search {\n\n    config(isInitialized) {\n        if (isInitialized) return;\n\n        const $search = this;\n\n        this.$('.Search-results').on('click', (e) => {\n            const target = this.$('.SearchResult.active')\n\n            $search.addRecipient(target.data('index'));\n            $search.$('.RecipientsInput').focus();\n        });\n\n        this.$('.Search-results').on('touchstart', (e) => {\n            const target = this.$(e.target.parentNode);\n\n            $search.addRecipient(target.data('index'));\n            $search.$('.RecipientsInput').focus();\n        });\n\n        $('.RecipientsInput').on('keyup', () => {\n            clearTimeout(this.typingTimer);\n            this.doSearch = false;\n            this.typingTimer = setTimeout(() => {\n                this.doSearch = true;\n                m.redraw();\n            }, 900);\n        }).on('keydown', () => {\n            clearTimeout(this.typingTimer);\n        });\n\n        super.config(isInitialized);\n    }\n\n    view() {\n        if (typeof this.value() === 'undefined') {\n            this.value('');\n        }\n\n        const loading = this.value() && this.value().length >= 3;\n\n        if (!this.sources) {\n            this.sources = this.sourceItems().toArray();\n        }\n\n        return m('div', {\n            className: 'AddRecipientModal-form-input'\n        }, [\n            m('div', {\n                className: 'RecipientsInput-selected RecipientsLabel'\n            }, this.props.selected().toArray().map(recipient =>\n                recipientLabel(recipient, {\n                    onclick: () => {\n                        this.removeRecipient(recipient);\n                    }\n                })\n            )),\n            m('input', {\n                className: 'RecipientsInput FormControl ' + classList({\n                    open: !!this.value(),\n                    focused: !!this.value(),\n                    active: !!this.value(),\n                    loading: !!this.loadingSources\n                }),\n                config: function (element) {\n                    element.focus();\n                },\n                type: 'search',\n                placeholder: extractText(app.translator.trans('fof-byobu.forum.input.search_recipients')),\n                value: this.value(),\n                oninput: m.withAttr('value', this.value),\n                onfocus: () => this.hasFocus = true,\n                onblur: () => this.hasFocus = false\n            }),\n            m('ul', {\n                className: 'Dropdown-menu Search-results fade ' + classList({\n                    in: !!loading\n                })\n            }, !this.doSearch\n                ? LoadingIndicator.component({size: 'tiny', className: 'Button Button--icon Button--link'})\n                : this.sources.map(source => source.view(this.value()))\n            )\n        ]);\n    }\n\n    /**\n     * Build an item list of SearchSources.\n     *\n     * @return {ItemList}\n     */\n    sourceItems() {\n        const items = new ItemList();\n\n        // Add user source based on permissions.\n        if (\n            (!this.props.discussion && app.forum.attribute('canStartPrivateDiscussionWithUsers')) ||\n            (this.props.discussion && this.props.discussion.canEditUserRecipients())\n        ) {\n            items.add('users', new UserSearchSource());\n        }\n\n        // Add group source based on permissions.\n        if (\n            (!this.props.discussion && app.forum.attribute('canStartPrivateDiscussionWithGroups')) ||\n            (this.props.discussion && this.props.discussion.canEditGroupRecipients())\n        ) {\n            items.add('groups', new GroupSearchSource());\n        }\n\n        return items;\n    }\n\n\n    /**\n     * Clear the search input and the current controller's active search.\n     */\n    clear() {\n        this.value('');\n\n        m.redraw();\n    }\n\n    /**\n     * Adds a recipient.\n     *\n     * @param value\n     */\n    addRecipient(value) {\n\n        let values = value.split(':'),\n            type = values[0],\n            id = values[1];\n\n        let recipient = this.findRecipient(type, id);\n\n        this.props.selected().add(value, recipient);\n\n        this.clear();\n    }\n\n    /**\n     * Removes a recipient.\n     *\n     * @param recipient\n     */\n    removeRecipient(recipient) {\n        let type;\n\n        if (recipient instanceof User) {\n            type = 'users';\n        }\n        if (recipient instanceof Group) {\n            type = 'groups';\n        }\n\n        this.props.selected().remove(type + \":\" + recipient.id());\n\n        m.redraw();\n    }\n\n    /**\n     * Loads a recipient from the global store.\n     *\n     * @param store\n     * @param id\n     * @returns {Model}\n     */\n    findRecipient(store, id) {\n        return app.store.getById(store, id);\n    }\n}\n","import Modal from \"flarum/components/Modal\";\nimport DiscussionPage from \"flarum/components/DiscussionPage\";\nimport Button from \"flarum/components/Button\";\nimport ItemList from \"flarum/utils/ItemList\";\nimport RecipientSearch from \"./RecipientSearch\";\nimport User from \"flarum/models/User\";\nimport Group from \"flarum/models/Group\";\n\nexport default class AddRecipientModal extends Modal {\n    init() {\n        super.init();\n\n        this.selected = m.prop(new ItemList);\n\n        if (this.props.discussion) {\n            // Adds recipients of the currently viewed discussion.\n            this.assignInitialRecipients(this.props.discussion);\n        } else if (this.props.selectedRecipients.toArray().length > 0) {\n            // Adds previously selected recipients.\n            this.selected().merge(this.props.selectedRecipients);\n        } else {\n            // Adds the current user in case there are no selected recipients yet and this is a new discussion.\n            this.selected().add(\"users:\" + app.session.user.id(), app.session.user);\n        }\n\n        this.recipientSearch = RecipientSearch.component({\n            selected: this.selected,\n            discussion: this.props.discussion\n        });\n    }\n\n    isDismissible() {\n        return false;\n    }\n\n    assignInitialRecipients(discussion) {\n        discussion.recipientUsers().map(user => {\n            this.selected().add(\"users:\" + user.id(), user);\n        });\n        discussion.recipientGroups().map(group => {\n            this.selected().add(\"groups:\" + group.id(), group);\n        });\n    }\n\n    className() {\n        return 'AddRecipientModal';\n    }\n\n    title() {\n        return this.props.discussion\n            ? app.translator.trans('fof-byobu.forum.modal.titles.update_recipients', { title: <em>{this.props.discussion.title()}</em> })\n            : app.translator.trans('fof-byobu.forum.modal.titles.add_recipients');\n    }\n\n    content() {\n        const isDisabled = this.selected().toArray().length < 2;\n\n        return [\n            <div className=\"Modal-body\">\n                <div className=\"AddRecipientModal-form\">\n                    {this.recipientSearch}\n                    <div className=\"AddRecipientModal-form-submit App-primaryControl\">\n                        {Button.component({\n                            type: 'submit',\n                            className: 'Button Button--primary',\n                            disabled: isDisabled,\n                            icon: 'fas fa-check',\n                            children: app.translator.trans('fof-byobu.forum.buttons.submit')\n                        })}\n                        {Button.component({\n                            onclick: this.hide.bind(this),\n                            className: 'Button Button--primary Button--cancel',\n                            children: app.translator.trans('fof-byobu.forum.buttons.cancel')\n                        })}\n                    </div>\n                </div>\n            </div>\n        ];\n    }\n\n    select(e) {\n        // Ctrl + Enter submits the selection, just Enter completes the current entry\n        if (e.metaKey || e.ctrlKey || this.selected.indexOf(this.index) !== -1) {\n            if (this.selected().length) {\n                this.$('form').submit();\n            }\n        }\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        const discussion = this.props.discussion;\n        const recipients = this.selected();\n\n        let recipientGroups = [];\n        let recipientUsers = [];\n\n        recipients.toArray().forEach(recipient => {\n            if (recipient instanceof User) {\n                recipientUsers.push(recipient);\n            }\n            if (recipient instanceof Group) {\n                recipientGroups.push(recipient);\n            }\n        });\n\n        // Recipients are updated here for existing discussions here.\n        if (discussion) {\n            discussion.save({ relationships: { recipientUsers, recipientGroups } })\n                .then(() => {\n                    if (app.current instanceof DiscussionPage) {\n                        app.current.stream.update();\n                    }\n                    m.redraw();\n                });\n        }\n\n        // Use the onsubmit callback to trigger an update in the DiscussionComposer\n        if (this.props.onsubmit) this.props.onsubmit(recipients);\n\n        app.modal.close();\n        app.composer.show();\n        m.redraw.strategy('none');\n    }\n}\n","export default function recipientCountLabel(count, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'RecipientLabel ' + (attrs.className || '');\n\n  var label = app.translator.transChoice('fof-byobu.forum.labels.recipients', count, {count});\n\n  return (\n    m('span', attrs,\n        <span className=\"RecipientLabel-text\">\n            {label}\n        </span>\n    )\n  );\n}\n","import { extend, override } from \"flarum/extend\";\nimport PrivateDiscussionComposer from \"./components/PrivateDiscussionComposer\";\nimport AddRecipientModal from \"./components/AddRecipientModal\";\nimport recipientCountLabel from \"../common/helpers/recipientCountLabel\";\nimport User from \"flarum/models/User\";\nimport Group from \"flarum/models/Group\";\nimport ItemList from \"flarum/utils/ItemList\";\n\nexport default function (app) {\n    // Add recipient-selection abilities to the discussion composer.\n    PrivateDiscussionComposer.prototype.recipients = new ItemList;\n    PrivateDiscussionComposer.prototype.recipientUsers = [];\n    PrivateDiscussionComposer.prototype.recipientGroups = [];\n\n    PrivateDiscussionComposer.prototype.addDefaultRecipients = function (username) {\n        const user = app.store.getBy('users', 'username', username);\n\n        this.recipients.add('users:' + app.session.user.id(), app.session.user);\n        if(user.id() !== app.session.user.id()) {\n            this.recipients.add('users:' + user.id(), user);\n        }\n    };\n\n    override(PrivateDiscussionComposer.prototype, 'init', function(original) {\n        original();\n        this.chooseRecipients();\n\n        const username = m.route.param('username');\n\n        if(typeof username !== 'undefined') {\n           this.addDefaultRecipients(username); \n        }\n    });\n\n\n    // Add a recipient selection modal when clicking the recipient tag label.\n    PrivateDiscussionComposer.prototype.chooseRecipients = function () {\n        const tagsClassName = '.RecipientsInput-selected > .RecipientLabel:first-child';\n        app.modal.show(\n            new AddRecipientModal({\n                selectedRecipients: this.recipients,\n                onsubmit: (recipients) => {\n                    this.recipients = recipients;\n\n                    // Focus on recipient autocomplete field.\n                    this.$('.RecipientsInput').focus();\n                }\n            })\n        )\n        $(tagsClassName).css('display', 'none');\n    };\n\n    // Add a tag-selection menu to the discussion composer's header, after the\n    // title.\n    extend(PrivateDiscussionComposer.prototype, 'headerItems', function (items) {\n        if (app.session.user && app.forum.attribute('canStartPrivateDiscussion')) {\n            const recipients = this.recipients.toArray();\n\n            items.add('recipients', (\n                <a className=\"PrivateDiscussionComposer-changeRecipients\"\n                    onclick={this.chooseRecipients.bind(this)}>\n                    {recipients.length\n                        ? recipientCountLabel(recipients.length - 1)\n                        : <span className=\"RecipientLabel none\">{app.translator.trans('fof-byobu.forum.buttons.add_recipients')}</span>}\n                </a>\n            ), 5);\n        }\n    });\n\n    override(PrivateDiscussionComposer.prototype, 'onsubmit', function (original) {\n        const recipients = this.recipients.toArray();\n        if (recipients.length < 2) {\n            app.modal.show(\n                new AddRecipientModal({\n                    selectedRecipients: this.recipients,\n                    onsubmit: (recipients) => {\n                        this.recipients = recipients;\n                        //todo: make this better?\n                        original();\n                    }\n                })\n            )\n        } else {\n            original();\n        }\n    });\n\n    // Add the selected tags as data to submit to the server.\n    extend(PrivateDiscussionComposer.prototype, 'data', function (data) {\n        const users = [];\n        const groups = [];\n        this.recipients.toArray().forEach(recipient => {\n\n            if (recipient instanceof User) {\n                users.push(recipient);\n            }\n\n            if (recipient instanceof Group) {\n                groups.push(recipient);\n            }\n        });\n\n        data.relationships = data.relationships || {};\n\n        if (users.length) {\n            data.relationships.recipientUsers = users;\n        }\n\n        if (groups.length) {\n            data.relationships.recipientGroups = groups;\n        }\n    });\n}\n","import extract from 'flarum/utils/extract';\nimport recipientLabel from './recipientLabel';\n\nexport default function recipientsLabel(recipients, attrs = {}) {\n  const children = [];\n  const link = extract(attrs, 'link');\n\n  attrs.className = 'RecipientsLabel ' + (attrs.className || '');\n\n  if (recipients) {\n      recipients.forEach(recipient => {\n          children.push(recipientLabel(recipient, {link}));\n      });\n  } else {\n    children.push(recipientLabel());\n  }\n\n  return <span {...attrs}>{children}</span>;\n}\n","import {extend} from \"flarum/extend\";\nimport DiscussionListItem from \"flarum/components/DiscussionListItem\";\nimport DiscussionPage from \"flarum/components/DiscussionPage\";\nimport DiscussionHero from \"flarum/components/DiscussionHero\";\nimport DiscussionList from \"flarum/components/DiscussionList\";\nimport recipientsLabel from \"../common/helpers/recipientsLabel\";\n\nexport default function() {\n\n    const addToDiscussion = function(discussion, items, long) {\n        let recipients = [];\n\n        if (discussion.recipientUsers().length) {\n            recipients = recipients.concat(discussion.recipientUsers());\n        }\n\n        if (discussion.recipientGroups().length) {\n            recipients = recipients.concat(discussion.recipientGroups());\n        }\n\n        if (recipients && recipients.length) {\n            if (long) {\n                items.add('recipients', recipientsLabel(recipients), 10);\n            } else {\n                items.add('recipients', recipientsLabel(recipients, {link: true}), 4);\n            }\n        }\n    };\n\n    /**\n     * Adds User labels on the discussion index page.\n     */\n    extend(DiscussionListItem.prototype, 'infoItems', function(items) {\n        const discussion = this.props.discussion;\n\n        addToDiscussion(discussion, items, true);\n    });\n\n    /**\n     * Require recipients from the API whenever we're loading a Discussion page.\n     */\n    extend(DiscussionPage.prototype, 'params', function(params) {\n        params.include.push('recipientUsers');\n        params.include.push('recipientGroups');\n    });\n    extend(DiscussionList.prototype, 'requestParams', function(params) {\n        params.include.push('recipientUsers');\n        params.include.push('recipientGroups');\n    });\n\n\n    /**\n     * Adds User labels on the discussion Hero.\n     */\n    extend(DiscussionHero.prototype, 'items', function(items) {\n        const discussion = this.props.discussion;\n\n        addToDiscussion(discussion, items, false);\n    });\n}\n","import { extend } from 'flarum/extend';\nimport DiscussionControls from 'flarum/utils/DiscussionControls';\nimport Button from 'flarum/components/Button';\nimport ItemList from 'flarum/utils/ItemList';\nimport User from \"flarum/models/User\";\nimport Group from \"flarum/models/Group\";\n\nimport AddRecipientModal from './components/AddRecipientModal';\n\nexport default function () {\n    // Add a control allowing the discussion to be moved to another category.\n    extend(DiscussionControls, 'moderationControls', function (items, discussion) {\n        if (discussion.canEditRecipients()) {\n            items.add('recipients', Button.component({\n                children: app.translator.trans('fof-byobu.forum.buttons.edit_recipients'),\n                icon: 'far fa-map',\n                onclick: () => app.modal.show(new AddRecipientModal({ discussion }))\n            }));\n        }\n\n       if (discussion.recipientUsers().length) {\n            items.add('remove', Button.component({\n                children: app.translator.trans('fof-byobu.forum.buttons.remove_from_discussion'),\n                icon: 'fas fa-user-slash',\n                onclick: () => {\n                    if (discussion) {\n\n                        let recipients = new ItemList();\n                        discussion.recipientUsers().map(user => {\n                            if (app.session.user.id() !== user.id()) {\n                                recipients.add(\"users:\" + user.id(), user);\n                            }\n                        });\n\n                        let recipientGroups = [];\n                        let recipientUsers = [];\n\n                        recipients.toArray().forEach(recipient => {\n                            if (recipient instanceof User) {\n                                recipientUsers.push(recipient);\n                            }\n                            if (recipient instanceof Group) {\n                                recipientGroups.push(recipient);\n                            }\n                        });\n\n                        discussion.save({ relationships: { recipientUsers, recipientGroups } }).then(() => app.history.back());\n                    }\n                }\n            }));\n        }\n    });\n}\n","import {extend} from \"flarum/extend\";\nimport Discussion from \"flarum/models/Discussion\";\nimport Badge from \"flarum/components/Badge\";\n\nexport default function addHasRecipientsBadge() {\n    extend(Discussion.prototype, 'badges', function (badges) {\n        if (this.recipientUsers().length || this.recipientGroups().length) {\n            badges.add('private', Badge.component({\n                type: 'private',\n                label: app.translator.trans('fof-byobu.forum.badges.is_private.tooltip'),\n                icon: 'fas fa-map'\n            }), 10);\n        }\n    });\n}\n","import {extend} from 'flarum/extend';\nimport UserControls from 'flarum/utils/UserControls';\nimport PrivateDiscussionComposer from \"./components/PrivateDiscussionComposer\";\nimport Button from 'flarum/components/Button';\nimport ItemList from 'flarum/utils/ItemList';\n\nexport default function () {\n    // Add a control allowing the discussion to be moved to another category.\n    extend(UserControls, 'userControls', function (items, user) {\n        if (app.session.user &&\n            app.session.user.id() !== user.id() &&\n            app.forum.attribute('canStartPrivateDiscussion') &&\n            (user.blocksPd() === false || (app.forum.attribute('canStartPrivateDiscussionWithBlockers') && user.cannotBeDirectMessaged()))\n        ) {\n            items.add('private-discussion', Button.component({\n                children: app.translator.trans('fof-byobu.forum.buttons.send_pd', {username: user.username()}),\n                icon: 'far fa-map',\n                onclick: () => {\n                    const deferred = m.deferred();\n\n                    let recipients = new ItemList();\n                    recipients.add('users:' + user.id(), user);\n                    recipients.add('users:' + app.session.user.id(), app.session.user);\n\n                    PrivateDiscussionComposer.prototype.recipients = recipients;\n\n                    const component = new PrivateDiscussionComposer();\n\n                    app.composer.load(component);\n                    app.composer.show();\n\n                    deferred.resolve(component);\n\n                    return deferred.promise;\n                }\n            }));\n        }\n\n        return items;\n    });\n}\n","import {extend} from 'flarum/extend';\nimport SettingsPage from 'flarum/components/SettingsPage';\nimport Switch from \"flarum/components/Switch\";\n\nexport default function () {\n    extend(SettingsPage.prototype, 'privacyItems', function (items) {\n        items.add('byobu-block-dm',\n            Switch.component({\n                children: app.translator.trans('fof-byobu.forum.user.settings.block_pd'),\n                state: this.user.preferences().blocksPd,\n                onchange: (value, component) => this.preferenceSaver('blocksPd')(value, component)\n            })\n        )\n    });\n}\n","import DiscussionList from 'flarum/components/DiscussionList';\n\nexport default class PrivateDiscussionList extends DiscussionList\n{\n}\n","import UserPage from 'flarum/components/UserPage';\nimport PrivateDiscussionList from './PrivateDiscussionList';\nimport Button from 'flarum/components/Button';\nimport Dropdown from 'flarum/components/Dropdown';\nimport LogInModal from 'flarum/components/LogInModal';\nimport PrivateDiscussionComposer from './PrivateDiscussionComposer';\n\nexport default class PrivateDiscussionsUserPage extends UserPage {\n    init() {\n        super.init();\n\n        this.changeSort('latest');\n    }\n\n    show(user) {\n        // We can not create the list in init because the user will not be available if it has to be loaded asynchronously\n        this.list = new PrivateDiscussionList({\n            params: {\n                q: `byobu:${user.username()} is:private`,\n                sort: this.sort\n            }\n        });\n\n        this.list.refresh();\n\n        // We call the parent method after creating the list, this way the this.list propert\n        // is set before content() is called for the first time\n        super.show(user);\n    }\n\n    newDiscussionAction(e) {\n        e.preventDefault();\n\n        const deferred = m.deferred();\n\n        if (app.session.user) {\n            const component = new PrivateDiscussionComposer({ user: app.session.user });\n\n            app.composer.load(component);\n\n            deferred.resolve(component);\n        } else {\n            deferred.reject();\n\n            app.modal.show(new LogInModal());\n        }\n\n        return deferred.promise;\n    }\n\n    handleChangeSort(sort, e) {\n        e.preventDefault();\n\n        this.changeSort(sort);\n    }\n\n    changeSort(sort) {\n        this.sort = sort;\n        this.loadUser(m.route.param('username'));\n    }\n\n    content() {\n        const canStartDiscussion = app.forum.attribute('canStartDiscussion') || !app.session.user;\n\n        const sortMap = this.list.sortMap();\n        const sortOptions = {};\n        for (const i in sortMap) {\n          sortOptions[i] = app.translator.trans('core.forum.index_sort.' + i + '_button');\n        }\n\n        return (\n            <div className=\"DiscussionsUserPage\">\n                <div className=\"DiscussionsUserPage-toolbar\">\n                    <ul className=\"DiscussionsUserPage-toolbar-action\">\n                        <li>\n                            {Button.component({\n                                children: app.translator.trans(canStartDiscussion ? 'fof-byobu.forum.nav.start_button' : 'core.forum.index.cannot_start_discussion_button'),\n                                // icon: 'fas fa-edit',\n                                className: 'Button Button--primary IndexPage-newDiscussion',\n                                itemClassName: 'App-primaryControl',\n                                onclick: this.newDiscussionAction.bind(this),\n                                disabled: !canStartDiscussion\n                            })}\n                        </li>\n                    </ul>\n                    <ul className=\"DiscussionsUserPage-toolbar-view\">\n                        <li>\n                            {Dropdown.component({\n                                buttonClassName: 'Button',\n                                label: sortOptions[this.sort] || Object.keys(sortMap).map(key => sortOptions[key])[0],\n                                children: Object.keys(sortOptions).map(value => {\n                                    const label = sortOptions[value];\n                                    const active = (this.sort || Object.keys(sortMap)[0]) === value;\n\n                                    return Button.component({\n                                        children: label,\n                                        icon: active ? 'fas fa-check' : true,\n                                        onclick: this.handleChangeSort.bind(this, value),\n                                        active: active,\n                                    })\n                                }),\n                            })}\n                        </li>\n                    </ul>\n                    </div>\n                {this.list.render()}\n            </div>\n        );\n    }\n}\n","import {extend} from 'flarum/extend';\nimport UserPage from 'flarum/components/UserPage';\nimport LinkButton from 'flarum/components/LinkButton';\n\nimport PrivateDiscussionsUserPage from \"./components/PrivateDiscussionsUserPage\";\n\nexport default function () {\n    if (!Number(app.data['fof-byobu.enable_byobu_user_page'])) return;\n\n    app.routes['user.byobu'] = {path: '/u/:username/byobu', component: PrivateDiscussionsUserPage.component()};\n    app.routes['user.pd'] = {path: '/u/:username/pd', component: PrivateDiscussionsUserPage.component()};\n\n    extend(UserPage.prototype, 'navItems', function (items) {\n        const href = app.route('user.byobu', {username: this.user.username()});\n\n        // Hide links from guests if they are not already on the page\n        if (!app.session.user && m.route() !== href) return;\n\n        items.add('byobu',\n            LinkButton.component({\n                href,\n                children: app.translator.trans('fof-byobu.forum.user.byobu_link'),\n                icon: 'fas fa-map'\n            }),\n            85\n        );\n    })\n}\n","import Notification from 'flarum/components/Notification';\n\nexport default class PrivateDiscussionNotification extends Notification {\n  icon() {\n    return 'fas fa-map';\n  }\n\n  href() {\n    const notification = this.props.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    const user = this.props.notification.fromUser();\n    return app.translator.trans('fof-byobu.forum.notifications.pd_text', {\n      username: user.data.attributes.username,\n    });\n  }\n}","import Notification from 'flarum/components/Notification';\n\nexport default class PrivateDiscussionNotification extends Notification {\n  icon() {\n    return 'fas fa-map';\n  }\n\n  href() {\n    const notification = this.props.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    const user = this.props.notification.fromUser();\n    return app.translator.trans('fof-byobu.forum.notifications.pd_added_text', {\n      username: user.data.attributes.username,\n    });\n  }\n}","import Notification from 'flarum/components/Notification';\n\nexport default class PrivateDiscussionReplyNotification extends Notification {\n  icon() {\n    return 'fas fa-reply';\n  }\n\n  href() {\n    const notification = this.props.notification;\n    const discussion = notification.subject();\n    const content = notification.content() || {};\n\n    return app.route.discussion(discussion, content.postNumber);\n  }\n\n  content() {\n    const user = this.props.notification.fromUser();\n    return app.translator.trans('fof-byobu.forum.notifications.pd_reply_text', {\n      username: user.data.attributes.username,\n    });\n  }\n}","import { extend } from 'flarum/extend';\nimport LinkButton from 'flarum/components/LinkButton';\nimport SessionDropdown from 'flarum/components/SessionDropdown'\n\nexport default () => {\n    extend(SessionDropdown.prototype, 'items', items => {\n        const user = app.session.user;\n\n        items.add('privateDiscussions',\n            LinkButton.component({\n                icon: 'fas fa-map',\n                children: app.translator.trans('fof-byobu.forum.user.dropdown_label'),\n                href: app.route('user.pd', { username: user.username() }),\n            }),\n            99\n        );\n    })\n};","import { extend, override } from \"flarum/extend\";\nimport PrivateDiscussionComposer from \"./components/PrivateDiscussionComposer\";\n\nexport default function () {\n    PrivateDiscussionComposer.prototype.tags = [];\n\n    extend(PrivateDiscussionComposer.prototype, 'headerItems', function (items) {\n        items.remove('tags');\n    });\n\n    override(PrivateDiscussionComposer.prototype, 'onsubmit', function (original) {\n        const tag = app.store.getBy('tags', 'slug', 'general-discussion');\n\n        this.tags = [tag];\n\n        original();\n    });\n\n    extend(PrivateDiscussionComposer.prototype, 'data', function (data) {\n        data.relationships = data.relationships || {};\n        data.relationships.tags = this.tags;\n    });\n}\n","import { extend } from 'flarum/extend';\nimport Page from 'flarum/components/Page';\nimport ItemList from 'flarum/utils/ItemList';\nimport listItems from 'flarum/helpers/listItems';\nimport icon from 'flarum/helpers/icon';\nimport PrivateDiscussionList from './PrivateDiscussionList';\nimport WelcomeHero from 'flarum/components/WelcomeHero';\nimport PrivateDiscussionComposer from './PrivateDiscussionComposer';\nimport LogInModal from 'flarum/components/LogInModal';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\nimport Select from 'flarum/components/Select';\nimport Button from 'flarum/components/Button';\nimport LinkButton from 'flarum/components/LinkButton';\nimport SelectDropdown from 'flarum/components/SelectDropdown';\n\nexport default class PrivateDiscussionIndex extends Page\n{\n    init() {\n        super.init();\n\n        // If the user is returning from a discussion page, then take note of which\n        // discussion they have just visited. After the view is rendered, we will\n        // scroll down so that this discussion is in view.\n        if (app.previous instanceof DiscussionPage) {\n            this.lastDiscussion = app.previous.discussion;\n        }\n\n        // If the user is coming from the discussion list, then they have either\n        // just switched one of the parameters (filter, sort, search) or they\n        // probably want to refresh the results. We will clear the discussion list\n        // cache so that results are reloaded.\n        if (app.previous instanceof PrivateDiscussionIndex) {\n            app.cache.privateDiscussionList = null;\n        }\n\n        const params = this.params();\n\n        if (app.cache.privateDiscussionList) {\n            // Compare the requested parameters (sort, search query) to the ones that\n            // are currently present in the cached discussion list. If they differ, we\n            // will clear the cache and set up a new discussion list component with\n            // the new parameters.\n            Object.keys(params).some(key => {\n                if (app.cache.privateDiscussionList.props.params[key] !== params[key]) {\n                    app.cache.privateDiscussionList = null;\n                    return true;\n                }\n            });\n        }\n\n        if (!app.cache.privateDiscussionList) {\n            app.cache.privateDiscussionList = new PrivateDiscussionList({params});\n        }\n\n        app.history.push('private-index', icon('far fa-map'));\n\n        this.bodyClass = 'App--index';\n    }\n\n    onunload() {\n        // Save the scroll position so we can restore it when we return to the\n        // discussion list.\n        app.cache.scrollTop = $(window).scrollTop();\n    }\n\n    view() {\n        return (\n            <div className=\"IndexPage\">\n                {this.hero()}\n                <div className=\"container\">\n                    <nav className=\"IndexPage-nav sideNav\">\n                        <ul>{listItems(this.sidebarItems().toArray())}</ul>\n                    </nav>\n                    <div className=\"IndexPage-results sideNavOffset\">\n                        <div className=\"IndexPage-toolbar\">\n                            <ul className=\"IndexPage-toolbar-view\">{listItems(this.viewItems().toArray())}</ul>\n                            <ul className=\"IndexPage-toolbar-action\">{listItems(this.actionItems().toArray())}</ul>\n                        </div>\n                        {app.cache.discussionList.render()}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    config(isInitialized, context) {\n        super.config(...arguments);\n\n        if (isInitialized) return;\n\n        extend(context, 'onunload', () => $('#app').css('min-height', ''));\n\n        app.setTitle('');\n        app.setTitleCount(0);\n\n        // Work out the difference between the height of this hero and that of the\n        // previous hero. Maintain the same scroll position relative to the bottom\n        // of the hero so that the sidebar doesn't jump around.\n        const oldHeroHeight = app.cache.heroHeight;\n        const heroHeight = app.cache.heroHeight = this.$('.Hero').outerHeight();\n        const scrollTop = app.cache.scrollTop;\n\n        $('#app').css('min-height', $(window).height() + heroHeight);\n\n        // Scroll to the remembered position. We do this after a short delay so that\n        // it happens after the browser has done its own \"back button\" scrolling,\n        // which isn't right. https://github.com/flarum/core/issues/835\n        const scroll = () => $(window).scrollTop(scrollTop - oldHeroHeight + heroHeight);\n        scroll();\n        setTimeout(scroll, 1);\n\n        // If we've just returned from a discussion page, then the constructor will\n        // have set the `lastDiscussion` property. If this is the case, we want to\n        // scroll down to that discussion so that it's in view.\n        if (this.lastDiscussion) {\n            const $discussion = this.$(`.DiscussionListItem[data-id=\"${this.lastDiscussion.id()}\"]`);\n\n            if ($discussion.length) {\n                const indexTop = $('#header').outerHeight();\n                const indexBottom = $(window).height();\n                const discussionTop = $discussion.offset().top;\n                const discussionBottom = discussionTop + $discussion.outerHeight();\n\n                if (discussionTop < scrollTop + indexTop || discussionBottom > scrollTop + indexBottom) {\n                    $(window).scrollTop(discussionTop - indexTop);\n                }\n            }\n        }\n    }\n\n    /**\n     * Get the component to display as the hero.\n     *\n     * @return {MithrilComponent}\n     */\n    hero() {\n        return WelcomeHero.component();\n    }\n\n    /**\n     * Build an item list for the sidebar of the index page. By default this is a\n     * \"New Discussion\" button, and then a DropdownSelect component containing a\n     * list of navigation items.\n     *\n     * @return {ItemList}\n     */\n    sidebarItems() {\n        const items = new ItemList();\n        const canStartDiscussion = app.forum.attribute('canStartDiscussion') || !app.session.user;\n\n        items.add('newDiscussion',\n            Button.component({\n                children: app.translator.trans(canStartDiscussion ? 'core.forum.index.start_discussion_button' : 'core.forum.index.cannot_start_discussion_button'),\n                icon: 'fas fa-edit',\n                className: 'Button Button--primary IndexPage-newDiscussion',\n                itemClassName: 'App-primaryControl',\n                onclick: this.newDiscussion.bind(this),\n                disabled: !canStartDiscussion\n            })\n        );\n\n        items.add('nav',\n            SelectDropdown.component({\n                children: this.navItems(this).toArray(),\n                buttonClassName: 'Button',\n                className: 'App-titleControl'\n            })\n        );\n\n        return items;\n    }\n\n    /**\n     * Build an item list for the navigation in the sidebar of the index page. By\n     * default this is just the 'All Discussions' link.\n     *\n     * @return {ItemList}\n     */\n    navItems() {\n        const items = new ItemList();\n        const params = this.stickyParams();\n\n        items.add('allDiscussions',\n            LinkButton.component({\n                href: app.route('index', params),\n                children: app.translator.trans('core.forum.index.all_discussions_link'),\n                icon: 'far fa-comments'\n            }),\n            100\n        );\n\n        return items;\n    }\n\n    /**\n     * Build an item list for the part of the toolbar which is concerned with how\n     * the results are displayed. By default this is just a select box to change\n     * the way discussions are sorted.\n     *\n     * @return {ItemList}\n     */\n    viewItems() {\n        const items = new ItemList();\n        const sortMap = app.cache.discussionList.sortMap();\n\n        const sortOptions = {};\n        for (const i in sortMap) {\n            sortOptions[i] = app.translator.trans('core.forum.index_sort.' + i + '_button');\n        }\n\n        items.add('sort',\n            Select.component({\n                options: sortOptions,\n                value: this.params().sort || Object.keys(sortMap)[0],\n                onchange: this.changeSort.bind(this)\n            })\n        );\n\n        return items;\n    }\n\n    /**\n     * Build an item list for the part of the toolbar which is about taking action\n     * on the results. By default this is just a \"mark all as read\" button.\n     *\n     * @return {ItemList}\n     */\n    actionItems() {\n        const items = new ItemList();\n\n        items.add('refresh',\n            Button.component({\n                title: app.translator.trans('core.forum.index.refresh_tooltip'),\n                icon: 'fas fa-refresh',\n                className: 'Button Button--icon',\n                onclick: () => app.cache.discussionList.refresh()\n            })\n        );\n\n        if (app.session.user) {\n            items.add('markAllAsRead',\n                Button.component({\n                    title: app.translator.trans('core.forum.index.mark_all_as_read_tooltip'),\n                    icon: 'fas fa-check',\n                    className: 'Button Button--icon',\n                    onclick: this.markAllAsRead.bind(this)\n                })\n            );\n        }\n\n        return items;\n    }\n\n    /**\n     * Return the current search query, if any. This is implemented to activate\n     * the search box in the header.\n     *\n     * @see Search\n     * @return {String}\n     */\n    searching() {\n        return this.params().q;\n    }\n\n    /**\n     * Redirect to the index page without a search filter. This is called when the\n     * 'x' is clicked in the search box in the header.\n     *\n     * @see Search\n     */\n    clearSearch() {\n        const params = this.params();\n        delete params.q;\n\n        m.route(app.route(this.props.routeName, params));\n    }\n\n    /**\n     * Redirect to the index page using the given sort parameter.\n     *\n     * @param {String} sort\n     */\n    changeSort(sort) {\n        const params = this.params();\n\n        if (sort === Object.keys(app.cache.discussionList.sortMap())[0]) {\n            delete params.sort;\n        } else {\n            params.sort = sort;\n        }\n\n        m.route(app.route(this.props.routeName, params));\n    }\n\n    /**\n     * Get URL parameters that stick between filter changes.\n     *\n     * @return {Object}\n     */\n    stickyParams() {\n        return {\n            sort: m.route.param('sort'),\n            q: m.route.param('q')\n        };\n    }\n\n    /**\n     * Get parameters to pass to the DiscussionList component.\n     *\n     * @return {Object}\n     */\n    params() {\n        const params = this.stickyParams();\n\n        params.filter = m.route.param('filter');\n\n        return params;\n    }\n\n    /**\n     * Log the user in and then open the composer for a new discussion.\n     *\n     * @return {Promise}\n     */\n    newDiscussion() {\n        const deferred = m.deferred();\n\n        if (app.session.user) {\n            this.composeNewDiscussion(deferred);\n        } else {\n            app.modal.show(\n                new LogInModal({\n                    onlogin: this.composeNewDiscussion.bind(this, deferred)\n                })\n            );\n        }\n\n        return deferred.promise;\n    }\n\n    /**\n     * Initialize the composer for a new discussion.\n     *\n     * @param {Deferred} deferred\n     * @return {Promise}\n     */\n    composeNewDiscussion(deferred) {\n        const component = new PrivateDiscussionComposer({user: app.session.user});\n\n        app.composer.load(component);\n        app.composer.show();\n\n        deferred.resolve(component);\n\n        return deferred.promise;\n    }\n\n    /**\n     * Mark all discussions as read.\n     *\n     * @return void\n     */\n    markAllAsRead() {\n        const confirmation = confirm(app.translator.trans('core.forum.index.mark_all_as_read_confirmation'));\n\n        if (confirmation) {\n            app.session.user.save({readTime: new Date()});\n        }\n    }\n}\n","import EventPost from \"flarum/components/EventPost\";\nimport recipientsLabel from \"../../common/helpers/recipientsLabel\";\n\nexport default class RecipientsModified extends EventPost {\n    static initProps(props) {\n        super.initProps(props);\n\n        function diff(diff1, diff2, store) {\n            return diff1\n                .filter(item => diff2.indexOf(item) === -1)\n                .map(id => app.store.getById(store, id));\n        }\n\n        const content = props.post.content();\n\n        // For event posts existing before groups functionality.\n        if (!content['new'] && content.length == 2) {\n            const oldRecipients = props.post.content()[0];\n            const newRecipients = props.post.content()[1];\n            props.added = diff(newRecipients, oldRecipients, 'users');\n            props.removed = diff(oldRecipients, newRecipients, 'users');\n        } else {\n            var usersAdded = diff(content['new']['users'], content['old']['users'], 'users');\n            var usersRemoved = diff(content['old']['users'], content['new']['users'], 'users');\n            var groupsAdded = diff(content['new']['groups'], content['old']['groups'], 'groups');\n            var groupsRemoved = diff(content['old']['groups'], content['new']['groups'], 'groups');\n\n            props.added = usersAdded.concat(groupsAdded);\n            props.removed = usersRemoved.concat(groupsRemoved);\n        }\n    }\n\n    icon() {\n        return 'far fa-map';\n    }\n\n    descriptionKey() {\n\n        var localeBase = 'fof-byobu.forum.post.recipients_modified.';\n\n        if (this.props.added.length) {\n            if (this.props.removed.length) {\n                return localeBase + 'added_and_removed';\n            }\n\n            return localeBase + 'added';\n        }\n\n        return localeBase + 'removed';\n    }\n\n    descriptionData() {\n        const data = {};\n\n        if (this.props.added.length) {\n            data.added = recipientsLabel(this.props.added, {link: true});\n        }\n\n        if (this.props.removed.length) {\n            data.removed = recipientsLabel(this.props.removed, {link: true});\n        }\n\n        return data;\n    }\n}\n","import { extend } from 'flarum/extend';\nimport Model from \"flarum/Model\";\nimport Discussion from \"flarum/models/Discussion\";\nimport User from \"flarum/models/User\";\nimport addRecipientComposer from \"./addRecipientComposer\";\nimport addRecipientLabels from \"./addRecipientLabels\";\nimport addRecipientsControl from \"./addRecipientsControl\";\nimport addHasRecipientsBadge from \"./addHasRecipientsBadge\";\nimport addDiscussPrivatelyControl from './addDiscussPrivatelyControl';\nimport addPrivacySetting from './addPrivacySetting';\nimport addPrivateDiscussionsPage from \"./addPrivateDiscussionsPage\";\nimport NotificationGrid from 'flarum/components/NotificationGrid';\nimport PrivateDiscussionNotification from './components/PrivateDiscussionNotification';\nimport PrivateDiscussionAddedNotification from './components/PrivateDiscussionAddedNotification';\nimport PrivateDiscussionRepliedNotification from './components/PrivateDiscussionReplyNotification';\nimport addPrivateMessageSessionDropdownLinkButton from './addPrivateMessageSessionDropdownLinkButton';\nimport removeTagComposer from './removeTagComposer';\nimport PrivateDiscussionIndex from \"./components/PrivateDiscussionIndex\";\nimport RecipientsModified from \"./components/RecipientsModified\";\n\napp.initializers.add('fof-byobu', function (app) {\n    app.routes.private_discussions = { path: '/private-discussions', component: PrivateDiscussionIndex.component() };\n\n    Discussion.prototype.recipientUsers = Model.hasMany('recipientUsers');\n    Discussion.prototype.oldRecipientUsers = Model.hasMany('oldRecipientUsers');\n    Discussion.prototype.recipientGroups = Model.hasMany('recipientGroups');\n    Discussion.prototype.oldRecipientGroups = Model.hasMany('oldRecipientGroups');\n\n    Discussion.prototype.canEditRecipients = Model.attribute('canEditRecipients');\n    Discussion.prototype.canEditUserRecipients = Model.attribute('canEditUserRecipients');\n    Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n    Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n\n    User.prototype.blocksPd = Model.attribute('blocksPd');\n    User.prototype.cannotBeDirectMessaged = Model.attribute('cannotBeDirectMessaged');\n\n    app.postComponents.recipientsModified = RecipientsModified;\n\n    addRecipientComposer(app);\n    addRecipientLabels();\n    addRecipientsControl();\n    addHasRecipientsBadge();\n    addPrivacySetting();\n    addPrivateMessageSessionDropdownLinkButton();\n\n    addDiscussPrivatelyControl();\n\n    addPrivateDiscussionsPage();\n\n    app.notificationComponents.byobuPrivateDiscussionCreated = PrivateDiscussionNotification;\n    app.notificationComponents.byobuPrivateDiscussionReplied = PrivateDiscussionRepliedNotification;\n    app.notificationComponents.byobuPrivateDiscussionAdded = PrivateDiscussionAddedNotification;\n\n    // Add notification preferences.\n    extend(NotificationGrid.prototype, 'notificationTypes', function (items) {\n        items.add('byobuPrivateDiscussionCreated', {\n            name: 'byobuPrivateDiscussionCreated',\n            icon: 'fas fa-map',\n            label: app.translator.trans('fof-byobu.forum.notifications.pd_label')\n        });\n        items.add('byobuPrivateDiscussionReplied', {\n            name: 'byobuPrivateDiscussionReplied',\n            icon: 'fas fa-map',\n            label: app.translator.trans('fof-byobu.forum.notifications.pd_reply_label')\n        });\n        items.add('byobuPrivateDiscussionAdded', {\n            name: 'byobuPrivateDiscussionAdded',\n            icon: 'fas fa-map',\n            label: app.translator.trans('fof-byobu.forum.notifications.pd_added_label')\n        });\n    });\n\n    removeTagComposer();\n});\n","module.exports = flarum.core.compat['components/DiscussionComposer'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Search'];","module.exports = flarum.core.compat['helpers/avatar'];","module.exports = flarum.core.compat['utils/extractText'];","module.exports = flarum.core.compat['components/LoadingIndicator'];","module.exports = flarum.core.compat['components/DiscussionListItem'];","module.exports = flarum.core.compat['components/DiscussionHero'];","module.exports = flarum.core.compat['utils/DiscussionControls'];","module.exports = flarum.core.compat['components/Badge'];","module.exports = flarum.core.compat['utils/UserControls'];","module.exports = flarum.core.compat['components/SettingsPage'];","module.exports = flarum.core.compat['components/Dropdown'];","module.exports = flarum.core.compat['components/NotificationGrid'];","module.exports = flarum.core.compat['components/SessionDropdown'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['components/WelcomeHero'];","module.exports = flarum.core.compat['components/SelectDropdown'];","module.exports = flarum.core.compat['components/EventPost'];"],"sourceRoot":""}