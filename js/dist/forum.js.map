<<<<<<< HEAD
{"version":3,"sources":["webpack://@fof/byobu/webpack/bootstrap","webpack://@fof/byobu/external \"flarum.core.compat['extend']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/ItemList']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Button']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/User']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/Discussion']\"","webpack://@fof/byobu/external \"flarum.core.compat['Model']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/Group']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LinkButton']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Switch']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Select']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionComposer']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/highlight']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/username']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/extract']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionList']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/UserPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LogInModal']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/listItems']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/classList']\"","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionComposer.js","webpack://@fof/byobu/./src/forum/components/sources/UserSearchSource.js","webpack://@fof/byobu/./src/forum/components/sources/GroupSearchSource.js","webpack://@fof/byobu/./src/common/helpers/recipientLabel.js","webpack://@fof/byobu/./src/forum/components/RecipientSearch.js","webpack://@fof/byobu/./src/forum/components/AddRecipientModal.js","webpack://@fof/byobu/./src/common/helpers/recipientCountLabel.js","webpack://@fof/byobu/./src/forum/addRecipientComposer.js","webpack://@fof/byobu/./src/common/helpers/recipientsLabel.js","webpack://@fof/byobu/./src/forum/addRecipientLabels.js","webpack://@fof/byobu/./src/forum/addRecipientsControl.js","webpack://@fof/byobu/./src/forum/addHasRecipientsBadge.js","webpack://@fof/byobu/./src/forum/addDiscussPrivatelyControl.js","webpack://@fof/byobu/./src/forum/addPrivacySetting.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionList.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionsUserPage.js","webpack://@fof/byobu/./src/forum/addPrivateDiscussionsPage.js","webpack://@fof/byobu/./src/forum/addPrivateMessageSessionDropdownLinkButton.js","webpack://@fof/byobu/./src/forum/removeTagComposer.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionNotification.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionIndex.js","webpack://@fof/byobu/./src/forum/components/RecipientsModified.js","webpack://@fof/byobu/./src/forum/index.js","webpack://@fof/byobu/external \"flarum.core.compat['components/Modal']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Search']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/avatar']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/extractText']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LoadingIndicator']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionListItem']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionHero']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/DiscussionControls']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Badge']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/UserControls']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/SettingsPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/SessionDropdown']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/NotificationGrid']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Notification']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Page']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/icon']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/WelcomeHero']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/SelectDropdown']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/EventPost']\""],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","_inheritsLoose","subClass","superClass","constructor","__proto__","PrivateDiscussionComposer_PrivateDiscussionComposer","DiscussionComposer_default","a","UserSearchSource_UserSearchSource","view","query","_this","this","length","loading","app","cache","byobuResults","className","translator","trans","map","user","username_default","children","highlight_default","data-index","id","avatar_default","store","find","filter","q","page","limit","then","pushResults","results","_this2","payload","data","result","getById","push","redraw","GroupSearchSource_GroupSearchSource","search","toLowerCase","all","group","namePlural","substr","groupName","class","recipientLabel","recipient","attrs","style","label","link","extract_default","User_default","title","username","href","route","config","Group_default","RecipientSearch_RecipientSearch","isInitialized","$search","$","on","e","target","addRecipient","focus","parentNode","clearTimeout","typingTimer","doSearch","setTimeout","_Search","sources","sourceItems","toArray","props","selected","onclick","removeRecipient","classList_default","open","focused","active","loadingSources","element","type","placeholder","extractText_default","oninput","withAttr","onfocus","hasFocus","onblur","in","source","LoadingIndicator_default","component","size","items","ItemList_default","discussion","forum","attribute","canEditUserRecipients","add","canEditGroupRecipients","clear","values","split","findRecipient","remove","Search_default","AddRecipientModal_AddRecipientModal","init","_Modal","prop","assignInitialRecipients","selectedRecipients","merge","session","recipientSearch","recipientUsers","recipientGroups","content","isDisabled","Button_default","disabled","icon","select","metaKey","ctrlKey","indexOf","index","submit","onsubmit","preventDefault","recipients","forEach","save","relationships","current","DiscussionPage_default","stream","update","modal","close","strategy","Modal_default","recipientCountLabel","count","transChoice","recipientsLabel","addRecipientsControl","external_flarum_core_compat_extend_","DiscussionControls_default","canEditRecipients","show","addHasRecipientsBadge","Discussion_default","badges","Badge_default","addDiscussPrivatelyControl","UserControls_default","blocksPd","cannotBeDirectMessaged","deferred","composer","load","resolve","promise","addPrivacySetting","SettingsPage_default","Switch_default","state","preferences","onchange","preferenceSaver","PrivateDiscussionList_PrivateDiscussionList","DiscussionList_default","PrivateDiscussionsUserPage_PrivateDiscussionsUserPage","_UserPage","loadUser","param","list","params","sort","refresh","newDiscussionAction","reject","LogInModal_default","canStartDiscussion","itemClassName","marginBottom","render","UserPage_default","addPrivateDiscussionsPage","Number","routes","path","LinkButton_default","addPrivateMessageSessionDropdownLinkButton","SessionDropdown_default","removeTagComposer","tags","original","tag","getBy","PrivateDiscussionNotification_PrivateDiscussionNotification","notification","subject","fromUser","attributes","PrivateDiscussionIndex_PrivateDiscussionIndex","_Page","previous","lastDiscussion","PrivateDiscussionIndex","privateDiscussionList","keys","some","history","icon_default","bodyClass","onunload","scrollTop","window","hero","listItems_default","sidebarItems","viewItems","actionItems","discussionList","context","apply","arguments","css","setTitle","setTitleCount","oldHeroHeight","heroHeight","outerHeight","height","scroll","$discussion","indexTop","indexBottom","discussionTop","offset","top","discussionBottom","WelcomeHero_default","newDiscussion","SelectDropdown_default","navItems","buttonClassName","stickyParams","sortMap","sortOptions","Select_default","options","changeSort","markAllAsRead","searching","clearSearch","routeName","composeNewDiscussion","onlogin","confirm","readTime","Date","Page_default","RecipientsModified_RecipientsModified","initProps","diff","diff1","diff2","item","_EventPost","post","usersAdded","usersRemoved","groupsAdded","groupsRemoved","added","concat","removed","oldRecipients","newRecipients","descriptionKey","localeBase","descriptionData","initializers","private_discussions","external_flarum_core_compat_Model_default","hasMany","oldRecipientUsers","oldRecipientGroups","postComponents","recipientsModified","addDefaultRecipients","chooseRecipients","users","groups","addRecipientComposer","addToDiscussion","long","DiscussionListItem_default","include","DiscussionHero_default","addRecipientLabels","notificationComponents","byobuPrivateDiscussionCreated","NotificationGrid_default"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 46);\n","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['models/User'];","module.exports = flarum.core.compat['models/Discussion'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['models/Group'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['components/LinkButton'];","module.exports = flarum.core.compat['components/Switch'];","module.exports = flarum.core.compat['components/Select'];","module.exports = flarum.core.compat['components/DiscussionComposer'];","module.exports = flarum.core.compat['helpers/highlight'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['utils/extract'];","module.exports = flarum.core.compat['components/DiscussionList'];","module.exports = flarum.core.compat['components/UserPage'];","module.exports = flarum.core.compat['components/LogInModal'];","module.exports = flarum.core.compat['helpers/listItems'];","module.exports = flarum.core.compat['utils/classList'];","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","\nimport DiscussionComposer from \"flarum/components/DiscussionComposer\";\n\nexport default class PrivateDiscussionComposer extends DiscussionComposer {\n\n}","import highlight from 'flarum/helpers/highlight';\nimport avatar from 'flarum/helpers/avatar';\nimport username from 'flarum/helpers/username';\n\nexport default class UserSearchSource {\n    view(query) {\n        if (query.length < 3 || this.loading) return;\n\n        if (!app.cache.byobuResults) {\n            app.cache.byobuResults = [];\n        }\n\n        this.query = query;\n\n        if (!app.cache.byobuResults[this.query]) {\n\n            this.loading = true;\n\n            app.cache.byobuResults[this.query] = [];\n            app.store.find('users', {\n                filter: {q: this.query + ' allows-pd'},\n                page: {limit: 5}\n            }).then(this.pushResults.bind(this));\n        } else\n\n            return [\n                <li className=\"Dropdown-header\">{app.translator.trans('core.forum.search.users_heading')}</li>,\n                app.cache.byobuResults[this.query].map(user => {\n                    const name = username(user);\n                    name.children[0] = highlight(name.children[0], this.query);\n\n                    return (\n                        <li className='SearchResult' data-index={'users:' + user.id()}>\n                            <a data-index={'users:' + user.id()}>\n                                {avatar(user)}\n                                {name}\n                            </a>\n                        </li>\n                    );\n                })\n            ];\n    }\n\n    pushResults(results) {\n        results.payload.data.map(result => {\n            var user = app.store.getById('users', result.id);\n            app.cache.byobuResults[this.query].push(user);\n        });\n        this.loading = false;\n        m.redraw();\n    }\n}\n","import highlight from 'flarum/helpers/highlight';\n\nexport default class GroupSearchSource {\n    search(query) {\n        return app.store.find('groups', {\n            filter: {q: query},\n            page: {limit: 5}\n        });\n    }\n\n    view(query) {\n        query = query.toLowerCase();\n\n        const results = app.store.all('groups')\n            .filter(group => group.namePlural().toLowerCase().substr(0, query.length) === query);\n\n        if (!results.length) return '';\n\n        return [\n            <li className=\"Dropdown-header\">{app.translator.trans('fof-byobu.forum.search.headings.groups')}</li>,\n            results.map(group => {\n                const groupName = group.namePlural();\n                var name = highlight(groupName, query);\n\n                return (\n                    <li className=\"SearchResult\" data-index={'groups:' + group.id()}>\n                        <a data-index={'groups:' + group.id()}>\n                            <span class=\"groupName\">{name}</span>\n                        </a>\n                    </li>\n                );\n            })\n        ];\n    }\n}\n","import extract from 'flarum/utils/extract';\nimport username from 'flarum/helpers/username';\nimport User from 'flarum/models/User';\nimport Group from 'flarum/models/Group';\n\nexport default function recipientLabel(recipient, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'RecipientLabel ' + (attrs.className || '');\n\n  const link = extract(attrs, 'link');\n\n  var label;\n\n  if (recipient instanceof User) {\n      label = username(recipient);\n\n      if (link) {\n          attrs.title = recipient.username() || '';\n          attrs.href = app.route.user(recipient);\n          attrs.config = m.route;\n      }\n  } else if (recipient instanceof Group) {\n      label = recipient.namePlural();\n  } else {\n      attrs.className += ' none';\n      label = app.translator.trans('fof-byobu.forum.labels.user_deleted');\n  }\n\n  return (\n    m((link ? 'a' : 'span'), attrs,\n        <span className=\"RecipientLabel-text\">\n            {label}\n        </span>\n    )\n  );\n}\n","import Search from \"flarum/components/Search\";\nimport UserSearchSource from \"./sources/UserSearchSource\";\nimport GroupSearchSource from \"./sources/GroupSearchSource\";\nimport ItemList from \"flarum/utils/ItemList\";\nimport classList from \"flarum/utils/classList\";\nimport extractText from \"flarum/utils/extractText\";\nimport LoadingIndicator from \"flarum/components/LoadingIndicator\";\nimport recipientLabel from \"../../common/helpers/recipientLabel\";\nimport User from \"flarum/models/User\";\nimport Group from \"flarum/models/Group\";\n\nexport default class RecipientSearch extends Search {\n\n    config(isInitialized) {\n        if (isInitialized) return;\n\n        const $search = this;\n\n        this.$('.Search-results').on('click', (e) => {\n            const target = this.$('.SearchResult.active')\n\n            $search.addRecipient(target.data('index'));\n            $search.$('.RecipientsInput').focus();\n        });\n\n        this.$('.Search-results').on('touchstart', (e) => {\n            const target = this.$(e.target.parentNode);\n\n            $search.addRecipient(target.data('index'));\n            $search.$('.RecipientsInput').focus();\n        });\n\n        $('.RecipientsInput').on('keyup', () => {\n            clearTimeout(this.typingTimer);\n            this.doSearch = false;\n            this.typingTimer = setTimeout(() => {\n                this.doSearch = true;\n                m.redraw();\n            }, 900);\n        }).on('keydown', () => {\n            clearTimeout(this.typingTimer);\n        });\n\n        super.config(isInitialized);\n    }\n\n    view() {\n        if (typeof this.value() === 'undefined') {\n            this.value('');\n        }\n\n        const loading = this.value() && this.value().length >= 3;\n\n        if (!this.sources) {\n            this.sources = this.sourceItems().toArray();\n        }\n\n        return m('div', {\n            className: 'AddRecipientModal-form-input'\n        }, [\n            m('div', {\n                className: 'RecipientsInput-selected RecipientsLabel'\n            }, this.props.selected().toArray().map(recipient =>\n                recipientLabel(recipient, {\n                    onclick: () => {\n                        this.removeRecipient(recipient);\n                    }\n                })\n            )),\n            m('input', {\n                className: 'RecipientsInput FormControl ' + classList({\n                    open: !!this.value(),\n                    focused: !!this.value(),\n                    active: !!this.value(),\n                    loading: !!this.loadingSources\n                }),\n                config: function (element) {\n                    element.focus();\n                },\n                type: 'search',\n                placeholder: extractText(app.translator.trans('fof-byobu.forum.input.search_recipients')),\n                value: this.value(),\n                oninput: m.withAttr('value', this.value),\n                onfocus: () => this.hasFocus = true,\n                onblur: () => this.hasFocus = false\n            }),\n            m('ul', {\n                className: 'Dropdown-menu Search-results fade ' + classList({\n                    in: !!loading\n                })\n            }, !this.doSearch\n                ? LoadingIndicator.component({size: 'tiny', className: 'Button Button--icon Button--link'})\n                : this.sources.map(source => source.view(this.value()))\n            )\n        ]);\n    }\n\n    /**\n     * Build an item list of SearchSources.\n     *\n     * @return {ItemList}\n     */\n    sourceItems() {\n        const items = new ItemList();\n\n        // Add user source based on permissions.\n        if (\n            (!this.props.discussion && app.forum.attribute('canStartPrivateDiscussionWithUsers')) ||\n            (this.props.discussion && this.props.discussion.canEditUserRecipients())\n        ) {\n            items.add('users', new UserSearchSource());\n        }\n\n        // Add group source based on permissions.\n        if (\n            (!this.props.discussion && app.forum.attribute('canStartPrivateDiscussionWithGroups')) ||\n            (this.props.discussion && this.props.discussion.canEditGroupRecipients())\n        ) {\n            items.add('groups', new GroupSearchSource());\n        }\n\n        return items;\n    }\n\n\n    /**\n     * Clear the search input and the current controller's active search.\n     */\n    clear() {\n        this.value('');\n\n        m.redraw();\n    }\n\n    /**\n     * Adds a recipient.\n     *\n     * @param value\n     */\n    addRecipient(value) {\n\n        let values = value.split(':'),\n            type = values[0],\n            id = values[1];\n\n        let recipient = this.findRecipient(type, id);\n\n        this.props.selected().add(value, recipient);\n\n        this.clear();\n    }\n\n    /**\n     * Removes a recipient.\n     *\n     * @param recipient\n     */\n    removeRecipient(recipient) {\n        let type;\n\n        if (recipient instanceof User) {\n            type = 'users';\n        }\n        if (recipient instanceof Group) {\n            type = 'groups';\n        }\n\n        this.props.selected().remove(type + \":\" + recipient.id());\n\n        m.redraw();\n    }\n\n    /**\n     * Loads a recipient from the global store.\n     *\n     * @param store\n     * @param id\n     * @returns {Model}\n     */\n    findRecipient(store, id) {\n        return app.store.getById(store, id);\n    }\n}\n","import Modal from \"flarum/components/Modal\";\nimport DiscussionPage from \"flarum/components/DiscussionPage\";\nimport Button from \"flarum/components/Button\";\nimport ItemList from \"flarum/utils/ItemList\";\nimport RecipientSearch from \"./RecipientSearch\";\nimport User from \"flarum/models/User\";\nimport Group from \"flarum/models/Group\";\n\nexport default class AddRecipientModal extends Modal {\n    init() {\n        super.init();\n\n        this.selected = m.prop(new ItemList);\n\n        if (this.props.discussion) {\n            // Adds recipients of the currently viewed discussion.\n            this.assignInitialRecipients(this.props.discussion);\n        } else if (this.props.selectedRecipients.toArray().length > 0) {\n            // Adds previously selected recipients.\n            this.selected().merge(this.props.selectedRecipients);\n        } else {\n            // Adds the current user in case there are no selected recipients yet and this is a new discussion.\n            this.selected().add(\"users:\" + app.session.user.id(), app.session.user);\n        }\n\n        this.recipientSearch = RecipientSearch.component({\n            selected: this.selected,\n            discussion: this.props.discussion\n        });\n    }\n\n    // todo: Add cancel button to replace modal X\n    // isDismissible() {\n    //     return false;\n    // }\n\n    assignInitialRecipients(discussion) {\n        discussion.recipientUsers().map(user => {\n            this.selected().add(\"users:\" + user.id(), user);\n        });\n        discussion.recipientGroups().map(group => {\n            this.selected().add(\"groups:\" + group.id(), group);\n        });\n    }\n\n    className() {\n        return 'AddRecipientModal';\n    }\n\n    title() {\n        return this.props.discussion\n            ? app.translator.trans('fof-byobu.forum.modal.titles.update_recipients', { title: <em>{this.props.discussion.title()}</em> })\n            : app.translator.trans('fof-byobu.forum.modal.titles.add_recipients');\n    }\n\n    content() {\n        const isDisabled = this.selected().toArray().length < 2;\n\n        return [\n            <div className=\"Modal-body\">\n                <div className=\"AddRecipientModal-form\">\n                    {this.recipientSearch}\n                    <div className=\"AddRecipientModal-form-submit App-primaryControl\">\n                        {Button.component({\n                            type: 'submit',\n                            className: 'Button Button--primary',\n                            disabled: isDisabled,\n                            icon: 'fas fa-check',\n                            children: app.translator.trans('fof-byobu.forum.buttons.submit')\n                        })}\n                        {/* {Button.component({\n                            onclick: this.hide.bind(this),\n                            className: 'Button Button--primary',\n                            children: app.translator.trans('fof-byobu.forum.buttons.cancel')\n                        })} */}\n                    </div>\n                </div>\n            </div>\n        ];\n    }\n\n    select(e) {\n        // Ctrl + Enter submits the selection, just Enter completes the current entry\n        if (e.metaKey || e.ctrlKey || this.selected.indexOf(this.index) !== -1) {\n            if (this.selected().length) {\n                this.$('form').submit();\n            }\n        }\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        const discussion = this.props.discussion;\n        const recipients = this.selected();\n\n        let recipientGroups = [];\n        let recipientUsers = [];\n\n        recipients.toArray().forEach(recipient => {\n            if (recipient instanceof User) {\n                recipientUsers.push(recipient);\n            }\n            if (recipient instanceof Group) {\n                recipientGroups.push(recipient);\n            }\n        });\n\n        // Recipients are updated here for existing discussions here.\n        if (discussion) {\n            discussion.save({ relationships: { recipientUsers, recipientGroups } })\n                .then(() => {\n                    if (app.current instanceof DiscussionPage) {\n                        app.current.stream.update();\n                    }\n                    m.redraw();\n                });\n        }\n\n        // Use the onsubmit callback to trigger an update in the DiscussionComposer\n        if (this.props.onsubmit) this.props.onsubmit(recipients);\n\n        app.modal.close();\n\n        m.redraw.strategy('none');\n    }\n}\n","export default function recipientCountLabel(count, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'RecipientLabel ' + (attrs.className || '');\n\n  var label = app.translator.transChoice('fof-byobu.forum.labels.recipients', count, {count});\n\n  return (\n    m('span', attrs,\n        <span className=\"RecipientLabel-text\">\n            {label}\n        </span>\n    )\n  );\n}\n","import { extend, override } from \"flarum/extend\";\nimport PrivateDiscussionComposer from \"./components/PrivateDiscussionComposer\";\nimport AddRecipientModal from \"./components/AddRecipientModal\";\nimport recipientCountLabel from \"../common/helpers/recipientCountLabel\";\nimport User from \"flarum/models/User\";\nimport Group from \"flarum/models/Group\";\nimport ItemList from \"flarum/utils/ItemList\";\n\nexport default function (app) {\n    // Add recipient-selection abilities to the discussion composer.\n    PrivateDiscussionComposer.prototype.recipients = new ItemList;\n    PrivateDiscussionComposer.prototype.recipientUsers = [];\n    PrivateDiscussionComposer.prototype.recipientGroups = [];\n\n    PrivateDiscussionComposer.prototype.addDefaultRecipients = function (username) {\n        const user = app.store.getBy('users', 'username', username);\n\n        this.recipients.add('users:' + app.session.user.id(), app.session.user);\n        if(user.id() !== app.session.user.id()) {\n            this.recipients.add('users:' + user.id(), user);\n        }\n    };\n\n    override(PrivateDiscussionComposer.prototype, 'init', function(original) {\n        original();\n\n        const username = m.route.param('username');\n\n        if(typeof username !== 'undefined') {\n           this.addDefaultRecipients(username); \n        }\n    });\n\n\n    // Add a recipient selection modal when clicking the recipient tag label.\n    PrivateDiscussionComposer.prototype.chooseRecipients = function () {\n        app.modal.show(\n            new AddRecipientModal({\n                selectedRecipients: this.recipients,\n                onsubmit: (recipients) => {\n                    this.recipients = recipients;\n\n                    // Focus on recipient autocomplete field.\n                    this.$('.RecipientsInput').focus();\n                }\n            })\n        )\n    };\n\n    // Add a tag-selection menu to the discussion composer's header, after the\n    // title.\n    extend(PrivateDiscussionComposer.prototype, 'headerItems', function (items) {\n        if (app.session.user && app.forum.attribute('canStartPrivateDiscussion')) {\n            const recipients = this.recipients.toArray();\n\n            items.add('recipients', (\n                <a className=\"PrivateDiscussionComposer-changeRecipients\"\n                    onclick={this.chooseRecipients.bind(this)}>\n                    {recipients.length\n                        ? recipientCountLabel(recipients.length)\n                        : <span className=\"RecipientLabel none\">{app.translator.trans('fof-byobu.forum.buttons.add_recipients')}</span>}\n                </a>\n            ), 5);\n        }\n    });\n \n    override(PrivateDiscussionComposer.prototype, 'onsubmit', function (original) {\n        const recipients = this.recipients.toArray();\n        if (recipients.length < 2) {\n            app.modal.show(\n                new AddRecipientModal({\n                    selectedRecipients: this.recipients,\n                    onsubmit: (recipients) => {\n                        this.recipients = recipients;\n                        //todo: make this better?\n                        original();\n                    }\n                })\n            )\n        } else {\n            original();\n        }\n    });\n\n    // Add the selected tags as data to submit to the server.\n    extend(PrivateDiscussionComposer.prototype, 'data', function (data) {\n        const users = [];\n        const groups = [];\n        this.recipients.toArray().forEach(recipient => {\n\n            if (recipient instanceof User) {\n                users.push(recipient);\n            }\n\n            if (recipient instanceof Group) {\n                groups.push(recipient);\n            }\n        });\n\n        data.relationships = data.relationships || {};\n\n        if (users.length) {\n            data.relationships.recipientUsers = users;\n        }\n\n        if (groups.length) {\n            data.relationships.recipientGroups = groups;\n        }\n    });\n}\n","import extract from 'flarum/utils/extract';\nimport recipientLabel from './recipientLabel';\n\nexport default function recipientsLabel(recipients, attrs = {}) {\n  const children = [];\n  const link = extract(attrs, 'link');\n\n  attrs.className = 'RecipientsLabel ' + (attrs.className || '');\n\n  if (recipients) {\n      recipients.forEach(recipient => {\n          children.push(recipientLabel(recipient, {link}));\n      });\n  } else {\n    children.push(recipientLabel());\n  }\n\n  return <span {...attrs}>{children}</span>;\n}\n","import {extend} from \"flarum/extend\";\nimport DiscussionListItem from \"flarum/components/DiscussionListItem\";\nimport DiscussionPage from \"flarum/components/DiscussionPage\";\nimport DiscussionHero from \"flarum/components/DiscussionHero\";\nimport DiscussionList from \"flarum/components/DiscussionList\";\nimport recipientsLabel from \"../common/helpers/recipientsLabel\";\n\nexport default function() {\n\n    const addToDiscussion = function(discussion, items, long) {\n        let recipients = [];\n\n        if (discussion.recipientUsers().length) {\n            recipients = recipients.concat(discussion.recipientUsers());\n        }\n\n        if (discussion.recipientGroups().length) {\n            recipients = recipients.concat(discussion.recipientGroups());\n        }\n\n        if (recipients && recipients.length) {\n            if (long) {\n                items.add('recipients', recipientsLabel(recipients), 10);\n            } else {\n                items.add('recipients', recipientsLabel(recipients, {link: true}), 4);\n            }\n        }\n    };\n\n    /**\n     * Adds User labels on the discussion index page.\n     */\n    extend(DiscussionListItem.prototype, 'infoItems', function(items) {\n        const discussion = this.props.discussion;\n\n        addToDiscussion(discussion, items, true);\n    });\n\n    /**\n     * Require recipients from the API whenever we're loading a Discussion page.\n     */\n    extend(DiscussionPage.prototype, 'params', function(params) {\n        params.include.push('recipientUsers');\n        params.include.push('recipientGroups');\n    });\n    extend(DiscussionList.prototype, 'requestParams', function(params) {\n        params.include.push('recipientUsers');\n        params.include.push('recipientGroups');\n    });\n\n\n    /**\n     * Adds User labels on the discussion Hero.\n     */\n    extend(DiscussionHero.prototype, 'items', function(items) {\n        const discussion = this.props.discussion;\n\n        addToDiscussion(discussion, items, false);\n    });\n}\n","import { extend } from 'flarum/extend';\nimport DiscussionControls from 'flarum/utils/DiscussionControls';\nimport Button from 'flarum/components/Button';\n\nimport AddRecipientModal from './components/AddRecipientModal';\n\nexport default function() {\n    // Add a control allowing the discussion to be moved to another category.\n    extend(DiscussionControls, 'moderationControls', function(items, discussion) {\n        if (discussion.canEditRecipients()) {\n            items.add('recipients', Button.component({\n                children: app.translator.trans('fof-byobu.forum.buttons.edit_recipients'),\n                icon: 'far fa-map',\n                onclick: () => app.modal.show(new AddRecipientModal({discussion}))\n            }));\n        }\n    });\n}\n","import {extend} from \"flarum/extend\";\nimport Discussion from \"flarum/models/Discussion\";\nimport Badge from \"flarum/components/Badge\";\n\nexport default function addHasRecipientsBadge() {\n    extend(Discussion.prototype, 'badges', function (badges) {\n        if (this.recipientUsers().length || this.recipientGroups().length) {\n            badges.add('private', Badge.component({\n                type: 'private',\n                label: app.translator.trans('fof-byobu.forum.badges.is_private.tooltip'),\n                icon: 'fas fa-map'\n            }), 10);\n        }\n    });\n}\n","import {extend} from 'flarum/extend';\nimport UserControls from 'flarum/utils/UserControls';\nimport PrivateDiscussionComposer from \"./components/PrivateDiscussionComposer\";\nimport Button from 'flarum/components/Button';\nimport ItemList from 'flarum/utils/ItemList';\n\nexport default function () {\n    // Add a control allowing the discussion to be moved to another category.\n    extend(UserControls, 'userControls', function (items, user) {\n        if (app.session.user &&\n            app.session.user.id() !== user.id() &&\n            app.forum.attribute('canStartPrivateDiscussion') &&\n            ((user.blocksPd() === false || app.forum.attribute('canStartPrivateDiscussionWithBlockers')) && !user.cannotBeDirectMessaged())\n        ) {\n            items.add('private-discussion', Button.component({\n                children: app.translator.trans('fof-byobu.forum.buttons.send_pd', {username: user.username()}),\n                icon: 'far fa-map',\n                onclick: () => {\n                    const deferred = m.deferred();\n\n                    let recipients = new ItemList();\n                    recipients.add('users:' + user.id(), user);\n                    recipients.add('users:' + app.session.user.id(), app.session.user);\n\n                    PrivateDiscussionComposer.prototype.recipients = recipients;\n\n                    const component = new PrivateDiscussionComposer();\n\n                    app.composer.load(component);\n                    app.composer.show();\n\n                    deferred.resolve(component);\n\n                    return deferred.promise;\n                }\n            }));\n        }\n\n        return items;\n    });\n}\n","import {extend} from 'flarum/extend';\nimport SettingsPage from 'flarum/components/SettingsPage';\nimport Switch from \"flarum/components/Switch\";\n\nexport default function () {\n    extend(SettingsPage.prototype, 'privacyItems', function (items) {\n        items.add('byobu-block-dm',\n            Switch.component({\n                children: app.translator.trans('fof-byobu.forum.user.settings.block_pd'),\n                state: this.user.preferences().blocksPd,\n                onchange: (value, component) => this.preferenceSaver('blocksPd')(value, component)\n            })\n        )\n    });\n}\n","import DiscussionList from 'flarum/components/DiscussionList';\n\nexport default class PrivateDiscussionList extends DiscussionList\n{\n}\n","import UserPage from 'flarum/components/UserPage';\nimport PrivateDiscussionList from './PrivateDiscussionList';\nimport Button from 'flarum/components/Button';\nimport LogInModal from 'flarum/components/LogInModal';\nimport PrivateDiscussionComposer from './PrivateDiscussionComposer';\n\nexport default class PrivateDiscussionsUserPage extends UserPage {\n    init() {\n        super.init();\n\n        this.loadUser(m.route.param('username'));\n    }\n\n    show(user) {\n        // We can not create the list in init because the user will not be available if it has to be loaded asynchronously\n        this.list = new PrivateDiscussionList({\n            params: {\n                q: `byobu:${user.username()} is:private`,\n                sort: 'newest'\n            }\n        });\n\n        this.list.refresh();\n\n        // We call the parent method after creating the list, this way the this.list property\n        // is set before content() is called for the first time\n        super.show(user);\n    }\n\n    newDiscussionAction(e) {\n        e.preventDefault();\n\n        const deferred = m.deferred();\n\n        if (app.session.user) {\n            const component = new PrivateDiscussionComposer({ user: app.session.user });\n\n            app.composer.load(component);\n            app.composer.show();\n\n            deferred.resolve(component);\n        } else {\n            deferred.reject();\n\n            app.modal.show(new LogInModal());\n        }\n\n        return deferred.promise;\n    }\n\n    content() {\n        const canStartDiscussion = app.forum.attribute('canStartDiscussion') || !app.session.user;\n\n        return (\n            <div className=\"DiscussionsUserPage\">\n                {Button.component({\n                    children: app.translator.trans(canStartDiscussion ? 'core.forum.index.start_discussion_button' : 'core.forum.index.cannot_start_discussion_button'),\n                    // icon: 'fas fa-edit',\n                    className: 'Button Button--primary IndexPage-newDiscussion',\n                    itemClassName: 'App-primaryControl',\n                    onclick: this.newDiscussionAction.bind(this),\n                    disabled: !canStartDiscussion,\n                    style: {marginBottom: '24px'}\n                })}\n                {this.list.render()}\n            </div>\n        );\n    }\n}\n","import {extend} from 'flarum/extend';\nimport UserPage from 'flarum/components/UserPage';\nimport LinkButton from 'flarum/components/LinkButton';\n\nimport PrivateDiscussionsUserPage from \"./components/PrivateDiscussionsUserPage\";\n\nexport default function () {\n    if (!Number(app.data['fof-byobu.enable_byobu_user_page'])) return;\n\n    app.routes['user.byobu'] = {path: '/u/:username/byobu', component: PrivateDiscussionsUserPage.component()};\n\n    extend(UserPage.prototype, 'navItems', function (items) {\n        const href = app.route('user.byobu', {username: this.user.username()});\n\n        // Hide links from guests if they are not already on the page\n        if (!app.session.user && m.route() !== href) return;\n\n        items.add('byobu',\n            LinkButton.component({\n                href,\n                children: app.translator.trans('fof-byobu.forum.user.byobu_link'),\n                icon: 'fas fa-map'\n            }),\n            85\n        );\n    })\n}\n","import { extend } from 'flarum/extend';\nimport LinkButton from 'flarum/components/LinkButton';\nimport SessionDropdown from 'flarum/components/SessionDropdown'\n\nexport default () => {\n    extend(SessionDropdown.prototype, 'items', items => {\n        const user = app.session.user;\n\n        items.add('privateDiscussions',\n            LinkButton.component({\n                icon: 'fas fa-map',\n                children: app.translator.trans('fof-byobu.forum.user.byobu_link'),\n                href: app.route('user.byobu', { username: user.username() }),\n            }),\n            99\n        );\n    })\n};","import { extend, override } from \"flarum/extend\";\nimport PrivateDiscussionComposer from \"./components/PrivateDiscussionComposer\";\n\nexport default function () {\n    PrivateDiscussionComposer.prototype.tags = [];\n\n    extend(PrivateDiscussionComposer.prototype, 'headerItems', function (items) {\n        items.remove('tags');\n    });\n\n    override(PrivateDiscussionComposer.prototype, 'onsubmit', function (original) {\n        const tag = app.store.getBy('tags', 'slug', 'general-discussion');\n\n        this.tags = [tag];\n\n        original();\n    });\n\n    extend(PrivateDiscussionComposer.prototype, 'data', function (data) {\n        data.relationships = data.relationships || {};\n        data.relationships.tags = this.tags;\n    });\n}\n","import Notification from 'flarum/components/Notification';\n\nexport default class PrivateDiscussionNotification extends Notification {\n  icon() {\n    return 'fas fa-map';\n  }\n\n  href() {\n    const notification = this.props.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    const user = this.props.notification.fromUser();\n    return app.translator.trans('fof-byobu.forum.notifications.pd_text', {\n      username: user.data.attributes.username,\n    });\n  }\n}","import { extend } from 'flarum/extend';\nimport Page from 'flarum/components/Page';\nimport ItemList from 'flarum/utils/ItemList';\nimport listItems from 'flarum/helpers/listItems';\nimport icon from 'flarum/helpers/icon';\nimport PrivateDiscussionList from './PrivateDiscussionList';\nimport WelcomeHero from 'flarum/components/WelcomeHero';\nimport DiscussionComposer from 'flarum/components/DiscussionComposer';\nimport LogInModal from 'flarum/components/LogInModal';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\nimport Select from 'flarum/components/Select';\nimport Button from 'flarum/components/Button';\nimport LinkButton from 'flarum/components/LinkButton';\nimport SelectDropdown from 'flarum/components/SelectDropdown';\n\nexport default class PrivateDiscussionIndex extends Page\n{\n    init() {\n        super.init();\n\n        // If the user is returning from a discussion page, then take note of which\n        // discussion they have just visited. After the view is rendered, we will\n        // scroll down so that this discussion is in view.\n        if (app.previous instanceof DiscussionPage) {\n            this.lastDiscussion = app.previous.discussion;\n        }\n\n        // If the user is coming from the discussion list, then they have either\n        // just switched one of the parameters (filter, sort, search) or they\n        // probably want to refresh the results. We will clear the discussion list\n        // cache so that results are reloaded.\n        if (app.previous instanceof PrivateDiscussionIndex) {\n            app.cache.privateDiscussionList = null;\n        }\n\n        const params = this.params();\n\n        if (app.cache.privateDiscussionList) {\n            // Compare the requested parameters (sort, search query) to the ones that\n            // are currently present in the cached discussion list. If they differ, we\n            // will clear the cache and set up a new discussion list component with\n            // the new parameters.\n            Object.keys(params).some(key => {\n                if (app.cache.privateDiscussionList.props.params[key] !== params[key]) {\n                    app.cache.privateDiscussionList = null;\n                    return true;\n                }\n            });\n        }\n\n        if (!app.cache.privateDiscussionList) {\n            app.cache.privateDiscussionList = new PrivateDiscussionList({params});\n        }\n\n        app.history.push('private-index', icon('far fa-map'));\n\n        this.bodyClass = 'App--index';\n    }\n\n    onunload() {\n        // Save the scroll position so we can restore it when we return to the\n        // discussion list.\n        app.cache.scrollTop = $(window).scrollTop();\n    }\n\n    view() {\n        return (\n            <div className=\"IndexPage\">\n                {this.hero()}\n                <div className=\"container\">\n                    <nav className=\"IndexPage-nav sideNav\">\n                        <ul>{listItems(this.sidebarItems().toArray())}</ul>\n                    </nav>\n                    <div className=\"IndexPage-results sideNavOffset\">\n                        <div className=\"IndexPage-toolbar\">\n                            <ul className=\"IndexPage-toolbar-view\">{listItems(this.viewItems().toArray())}</ul>\n                            <ul className=\"IndexPage-toolbar-action\">{listItems(this.actionItems().toArray())}</ul>\n                        </div>\n                        {app.cache.discussionList.render()}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    config(isInitialized, context) {\n        super.config(...arguments);\n\n        if (isInitialized) return;\n\n        extend(context, 'onunload', () => $('#app').css('min-height', ''));\n\n        app.setTitle('');\n        app.setTitleCount(0);\n\n        // Work out the difference between the height of this hero and that of the\n        // previous hero. Maintain the same scroll position relative to the bottom\n        // of the hero so that the sidebar doesn't jump around.\n        const oldHeroHeight = app.cache.heroHeight;\n        const heroHeight = app.cache.heroHeight = this.$('.Hero').outerHeight();\n        const scrollTop = app.cache.scrollTop;\n\n        $('#app').css('min-height', $(window).height() + heroHeight);\n\n        // Scroll to the remembered position. We do this after a short delay so that\n        // it happens after the browser has done its own \"back button\" scrolling,\n        // which isn't right. https://github.com/flarum/core/issues/835\n        const scroll = () => $(window).scrollTop(scrollTop - oldHeroHeight + heroHeight);\n        scroll();\n        setTimeout(scroll, 1);\n\n        // If we've just returned from a discussion page, then the constructor will\n        // have set the `lastDiscussion` property. If this is the case, we want to\n        // scroll down to that discussion so that it's in view.\n        if (this.lastDiscussion) {\n            const $discussion = this.$(`.DiscussionListItem[data-id=\"${this.lastDiscussion.id()}\"]`);\n\n            if ($discussion.length) {\n                const indexTop = $('#header').outerHeight();\n                const indexBottom = $(window).height();\n                const discussionTop = $discussion.offset().top;\n                const discussionBottom = discussionTop + $discussion.outerHeight();\n\n                if (discussionTop < scrollTop + indexTop || discussionBottom > scrollTop + indexBottom) {\n                    $(window).scrollTop(discussionTop - indexTop);\n                }\n            }\n        }\n    }\n\n    /**\n     * Get the component to display as the hero.\n     *\n     * @return {MithrilComponent}\n     */\n    hero() {\n        return WelcomeHero.component();\n    }\n\n    /**\n     * Build an item list for the sidebar of the index page. By default this is a\n     * \"New Discussion\" button, and then a DropdownSelect component containing a\n     * list of navigation items.\n     *\n     * @return {ItemList}\n     */\n    sidebarItems() {\n        const items = new ItemList();\n        const canStartDiscussion = app.forum.attribute('canStartDiscussion') || !app.session.user;\n\n        items.add('newDiscussion',\n            Button.component({\n                children: app.translator.trans(canStartDiscussion ? 'core.forum.index.start_discussion_button' : 'core.forum.index.cannot_start_discussion_button'),\n                icon: 'fas fa-edit',\n                className: 'Button Button--primary IndexPage-newDiscussion',\n                itemClassName: 'App-primaryControl',\n                onclick: this.newDiscussion.bind(this),\n                disabled: !canStartDiscussion\n            })\n        );\n\n        items.add('nav',\n            SelectDropdown.component({\n                children: this.navItems(this).toArray(),\n                buttonClassName: 'Button',\n                className: 'App-titleControl'\n            })\n        );\n\n        return items;\n    }\n\n    /**\n     * Build an item list for the navigation in the sidebar of the index page. By\n     * default this is just the 'All Discussions' link.\n     *\n     * @return {ItemList}\n     */\n    navItems() {\n        const items = new ItemList();\n        const params = this.stickyParams();\n\n        items.add('allDiscussions',\n            LinkButton.component({\n                href: app.route('index', params),\n                children: app.translator.trans('core.forum.index.all_discussions_link'),\n                icon: 'far fa-comments'\n            }),\n            100\n        );\n\n        return items;\n    }\n\n    /**\n     * Build an item list for the part of the toolbar which is concerned with how\n     * the results are displayed. By default this is just a select box to change\n     * the way discussions are sorted.\n     *\n     * @return {ItemList}\n     */\n    viewItems() {\n        const items = new ItemList();\n        const sortMap = app.cache.discussionList.sortMap();\n\n        const sortOptions = {};\n        for (const i in sortMap) {\n            sortOptions[i] = app.translator.trans('core.forum.index_sort.' + i + '_button');\n        }\n\n        items.add('sort',\n            Select.component({\n                options: sortOptions,\n                value: this.params().sort || Object.keys(sortMap)[0],\n                onchange: this.changeSort.bind(this)\n            })\n        );\n\n        return items;\n    }\n\n    /**\n     * Build an item list for the part of the toolbar which is about taking action\n     * on the results. By default this is just a \"mark all as read\" button.\n     *\n     * @return {ItemList}\n     */\n    actionItems() {\n        const items = new ItemList();\n\n        items.add('refresh',\n            Button.component({\n                title: app.translator.trans('core.forum.index.refresh_tooltip'),\n                icon: 'fas fa-refresh',\n                className: 'Button Button--icon',\n                onclick: () => app.cache.discussionList.refresh()\n            })\n        );\n\n        if (app.session.user) {\n            items.add('markAllAsRead',\n                Button.component({\n                    title: app.translator.trans('core.forum.index.mark_all_as_read_tooltip'),\n                    icon: 'fas fa-check',\n                    className: 'Button Button--icon',\n                    onclick: this.markAllAsRead.bind(this)\n                })\n            );\n        }\n\n        return items;\n    }\n\n    /**\n     * Return the current search query, if any. This is implemented to activate\n     * the search box in the header.\n     *\n     * @see Search\n     * @return {String}\n     */\n    searching() {\n        return this.params().q;\n    }\n\n    /**\n     * Redirect to the index page without a search filter. This is called when the\n     * 'x' is clicked in the search box in the header.\n     *\n     * @see Search\n     */\n    clearSearch() {\n        const params = this.params();\n        delete params.q;\n\n        m.route(app.route(this.props.routeName, params));\n    }\n\n    /**\n     * Redirect to the index page using the given sort parameter.\n     *\n     * @param {String} sort\n     */\n    changeSort(sort) {\n        const params = this.params();\n\n        if (sort === Object.keys(app.cache.discussionList.sortMap())[0]) {\n            delete params.sort;\n        } else {\n            params.sort = sort;\n        }\n\n        m.route(app.route(this.props.routeName, params));\n    }\n\n    /**\n     * Get URL parameters that stick between filter changes.\n     *\n     * @return {Object}\n     */\n    stickyParams() {\n        return {\n            sort: m.route.param('sort'),\n            q: m.route.param('q')\n        };\n    }\n\n    /**\n     * Get parameters to pass to the DiscussionList component.\n     *\n     * @return {Object}\n     */\n    params() {\n        const params = this.stickyParams();\n\n        params.filter = m.route.param('filter');\n\n        return params;\n    }\n\n    /**\n     * Log the user in and then open the composer for a new discussion.\n     *\n     * @return {Promise}\n     */\n    newDiscussion() {\n        const deferred = m.deferred();\n\n        if (app.session.user) {\n            this.composeNewDiscussion(deferred);\n        } else {\n            app.modal.show(\n                new LogInModal({\n                    onlogin: this.composeNewDiscussion.bind(this, deferred)\n                })\n            );\n        }\n\n        return deferred.promise;\n    }\n\n    /**\n     * Initialize the composer for a new discussion.\n     *\n     * @param {Deferred} deferred\n     * @return {Promise}\n     */\n    composeNewDiscussion(deferred) {\n        const component = new DiscussionComposer({user: app.session.user});\n\n        app.composer.load(component);\n        app.composer.show();\n\n        deferred.resolve(component);\n\n        return deferred.promise;\n    }\n\n    /**\n     * Mark all discussions as read.\n     *\n     * @return void\n     */\n    markAllAsRead() {\n        const confirmation = confirm(app.translator.trans('core.forum.index.mark_all_as_read_confirmation'));\n\n        if (confirmation) {\n            app.session.user.save({readTime: new Date()});\n        }\n    }\n}\n","import EventPost from \"flarum/components/EventPost\";\nimport recipientsLabel from \"../../common/helpers/recipientsLabel\";\n\nexport default class RecipientsModified extends EventPost {\n    static initProps(props) {\n        super.initProps(props);\n\n        function diff(diff1, diff2, store) {\n            return diff1\n                .filter(item => diff2.indexOf(item) === -1)\n                .map(id => app.store.getById(store, id));\n        }\n\n        const content = props.post.content();\n\n        // For event posts existing before groups functionality.\n        if (!content['new'] && content.length == 2) {\n            const oldRecipients = props.post.content()[0];\n            const newRecipients = props.post.content()[1];\n            props.added = diff(newRecipients, oldRecipients, 'users');\n            props.removed = diff(oldRecipients, newRecipients, 'users');\n        } else {\n            var usersAdded = diff(content['new']['users'], content['old']['users'], 'users');\n            var usersRemoved = diff(content['old']['users'], content['new']['users'], 'users');\n            var groupsAdded = diff(content['new']['groups'], content['old']['groups'], 'groups');\n            var groupsRemoved = diff(content['old']['groups'], content['new']['groups'], 'groups');\n\n            props.added = usersAdded.concat(groupsAdded);\n            props.removed = usersRemoved.concat(groupsRemoved);\n        }\n    }\n\n    icon() {\n        return 'far fa-map';\n    }\n\n    descriptionKey() {\n\n        var localeBase = 'fof-byobu.forum.post.recipients_modified.';\n\n        if (this.props.added.length) {\n            if (this.props.removed.length) {\n                return localeBase + 'added_and_removed';\n            }\n\n            return localeBase + 'added';\n        }\n\n        return localeBase + 'removed';\n    }\n\n    descriptionData() {\n        const data = {};\n\n        if (this.props.added.length) {\n            data.added = recipientsLabel(this.props.added, {link: true});\n        }\n\n        if (this.props.removed.length) {\n            data.removed = recipientsLabel(this.props.removed, {link: true});\n        }\n\n        return data;\n    }\n}\n","import { extend } from 'flarum/extend';\nimport Model from \"flarum/Model\";\nimport Discussion from \"flarum/models/Discussion\";\nimport User from \"flarum/models/User\";\nimport addRecipientComposer from \"./addRecipientComposer\";\nimport addRecipientLabels from \"./addRecipientLabels\";\nimport addRecipientsControl from \"./addRecipientsControl\";\nimport addHasRecipientsBadge from \"./addHasRecipientsBadge\";\nimport addDiscussPrivatelyControl from './addDiscussPrivatelyControl';\nimport addPrivacySetting from './addPrivacySetting';\nimport addPrivateDiscussionsPage from \"./addPrivateDiscussionsPage\";\nimport addPrivateMessageSessionDropdownLinkButton from './addPrivateMessageSessionDropdownLinkButton';\nimport removeTagComposer from './removeTagComposer';\nimport NotificationGrid from 'flarum/components/NotificationGrid';\nimport PrivateDiscussionNotification from './components/PrivateDiscussionNotification';\n\nimport PrivateDiscussionIndex from \"./components/PrivateDiscussionIndex\";\nimport RecipientsModified from \"./components/RecipientsModified\";\n\napp.initializers.add('fof-byobu', function (app) {\n    app.routes.private_discussions = { path: '/private-discussions', component: PrivateDiscussionIndex.component() };\n\n    Discussion.prototype.recipientUsers = Model.hasMany('recipientUsers');\n    Discussion.prototype.oldRecipientUsers = Model.hasMany('oldRecipientUsers');\n    Discussion.prototype.recipientGroups = Model.hasMany('recipientGroups');\n    Discussion.prototype.oldRecipientGroups = Model.hasMany('oldRecipientGroups');\n\n    Discussion.prototype.canEditRecipients = Model.attribute('canEditRecipients');\n    Discussion.prototype.canEditUserRecipients = Model.attribute('canEditUserRecipients');\n    Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n    Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n\n    User.prototype.blocksPd = Model.attribute('blocksPd');\n    User.prototype.cannotBeDirectMessaged = Model.attribute('cannotBeDirectMessaged');\n\n    app.postComponents.recipientsModified = RecipientsModified;\n\n    addRecipientComposer(app);\n    addRecipientLabels();\n    addRecipientsControl();\n    addHasRecipientsBadge();\n    addPrivacySetting();\n    addPrivateMessageSessionDropdownLinkButton();\n\n    addDiscussPrivatelyControl();\n\n    addPrivateDiscussionsPage();\n\n    removeTagComposer();\n\n    app.notificationComponents.byobuPrivateDiscussionCreated = PrivateDiscussionNotification;\n\n    // Add notification preferences.\n    extend(NotificationGrid.prototype, 'notificationTypes', function (items) {\n        items.add('byobuPrivateDiscussionCreated', {\n            name: 'byobuPrivateDiscussionCreated',\n            icon: 'fas fa-map',\n            label: app.translator.trans('fof-byobu.forum.notifications.pd_label')\n        });\n    });\n});\n","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Search'];","module.exports = flarum.core.compat['helpers/avatar'];","module.exports = flarum.core.compat['utils/extractText'];","module.exports = flarum.core.compat['components/LoadingIndicator'];","module.exports = flarum.core.compat['components/DiscussionListItem'];","module.exports = flarum.core.compat['components/DiscussionHero'];","module.exports = flarum.core.compat['utils/DiscussionControls'];","module.exports = flarum.core.compat['components/Badge'];","module.exports = flarum.core.compat['utils/UserControls'];","module.exports = flarum.core.compat['components/SettingsPage'];","module.exports = flarum.core.compat['components/SessionDropdown'];","module.exports = flarum.core.compat['components/NotificationGrid'];","module.exports = flarum.core.compat['components/Notification'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['components/WelcomeHero'];","module.exports = flarum.core.compat['components/SelectDropdown'];","module.exports = flarum.core.compat['components/EventPost'];"],"sourceRoot":""}
=======
{"version":3,"sources":["webpack://@fof/byobu/webpack/bootstrap","webpack://@fof/byobu/./forum.js","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/byobu/./src/common/helpers/recipientCountLabel.js","webpack://@fof/byobu/./src/common/helpers/recipientLabel.js","webpack://@fof/byobu/./src/common/helpers/recipientsLabel.js","webpack://@fof/byobu/./src/forum/addDiscussPrivatelyControl.js","webpack://@fof/byobu/./src/forum/addHasRecipientsBadge.js","webpack://@fof/byobu/./src/forum/addPrivacySetting.js","webpack://@fof/byobu/./src/forum/addPrivateDiscussionsPage.js","webpack://@fof/byobu/./src/forum/addPrivateMessageSessionDropdownLinkButton.js","webpack://@fof/byobu/./src/forum/addRecipientComposer.js","webpack://@fof/byobu/./src/forum/addRecipientLabels.js","webpack://@fof/byobu/./src/forum/addRecipientsControl.js","webpack://@fof/byobu/./src/forum/components/AddRecipientModal.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionComposer.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionIndex.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionList.js","webpack://@fof/byobu/./src/forum/components/PrivateDiscussionsUserPage.js","webpack://@fof/byobu/./src/forum/components/RecipientSearch.js","webpack://@fof/byobu/./src/forum/components/RecipientsModified.js","webpack://@fof/byobu/./src/forum/components/sources/GroupSearchSource.js","webpack://@fof/byobu/./src/forum/components/sources/UserSearchSource.js","webpack://@fof/byobu/./src/forum/index.js","webpack://@fof/byobu/./src/forum/removeTagComposer.js","webpack://@fof/byobu/external \"flarum.core.compat['Model']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Badge']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Button']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionComposer']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionHero']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionList']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionListItem']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/DiscussionPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/EventPost']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LinkButton']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LoadingIndicator']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/LogInModal']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Modal']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Page']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Search']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Select']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/SelectDropdown']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/SessionDropdown']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/SettingsPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/Switch']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/UserPage']\"","webpack://@fof/byobu/external \"flarum.core.compat['components/WelcomeHero']\"","webpack://@fof/byobu/external \"flarum.core.compat['extend']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/avatar']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/highlight']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/icon']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/listItems']\"","webpack://@fof/byobu/external \"flarum.core.compat['helpers/username']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/Discussion']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/Group']\"","webpack://@fof/byobu/external \"flarum.core.compat['models/User']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/DiscussionControls']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/ItemList']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/UserControls']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/classList']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/extract']\"","webpack://@fof/byobu/external \"flarum.core.compat['utils/extractText']\""],"names":["recipientCountLabel","count","attrs","style","className","label","app","translator","transChoice","m","recipientLabel","recipient","link","title","username","href","route","user","config","namePlural","trans","recipientsLabel","recipients","children","forEach","push","extend","items","session","id","forum","attribute","blocksPd","cannotBeDirectMessaged","add","component","icon","onclick","deferred","DiscussionComposer","prototype","recipientUsers","composer","load","show","resolve","promise","addHasRecipientsBadge","badges","length","recipientGroups","type","state","preferences","onchange","value","preferenceSaver","Number","data","routes","path","PrivateDiscussionComposer","addDefaultRecipients","store","getBy","override","original","param","chooseRecipients","modal","selectedRecipients","onsubmit","$","focus","toArray","bind","users","groups","relationships","addToDiscussion","discussion","long","concat","props","params","include","canEditRecipients","AddRecipientModal","init","selected","prop","assignInitialRecipients","merge","recipientSearch","map","group","content","isDisabled","disabled","select","e","metaKey","ctrlKey","indexOf","index","submit","preventDefault","save","then","current","stream","update","redraw","close","strategy","PrivateDiscussionIndex","previous","lastDiscussion","cache","privateDiscussionList","Object","keys","some","key","history","bodyClass","onunload","scrollTop","window","view","hero","sidebarItems","viewItems","actionItems","discussionList","render","isInitialized","context","arguments","css","setTitle","setTitleCount","oldHeroHeight","heroHeight","outerHeight","height","scroll","setTimeout","$discussion","indexTop","indexBottom","discussionTop","offset","top","discussionBottom","canStartDiscussion","itemClassName","newDiscussion","navItems","buttonClassName","stickyParams","sortMap","sortOptions","i","options","sort","changeSort","refresh","markAllAsRead","searching","q","clearSearch","routeName","filter","composeNewDiscussion","onlogin","confirmation","confirm","readTime","Date","PrivateDiscussionList","PrivateDiscussionsUserPage","loadUser","list","newDiscussionAction","reject","marginBottom","RecipientSearch","$search","on","target","addRecipient","parentNode","clearTimeout","typingTimer","doSearch","loading","sources","sourceItems","removeRecipient","open","focused","active","loadingSources","element","placeholder","oninput","withAttr","onfocus","hasFocus","onblur","size","source","canEditUserRecipients","canEditGroupRecipients","clear","values","split","findRecipient","remove","getById","RecipientsModified","initProps","diff","diff1","diff2","item","post","oldRecipients","newRecipients","added","removed","usersAdded","usersRemoved","groupsAdded","groupsRemoved","descriptionKey","localeBase","descriptionData","GroupSearchSource","search","query","find","page","limit","toLowerCase","results","all","substr","groupName","name","UserSearchSource","byobuResults","pushResults","payload","result","initializers","private_discussions","Discussion","hasMany","oldRecipientUsers","oldRecipientGroups","User","postComponents","recipientsModified","addRecipientComposer","addRecipientLabels","addRecipientsControl","addPrivacySetting","addPrivateMessageSessionDropdownLinkButton","addDiscussPrivatelyControl","addPrivateDiscussionsPage","removeTagComposer","tags","tag"],"mappings":"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zB,SAA3B,EAAsC,UAAtC,EAAkD,UAAU0B,QAAV,EAAoB;AAC1E,QAAMgN,GAAG,GAAG5Q,GAAG,CAACyD,KAAJ,CAAUC,KAAV,CAAgB,MAAhB,EAAwB,MAAxB,EAAgC,oBAAhC,CAAZ;AAEA,SAAKiN,IAAL,GAAY,CAACC,GAAD,CAAZ;AAEAhN,YAAQ;AACX,GANO,CAAR;AAQAxC,EAAA,4DAAM,CAAC,6EAAyB,CAACc,SAA3B,EAAsC,MAAtC,EAA8C,UAAUkB,IAAV,EAAgB;AAChEA,QAAI,CAACoB,aAAL,GAAqBpB,IAAI,CAACoB,aAAL,IAAsB,EAA3C;AACApB,QAAI,CAACoB,aAAL,CAAmBmM,IAAnB,GAA0B,KAAKA,IAA/B;AACH,GAHK,CAAN;AAIH,C;;;;;;;;;;;ACtBD,6C;;;;;;;;;;;ACAA,wD;;;;;;;;;;;ACAA,yD;;;;;;;;;;;ACAA,qE;;;;;;;;;;;ACAA,iE;;;;;;;;;;;ACAA,iE;;;;;;;;;;;ACAA,qE;;;;;;;;;;;ACAA,iE;;;;;;;;;;;ACAA,4D;;;;;;;;;;;ACAA,6D;;;;;;;;;;;ACAA,mE;;;;;;;;;;;ACAA,6D;;;;;;;;;;;ACAA,wD;;;;;;;;;;;ACAA,uD;;;;;;;;;;;ACAA,yD;;;;;;;;;;;ACAA,yD;;;;;;;;;;;ACAA,iE;;;;;;;;;;;ACAA,kE;;;;;;;;;;;ACAA,+D;;;;;;;;;;;ACAA,yD;;;;;;;;;;;ACAA,2D;;;;;;;;;;;ACAA,8D;;;;;;;;;;;ACAA,8C;;;;;;;;;;;ACAA,sD;;;;;;;;;;;ACAA,yD;;;;;;;;;;;ACAA,oD;;;;;;;;;;;ACAA,yD;;;;;;;;;;;ACAA,wD;;;;;;;;;;;ACAA,yD;;;;;;;;;;;ACAA,oD;;;;;;;;;;;ACAA,mD;;;;;;;;;;;ACAA,gE;;;;;;;;;;;ACAA,sD;;;;;;;;;;;ACAA,0D;;;;;;;;;;;ACAA,uD;;;;;;;;;;;ACAA,qD;;;;;;;;;;;ACAA,yD","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/common';\nexport * from './src/forum';","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","export default function recipientCountLabel(count, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'RecipientLabel ' + (attrs.className || '');\n\n  var label = app.translator.transChoice('fof-byobu.forum.labels.recipients', count, {count});\n\n  return (\n    m('span', attrs,\n        <span className=\"RecipientLabel-text\">\n            {label}\n        </span>\n    )\n  );\n}\n","import extract from 'flarum/utils/extract';\nimport username from 'flarum/helpers/username';\nimport User from 'flarum/models/User';\nimport Group from 'flarum/models/Group';\n\nexport default function recipientLabel(recipient, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'RecipientLabel ' + (attrs.className || '');\n\n  const link = extract(attrs, 'link');\n\n  var label;\n\n  if (recipient instanceof User) {\n      label = username(recipient);\n\n      if (link) {\n          attrs.title = recipient.username() || '';\n          attrs.href = app.route.user(recipient);\n          attrs.config = m.route;\n      }\n  } else if (recipient instanceof Group) {\n      label = recipient.namePlural();\n  } else {\n      attrs.className += ' none';\n      label = app.translator.trans('fof-byobu.forum.labels.user_deleted');\n  }\n\n  return (\n    m((link ? 'a' : 'span'), attrs,\n        <span className=\"RecipientLabel-text\">\n            {label}\n        </span>\n    )\n  );\n}\n","import extract from 'flarum/utils/extract';\nimport recipientLabel from './recipientLabel';\n\nexport default function recipientsLabel(recipients, attrs = {}) {\n  const children = [];\n  const link = extract(attrs, 'link');\n\n  attrs.className = 'RecipientsLabel ' + (attrs.className || '');\n\n  if (recipients) {\n      recipients.forEach(recipient => {\n          children.push(recipientLabel(recipient, {link}));\n      });\n  } else {\n    children.push(recipientLabel());\n  }\n\n  return <span {...attrs}>{children}</span>;\n}\n","import {extend} from 'flarum/extend';\nimport UserControls from 'flarum/utils/UserControls';\nimport DiscussionComposer from \"flarum/components/DiscussionComposer\";\nimport Button from 'flarum/components/Button';\nimport ItemList from 'flarum/utils/ItemList';\n\nexport default function () {\n    // Add a control allowing the discussion to be moved to another category.\n    extend(UserControls, 'userControls', function (items, user) {\n        if (app.session.user &&\n            app.session.user.id() !== user.id() &&\n            app.forum.attribute('canStartPrivateDiscussion') &&\n            ((user.blocksPd() === false || app.forum.attribute('canStartPrivateDiscussionWithBlockers')) && !user.cannotBeDirectMessaged())\n        ) {\n            items.add('private-discussion', Button.component({\n                children: app.translator.trans('fof-byobu.forum.buttons.send_pd', {username: user.username()}),\n                icon: 'far fa-map',\n                onclick: () => {\n                    const deferred = m.deferred();\n\n                    let recipients = new ItemList();\n                    recipients.add('users:' + user.id(), user);\n                    recipients.add('users:' + app.session.user.id(), app.session.user);\n\n                    DiscussionComposer.prototype.recipients = recipients;\n\n                    const component = new DiscussionComposer({\n                        user: app.session.user,\n                        recipients: recipients,\n                        recipientUsers: recipients\n                    });\n\n                    app.composer.load(component);\n                    app.composer.show();\n\n                    deferred.resolve(component);\n\n                    return deferred.promise;\n                }\n            }));\n        }\n\n        return items;\n    });\n}\n","import {extend} from \"flarum/extend\";\nimport Discussion from \"flarum/models/Discussion\";\nimport Badge from \"flarum/components/Badge\";\n\nexport default function addHasRecipientsBadge() {\n    extend(Discussion.prototype, 'badges', function (badges) {\n        if (this.recipientUsers().length || this.recipientGroups().length) {\n            badges.add('private', Badge.component({\n                type: 'private',\n                label: app.translator.trans('fof-byobu.forum.badges.is_private.tooltip'),\n                icon: 'fas fa-map'\n            }), 10);\n        }\n    });\n}\n","import {extend} from 'flarum/extend';\nimport SettingsPage from 'flarum/components/SettingsPage';\nimport Switch from \"flarum/components/Switch\";\n\nexport default function () {\n    extend(SettingsPage.prototype, 'privacyItems', function (items) {\n        items.add('byobu-block-dm',\n            Switch.component({\n                children: app.translator.trans('fof-byobu.forum.user.settings.block_pd'),\n                state: this.user.preferences().blocksPd,\n                onchange: (value, component) => this.preferenceSaver('blocksPd')(value, component)\n            })\n        )\n    });\n}\n","import {extend} from 'flarum/extend';\nimport UserPage from 'flarum/components/UserPage';\nimport LinkButton from 'flarum/components/LinkButton';\n\nimport PrivateDiscussionsUserPage from \"./components/PrivateDiscussionsUserPage\";\n\nexport default function () {\n    if (!Number(app.data['fof-byobu.enable_byobu_user_page'])) return;\n\n    app.routes['user.byobu'] = {path: '/u/:username/byobu', component: PrivateDiscussionsUserPage.component()};\n\n    extend(UserPage.prototype, 'navItems', function (items) {\n        const href = app.route('user.byobu', {username: this.user.username()});\n\n        // Hide links from guests if they are not already on the page\n        if (!app.session.user && m.route() !== href) return;\n\n        items.add('byobu',\n            LinkButton.component({\n                href,\n                children: app.translator.trans('fof-byobu.forum.user.byobu_link'),\n                icon: 'fas fa-map'\n            }),\n            85\n        );\n    })\n}\n","import { extend } from 'flarum/extend';\nimport LinkButton from 'flarum/components/LinkButton';\nimport SessionDropdown from 'flarum/components/SessionDropdown'\n\nexport default () => {\n    extend(SessionDropdown.prototype, 'items', items => {\n        const user = app.session.user;\n\n        items.add('privateDiscussions',\n            LinkButton.component({\n                icon: 'fas fa-map',\n                children: app.translator.trans('fof-byobu.forum.user.byobu_link'),\n                href: app.route('user.byobu', { username: user.username() }),\n            }),\n            99\n        );\n    })\n};","import { extend, override } from \"flarum/extend\";\nimport PrivateDiscussionComposer from \"./components/PrivateDiscussionComposer\";\nimport AddRecipientModal from \"./components/AddRecipientModal\";\nimport recipientCountLabel from \"../common/helpers/recipientCountLabel\";\nimport User from \"flarum/models/User\";\nimport Group from \"flarum/models/Group\";\nimport ItemList from \"flarum/utils/ItemList\";\n\nexport default function (app) {\n    // Add recipient-selection abilities to the discussion composer.\n    PrivateDiscussionComposer.prototype.recipients = new ItemList;\n    PrivateDiscussionComposer.prototype.recipientUsers = [];\n    PrivateDiscussionComposer.prototype.recipientGroups = [];\n\n    PrivateDiscussionComposer.prototype.addDefaultRecipients = function (username) {\n        const user = app.store.getBy('users', 'username', username);\n\n        this.recipients.add('users:' + app.session.user.id(), app.session.user);\n        if(user.id() !== app.session.user.id()) {\n            this.recipients.add('users:' + user.id(), user);\n        }\n    };\n\n    override(PrivateDiscussionComposer.prototype, 'init', function(original) {\n        original();\n\n        this.addDefaultRecipients(m.route.param('username'));\n    });\n\n\n    // Add a recipient selection modal when clicking the recipient tag label.\n    PrivateDiscussionComposer.prototype.chooseRecipients = function () {\n        app.modal.show(\n            new AddRecipientModal({\n                selectedRecipients: this.recipients,\n                onsubmit: (recipients) => {\n                    this.recipients = recipients;\n\n                    // Focus on recipient autocomplete field.\n                    this.$('.RecipientsInput').focus();\n                }\n            })\n        )\n    };\n\n    // Add a tag-selection menu to the discussion composer's header, after the\n    // title.\n    extend(PrivateDiscussionComposer.prototype, 'headerItems', function (items) {\n        if (app.session.user && app.forum.attribute('canStartPrivateDiscussion')) {\n            const recipients = this.recipients.toArray();\n\n            items.add('recipients', (\n                <a className=\"PrivateDiscussionComposer-changeRecipients\"\n                    onclick={this.chooseRecipients.bind(this)}>\n                    {recipients.length\n                        ? recipientCountLabel(recipients.length)\n                        : <span className=\"RecipientLabel none\">{app.translator.trans('fof-byobu.forum.buttons.add_recipients')}</span>}\n                </a>\n            ), 5);\n        }\n    });\n\n    override(PrivateDiscussionComposer.prototype, 'onsubmit', function (original) {\n        const recipients = this.recipients.toArray();\n        if (recipients.length < 2) {\n            app.modal.show(\n                new AddRecipientModal({\n                    selectedRecipients: this.recipients,\n                    onsubmit: (recipients) => {\n                        this.recipients = recipients;\n                        //todo: make this better?\n                        original();\n                    }\n                })\n            )\n        } else {\n            original();\n        }\n    });\n\n    // Add the selected tags as data to submit to the server.\n    extend(PrivateDiscussionComposer.prototype, 'data', function (data) {\n        const users = [];\n        const groups = [];\n        this.recipients.toArray().forEach(recipient => {\n\n            if (recipient instanceof User) {\n                users.push(recipient);\n            }\n\n            if (recipient instanceof Group) {\n                groups.push(recipient);\n            }\n        });\n\n        data.relationships = data.relationships || {};\n\n        if (users.length) {\n            data.relationships.recipientUsers = users;\n        }\n\n        if (groups.length) {\n            data.relationships.recipientGroups = groups;\n        }\n    });\n}\n","import {extend} from \"flarum/extend\";\nimport DiscussionListItem from \"flarum/components/DiscussionListItem\";\nimport DiscussionPage from \"flarum/components/DiscussionPage\";\nimport DiscussionHero from \"flarum/components/DiscussionHero\";\nimport DiscussionList from \"flarum/components/DiscussionList\";\nimport recipientsLabel from \"../common/helpers/recipientsLabel\";\n\nexport default function() {\n\n    const addToDiscussion = function(discussion, items, long) {\n        let recipients = [];\n\n        if (discussion.recipientUsers().length) {\n            recipients = recipients.concat(discussion.recipientUsers());\n        }\n\n        if (discussion.recipientGroups().length) {\n            recipients = recipients.concat(discussion.recipientGroups());\n        }\n\n        if (recipients && recipients.length) {\n            if (long) {\n                items.add('recipients', recipientsLabel(recipients), 10);\n            } else {\n                items.add('recipients', recipientsLabel(recipients, {link: true}), 4);\n            }\n        }\n    };\n\n    /**\n     * Adds User labels on the discussion index page.\n     */\n    extend(DiscussionListItem.prototype, 'infoItems', function(items) {\n        const discussion = this.props.discussion;\n\n        addToDiscussion(discussion, items, true);\n    });\n\n    /**\n     * Require recipients from the API whenever we're loading a Discussion page.\n     */\n    extend(DiscussionPage.prototype, 'params', function(params) {\n        params.include.push('recipientUsers');\n        params.include.push('recipientGroups');\n    });\n    extend(DiscussionList.prototype, 'requestParams', function(params) {\n        params.include.push('recipientUsers');\n        params.include.push('recipientGroups');\n    });\n\n\n    /**\n     * Adds User labels on the discussion Hero.\n     */\n    extend(DiscussionHero.prototype, 'items', function(items) {\n        const discussion = this.props.discussion;\n\n        addToDiscussion(discussion, items, false);\n    });\n}\n","import { extend } from 'flarum/extend';\nimport DiscussionControls from 'flarum/utils/DiscussionControls';\nimport Button from 'flarum/components/Button';\n\nimport AddRecipientModal from './components/AddRecipientModal';\n\nexport default function() {\n    // Add a control allowing the discussion to be moved to another category.\n    extend(DiscussionControls, 'moderationControls', function(items, discussion) {\n        if (discussion.canEditRecipients()) {\n            items.add('recipients', Button.component({\n                children: app.translator.trans('fof-byobu.forum.buttons.edit_recipients'),\n                icon: 'far fa-map',\n                onclick: () => app.modal.show(new AddRecipientModal({discussion}))\n            }));\n        }\n    });\n}\n","import Modal from \"flarum/components/Modal\";\nimport DiscussionPage from \"flarum/components/DiscussionPage\";\nimport Button from \"flarum/components/Button\";\nimport ItemList from \"flarum/utils/ItemList\";\nimport RecipientSearch from \"./RecipientSearch\";\nimport User from \"flarum/models/User\";\nimport Group from \"flarum/models/Group\";\n\nexport default class AddRecipientModal extends Modal {\n    init() {\n        super.init();\n\n        this.selected = m.prop(new ItemList);\n\n        if (this.props.discussion) {\n            // Adds recipients of the currently viewed discussion.\n            this.assignInitialRecipients(this.props.discussion);\n        } else if (this.props.selectedRecipients.toArray().length > 0) {\n            // Adds previously selected recipients.\n            this.selected().merge(this.props.selectedRecipients);\n        } else {\n            // Adds the current user in case there are no selected recipients yet and this is a new discussion.\n            this.selected().add(\"users:\" + app.session.user.id(), app.session.user);\n        }\n\n        this.recipientSearch = RecipientSearch.component({\n            selected: this.selected,\n            discussion: this.props.discussion\n        });\n    }\n\n    // todo: Add cancel button to replace modal X\n    // isDismissible() {\n    //     return false;\n    // }\n\n    assignInitialRecipients(discussion) {\n        discussion.recipientUsers().map(user => {\n            this.selected().add(\"users:\" + user.id(), user);\n        });\n        discussion.recipientGroups().map(group => {\n            this.selected().add(\"groups:\" + group.id(), group);\n        });\n    }\n\n    className() {\n        return 'AddRecipientModal';\n    }\n\n    title() {\n        return this.props.discussion\n            ? app.translator.trans('fof-byobu.forum.modal.titles.update_recipients', { title: <em>{this.props.discussion.title()}</em> })\n            : app.translator.trans('fof-byobu.forum.modal.titles.add_recipients');\n    }\n\n    content() {\n        const isDisabled = this.selected().toArray().length < 2;\n\n        return [\n            <div className=\"Modal-body\">\n                <div className=\"AddRecipientModal-form\">\n                    {this.recipientSearch}\n                    <div className=\"AddRecipientModal-form-submit App-primaryControl\">\n                        {Button.component({\n                            type: 'submit',\n                            className: 'Button Button--primary',\n                            disabled: isDisabled,\n                            icon: 'fas fa-check',\n                            children: app.translator.trans('fof-byobu.forum.buttons.submit')\n                        })}\n                        {/* {Button.component({\n                            onclick: this.hide.bind(this),\n                            className: 'Button Button--primary',\n                            children: app.translator.trans('fof-byobu.forum.buttons.cancel')\n                        })} */}\n                    </div>\n                </div>\n            </div>\n        ];\n    }\n\n    select(e) {\n        // Ctrl + Enter submits the selection, just Enter completes the current entry\n        if (e.metaKey || e.ctrlKey || this.selected.indexOf(this.index) !== -1) {\n            if (this.selected().length) {\n                this.$('form').submit();\n            }\n        }\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        const discussion = this.props.discussion;\n        const recipients = this.selected();\n\n        let recipientGroups = [];\n        let recipientUsers = [];\n\n        recipients.toArray().forEach(recipient => {\n            if (recipient instanceof User) {\n                recipientUsers.push(recipient);\n            }\n            if (recipient instanceof Group) {\n                recipientGroups.push(recipient);\n            }\n        });\n\n        // Recipients are updated here for existing discussions here.\n        if (discussion) {\n            discussion.save({ relationships: { recipientUsers, recipientGroups } })\n                .then(() => {\n                    if (app.current instanceof DiscussionPage) {\n                        app.current.stream.update();\n                    }\n                    m.redraw();\n                });\n        }\n\n        // Use the onsubmit callback to trigger an update in the DiscussionComposer\n        if (this.props.onsubmit) this.props.onsubmit(recipients);\n\n        app.modal.close();\n\n        m.redraw.strategy('none');\n    }\n}\n","\nimport DiscussionComposer from \"flarum/components/DiscussionComposer\";\n\nexport default class PrivateDiscussionComposer extends DiscussionComposer {\n\n}","import { extend } from 'flarum/extend';\nimport Page from 'flarum/components/Page';\nimport ItemList from 'flarum/utils/ItemList';\nimport listItems from 'flarum/helpers/listItems';\nimport icon from 'flarum/helpers/icon';\nimport PrivateDiscussionList from './PrivateDiscussionList';\nimport WelcomeHero from 'flarum/components/WelcomeHero';\nimport DiscussionComposer from 'flarum/components/DiscussionComposer';\nimport LogInModal from 'flarum/components/LogInModal';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\nimport Select from 'flarum/components/Select';\nimport Button from 'flarum/components/Button';\nimport LinkButton from 'flarum/components/LinkButton';\nimport SelectDropdown from 'flarum/components/SelectDropdown';\n\nexport default class PrivateDiscussionIndex extends Page\n{\n    init() {\n        super.init();\n\n        // If the user is returning from a discussion page, then take note of which\n        // discussion they have just visited. After the view is rendered, we will\n        // scroll down so that this discussion is in view.\n        if (app.previous instanceof DiscussionPage) {\n            this.lastDiscussion = app.previous.discussion;\n        }\n\n        // If the user is coming from the discussion list, then they have either\n        // just switched one of the parameters (filter, sort, search) or they\n        // probably want to refresh the results. We will clear the discussion list\n        // cache so that results are reloaded.\n        if (app.previous instanceof PrivateDiscussionIndex) {\n            app.cache.privateDiscussionList = null;\n        }\n\n        const params = this.params();\n\n        if (app.cache.privateDiscussionList) {\n            // Compare the requested parameters (sort, search query) to the ones that\n            // are currently present in the cached discussion list. If they differ, we\n            // will clear the cache and set up a new discussion list component with\n            // the new parameters.\n            Object.keys(params).some(key => {\n                if (app.cache.privateDiscussionList.props.params[key] !== params[key]) {\n                    app.cache.privateDiscussionList = null;\n                    return true;\n                }\n            });\n        }\n\n        if (!app.cache.privateDiscussionList) {\n            app.cache.privateDiscussionList = new PrivateDiscussionList({params});\n        }\n\n        app.history.push('private-index', icon('far fa-map'));\n\n        this.bodyClass = 'App--index';\n    }\n\n    onunload() {\n        // Save the scroll position so we can restore it when we return to the\n        // discussion list.\n        app.cache.scrollTop = $(window).scrollTop();\n    }\n\n    view() {\n        return (\n            <div className=\"IndexPage\">\n                {this.hero()}\n                <div className=\"container\">\n                    <nav className=\"IndexPage-nav sideNav\">\n                        <ul>{listItems(this.sidebarItems().toArray())}</ul>\n                    </nav>\n                    <div className=\"IndexPage-results sideNavOffset\">\n                        <div className=\"IndexPage-toolbar\">\n                            <ul className=\"IndexPage-toolbar-view\">{listItems(this.viewItems().toArray())}</ul>\n                            <ul className=\"IndexPage-toolbar-action\">{listItems(this.actionItems().toArray())}</ul>\n                        </div>\n                        {app.cache.discussionList.render()}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    config(isInitialized, context) {\n        super.config(...arguments);\n\n        if (isInitialized) return;\n\n        extend(context, 'onunload', () => $('#app').css('min-height', ''));\n\n        app.setTitle('');\n        app.setTitleCount(0);\n\n        // Work out the difference between the height of this hero and that of the\n        // previous hero. Maintain the same scroll position relative to the bottom\n        // of the hero so that the sidebar doesn't jump around.\n        const oldHeroHeight = app.cache.heroHeight;\n        const heroHeight = app.cache.heroHeight = this.$('.Hero').outerHeight();\n        const scrollTop = app.cache.scrollTop;\n\n        $('#app').css('min-height', $(window).height() + heroHeight);\n\n        // Scroll to the remembered position. We do this after a short delay so that\n        // it happens after the browser has done its own \"back button\" scrolling,\n        // which isn't right. https://github.com/flarum/core/issues/835\n        const scroll = () => $(window).scrollTop(scrollTop - oldHeroHeight + heroHeight);\n        scroll();\n        setTimeout(scroll, 1);\n\n        // If we've just returned from a discussion page, then the constructor will\n        // have set the `lastDiscussion` property. If this is the case, we want to\n        // scroll down to that discussion so that it's in view.\n        if (this.lastDiscussion) {\n            const $discussion = this.$(`.DiscussionListItem[data-id=\"${this.lastDiscussion.id()}\"]`);\n\n            if ($discussion.length) {\n                const indexTop = $('#header').outerHeight();\n                const indexBottom = $(window).height();\n                const discussionTop = $discussion.offset().top;\n                const discussionBottom = discussionTop + $discussion.outerHeight();\n\n                if (discussionTop < scrollTop + indexTop || discussionBottom > scrollTop + indexBottom) {\n                    $(window).scrollTop(discussionTop - indexTop);\n                }\n            }\n        }\n    }\n\n    /**\n     * Get the component to display as the hero.\n     *\n     * @return {MithrilComponent}\n     */\n    hero() {\n        return WelcomeHero.component();\n    }\n\n    /**\n     * Build an item list for the sidebar of the index page. By default this is a\n     * \"New Discussion\" button, and then a DropdownSelect component containing a\n     * list of navigation items.\n     *\n     * @return {ItemList}\n     */\n    sidebarItems() {\n        const items = new ItemList();\n        const canStartDiscussion = app.forum.attribute('canStartDiscussion') || !app.session.user;\n\n        items.add('newDiscussion',\n            Button.component({\n                children: app.translator.trans(canStartDiscussion ? 'core.forum.index.start_discussion_button' : 'core.forum.index.cannot_start_discussion_button'),\n                icon: 'fas fa-edit',\n                className: 'Button Button--primary IndexPage-newDiscussion',\n                itemClassName: 'App-primaryControl',\n                onclick: this.newDiscussion.bind(this),\n                disabled: !canStartDiscussion\n            })\n        );\n\n        items.add('nav',\n            SelectDropdown.component({\n                children: this.navItems(this).toArray(),\n                buttonClassName: 'Button',\n                className: 'App-titleControl'\n            })\n        );\n\n        return items;\n    }\n\n    /**\n     * Build an item list for the navigation in the sidebar of the index page. By\n     * default this is just the 'All Discussions' link.\n     *\n     * @return {ItemList}\n     */\n    navItems() {\n        const items = new ItemList();\n        const params = this.stickyParams();\n\n        items.add('allDiscussions',\n            LinkButton.component({\n                href: app.route('index', params),\n                children: app.translator.trans('core.forum.index.all_discussions_link'),\n                icon: 'far fa-comments'\n            }),\n            100\n        );\n\n        return items;\n    }\n\n    /**\n     * Build an item list for the part of the toolbar which is concerned with how\n     * the results are displayed. By default this is just a select box to change\n     * the way discussions are sorted.\n     *\n     * @return {ItemList}\n     */\n    viewItems() {\n        const items = new ItemList();\n        const sortMap = app.cache.discussionList.sortMap();\n\n        const sortOptions = {};\n        for (const i in sortMap) {\n            sortOptions[i] = app.translator.trans('core.forum.index_sort.' + i + '_button');\n        }\n\n        items.add('sort',\n            Select.component({\n                options: sortOptions,\n                value: this.params().sort || Object.keys(sortMap)[0],\n                onchange: this.changeSort.bind(this)\n            })\n        );\n\n        return items;\n    }\n\n    /**\n     * Build an item list for the part of the toolbar which is about taking action\n     * on the results. By default this is just a \"mark all as read\" button.\n     *\n     * @return {ItemList}\n     */\n    actionItems() {\n        const items = new ItemList();\n\n        items.add('refresh',\n            Button.component({\n                title: app.translator.trans('core.forum.index.refresh_tooltip'),\n                icon: 'fas fa-refresh',\n                className: 'Button Button--icon',\n                onclick: () => app.cache.discussionList.refresh()\n            })\n        );\n\n        if (app.session.user) {\n            items.add('markAllAsRead',\n                Button.component({\n                    title: app.translator.trans('core.forum.index.mark_all_as_read_tooltip'),\n                    icon: 'fas fa-check',\n                    className: 'Button Button--icon',\n                    onclick: this.markAllAsRead.bind(this)\n                })\n            );\n        }\n\n        return items;\n    }\n\n    /**\n     * Return the current search query, if any. This is implemented to activate\n     * the search box in the header.\n     *\n     * @see Search\n     * @return {String}\n     */\n    searching() {\n        return this.params().q;\n    }\n\n    /**\n     * Redirect to the index page without a search filter. This is called when the\n     * 'x' is clicked in the search box in the header.\n     *\n     * @see Search\n     */\n    clearSearch() {\n        const params = this.params();\n        delete params.q;\n\n        m.route(app.route(this.props.routeName, params));\n    }\n\n    /**\n     * Redirect to the index page using the given sort parameter.\n     *\n     * @param {String} sort\n     */\n    changeSort(sort) {\n        const params = this.params();\n\n        if (sort === Object.keys(app.cache.discussionList.sortMap())[0]) {\n            delete params.sort;\n        } else {\n            params.sort = sort;\n        }\n\n        m.route(app.route(this.props.routeName, params));\n    }\n\n    /**\n     * Get URL parameters that stick between filter changes.\n     *\n     * @return {Object}\n     */\n    stickyParams() {\n        return {\n            sort: m.route.param('sort'),\n            q: m.route.param('q')\n        };\n    }\n\n    /**\n     * Get parameters to pass to the DiscussionList component.\n     *\n     * @return {Object}\n     */\n    params() {\n        const params = this.stickyParams();\n\n        params.filter = m.route.param('filter');\n\n        return params;\n    }\n\n    /**\n     * Log the user in and then open the composer for a new discussion.\n     *\n     * @return {Promise}\n     */\n    newDiscussion() {\n        const deferred = m.deferred();\n\n        if (app.session.user) {\n            this.composeNewDiscussion(deferred);\n        } else {\n            app.modal.show(\n                new LogInModal({\n                    onlogin: this.composeNewDiscussion.bind(this, deferred)\n                })\n            );\n        }\n\n        return deferred.promise;\n    }\n\n    /**\n     * Initialize the composer for a new discussion.\n     *\n     * @param {Deferred} deferred\n     * @return {Promise}\n     */\n    composeNewDiscussion(deferred) {\n        const component = new DiscussionComposer({user: app.session.user});\n\n        app.composer.load(component);\n        app.composer.show();\n\n        deferred.resolve(component);\n\n        return deferred.promise;\n    }\n\n    /**\n     * Mark all discussions as read.\n     *\n     * @return void\n     */\n    markAllAsRead() {\n        const confirmation = confirm(app.translator.trans('core.forum.index.mark_all_as_read_confirmation'));\n\n        if (confirmation) {\n            app.session.user.save({readTime: new Date()});\n        }\n    }\n}\n","import DiscussionList from 'flarum/components/DiscussionList';\n\nexport default class PrivateDiscussionList extends DiscussionList\n{\n}\n","import UserPage from 'flarum/components/UserPage';\nimport PrivateDiscussionList from './PrivateDiscussionList';\nimport Button from 'flarum/components/Button';\nimport LogInModal from 'flarum/components/LogInModal';\nimport PrivateDiscussionComposer from './PrivateDiscussionComposer';\n\nexport default class PrivateDiscussionsUserPage extends UserPage {\n    init() {\n        super.init();\n\n        this.loadUser(m.route.param('username'));\n    }\n\n    show(user) {\n        // We can not create the list in init because the user will not be available if it has to be loaded asynchronously\n        this.list = new PrivateDiscussionList({\n            params: {\n                q: `byobu:${user.username()} is:private`,\n                sort: 'newest'\n            }\n        });\n\n        this.list.refresh();\n\n        // We call the parent method after creating the list, this way the this.list property\n        // is set before content() is called for the first time\n        super.show(user);\n    }\n\n    newDiscussionAction(e) {\n        e.preventDefault();\n\n        const deferred = m.deferred();\n\n        if (app.session.user) {\n            const component = new PrivateDiscussionComposer({ user: app.session.user });\n\n            app.composer.load(component);\n            app.composer.show();\n\n            deferred.resolve(component);\n        } else {\n            deferred.reject();\n\n            app.modal.show(new LogInModal());\n        }\n\n        return deferred.promise;\n    }\n\n    content() {\n        const canStartDiscussion = app.forum.attribute('canStartDiscussion') || !app.session.user;\n\n        return (\n            <div className=\"DiscussionsUserPage\">\n                {Button.component({\n                    children: app.translator.trans(canStartDiscussion ? 'core.forum.index.start_discussion_button' : 'core.forum.index.cannot_start_discussion_button'),\n                    // icon: 'fas fa-edit',\n                    className: 'Button Button--primary IndexPage-newDiscussion',\n                    itemClassName: 'App-primaryControl',\n                    onclick: this.newDiscussionAction.bind(this),\n                    disabled: !canStartDiscussion,\n                    style: {marginBottom: '24px'}\n                })}\n                {this.list.render()}\n            </div>\n        );\n    }\n}\n","import Search from \"flarum/components/Search\";\nimport UserSearchSource from \"./sources/UserSearchSource\";\nimport GroupSearchSource from \"./sources/GroupSearchSource\";\nimport ItemList from \"flarum/utils/ItemList\";\nimport classList from \"flarum/utils/classList\";\nimport extractText from \"flarum/utils/extractText\";\nimport LoadingIndicator from \"flarum/components/LoadingIndicator\";\nimport recipientLabel from \"../../common/helpers/recipientLabel\";\nimport User from \"flarum/models/User\";\nimport Group from \"flarum/models/Group\";\n\nexport default class RecipientSearch extends Search {\n\n    config(isInitialized) {\n        if (isInitialized) return;\n\n        const $search = this;\n\n        this.$('.Search-results').on('click', (e) => {\n            const target = this.$('.SearchResult.active')\n\n            $search.addRecipient(target.data('index'));\n            $search.$('.RecipientsInput').focus();\n        });\n\n        this.$('.Search-results').on('touchstart', (e) => {\n            const target = this.$(e.target.parentNode);\n\n            $search.addRecipient(target.data('index'));\n            $search.$('.RecipientsInput').focus();\n        });\n\n        $('.RecipientsInput').on('keyup', () => {\n            clearTimeout(this.typingTimer);\n            this.doSearch = false;\n            this.typingTimer = setTimeout(() => {\n                this.doSearch = true;\n                m.redraw();\n            }, 900);\n        }).on('keydown', () => {\n            clearTimeout(this.typingTimer);\n        });\n\n        super.config(isInitialized);\n    }\n\n    view() {\n        if (typeof this.value() === 'undefined') {\n            this.value('');\n        }\n\n        const loading = this.value() && this.value().length >= 3;\n\n        if (!this.sources) {\n            this.sources = this.sourceItems().toArray();\n        }\n\n        return m('div', {\n            className: 'AddRecipientModal-form-input'\n        }, [\n            m('div', {\n                className: 'RecipientsInput-selected RecipientsLabel'\n            }, this.props.selected().toArray().map(recipient =>\n                recipientLabel(recipient, {\n                    onclick: () => {\n                        this.removeRecipient(recipient);\n                    }\n                })\n            )),\n            m('input', {\n                className: 'RecipientsInput FormControl ' + classList({\n                    open: !!this.value(),\n                    focused: !!this.value(),\n                    active: !!this.value(),\n                    loading: !!this.loadingSources\n                }),\n                config: function (element) {\n                    element.focus();\n                },\n                type: 'search',\n                placeholder: extractText(app.translator.trans('fof-byobu.forum.input.search_recipients')),\n                value: this.value(),\n                oninput: m.withAttr('value', this.value),\n                onfocus: () => this.hasFocus = true,\n                onblur: () => this.hasFocus = false\n            }),\n            m('ul', {\n                className: 'Dropdown-menu Search-results fade ' + classList({\n                    in: !!loading\n                })\n            }, !this.doSearch\n                ? LoadingIndicator.component({size: 'tiny', className: 'Button Button--icon Button--link'})\n                : this.sources.map(source => source.view(this.value()))\n            )\n        ]);\n    }\n\n    /**\n     * Build an item list of SearchSources.\n     *\n     * @return {ItemList}\n     */\n    sourceItems() {\n        const items = new ItemList();\n\n        // Add user source based on permissions.\n        if (\n            (!this.props.discussion && app.forum.attribute('canStartPrivateDiscussionWithUsers')) ||\n            (this.props.discussion && this.props.discussion.canEditUserRecipients())\n        ) {\n            items.add('users', new UserSearchSource());\n        }\n\n        // Add group source based on permissions.\n        if (\n            (!this.props.discussion && app.forum.attribute('canStartPrivateDiscussionWithGroups')) ||\n            (this.props.discussion && this.props.discussion.canEditGroupRecipients())\n        ) {\n            items.add('groups', new GroupSearchSource());\n        }\n\n        return items;\n    }\n\n\n    /**\n     * Clear the search input and the current controller's active search.\n     */\n    clear() {\n        this.value('');\n\n        m.redraw();\n    }\n\n    /**\n     * Adds a recipient.\n     *\n     * @param value\n     */\n    addRecipient(value) {\n\n        let values = value.split(':'),\n            type = values[0],\n            id = values[1];\n\n        let recipient = this.findRecipient(type, id);\n\n        this.props.selected().add(value, recipient);\n\n        this.clear();\n    }\n\n    /**\n     * Removes a recipient.\n     *\n     * @param recipient\n     */\n    removeRecipient(recipient) {\n        let type;\n\n        if (recipient instanceof User) {\n            type = 'users';\n        }\n        if (recipient instanceof Group) {\n            type = 'groups';\n        }\n\n        this.props.selected().remove(type + \":\" + recipient.id());\n\n        m.redraw();\n    }\n\n    /**\n     * Loads a recipient from the global store.\n     *\n     * @param store\n     * @param id\n     * @returns {Model}\n     */\n    findRecipient(store, id) {\n        return app.store.getById(store, id);\n    }\n}\n","import EventPost from \"flarum/components/EventPost\";\nimport recipientsLabel from \"../../common/helpers/recipientsLabel\";\n\nexport default class RecipientsModified extends EventPost {\n    static initProps(props) {\n        super.initProps(props);\n\n        function diff(diff1, diff2, store) {\n            return diff1\n                .filter(item => diff2.indexOf(item) === -1)\n                .map(id => app.store.getById(store, id));\n        }\n\n        const content = props.post.content();\n\n        // For event posts existing before groups functionality.\n        if (!content['new'] && content.length == 2) {\n            const oldRecipients = props.post.content()[0];\n            const newRecipients = props.post.content()[1];\n            props.added = diff(newRecipients, oldRecipients, 'users');\n            props.removed = diff(oldRecipients, newRecipients, 'users');\n        } else {\n            var usersAdded = diff(content['new']['users'], content['old']['users'], 'users');\n            var usersRemoved = diff(content['old']['users'], content['new']['users'], 'users');\n            var groupsAdded = diff(content['new']['groups'], content['old']['groups'], 'groups');\n            var groupsRemoved = diff(content['old']['groups'], content['new']['groups'], 'groups');\n\n            props.added = usersAdded.concat(groupsAdded);\n            props.removed = usersRemoved.concat(groupsRemoved);\n        }\n    }\n\n    icon() {\n        return 'far fa-map';\n    }\n\n    descriptionKey() {\n\n        var localeBase = 'fof-byobu.forum.post.recipients_modified.';\n\n        if (this.props.added.length) {\n            if (this.props.removed.length) {\n                return localeBase + 'added_and_removed';\n            }\n\n            return localeBase + 'added';\n        }\n\n        return localeBase + 'removed';\n    }\n\n    descriptionData() {\n        const data = {};\n\n        if (this.props.added.length) {\n            data.added = recipientsLabel(this.props.added, {link: true});\n        }\n\n        if (this.props.removed.length) {\n            data.removed = recipientsLabel(this.props.removed, {link: true});\n        }\n\n        return data;\n    }\n}\n","import highlight from 'flarum/helpers/highlight';\n\nexport default class GroupSearchSource {\n    search(query) {\n        return app.store.find('groups', {\n            filter: {q: query},\n            page: {limit: 5}\n        });\n    }\n\n    view(query) {\n        query = query.toLowerCase();\n\n        const results = app.store.all('groups')\n            .filter(group => group.namePlural().toLowerCase().substr(0, query.length) === query);\n\n        if (!results.length) return '';\n\n        return [\n            <li className=\"Dropdown-header\">{app.translator.trans('fof-byobu.forum.search.headings.groups')}</li>,\n            results.map(group => {\n                const groupName = group.namePlural();\n                var name = highlight(groupName, query);\n\n                return (\n                    <li className=\"SearchResult\" data-index={'groups:' + group.id()}>\n                        <a data-index={'groups:' + group.id()}>\n                            <span class=\"groupName\">{name}</span>\n                        </a>\n                    </li>\n                );\n            })\n        ];\n    }\n}\n","import highlight from 'flarum/helpers/highlight';\nimport avatar from 'flarum/helpers/avatar';\nimport username from 'flarum/helpers/username';\n\nexport default class UserSearchSource {\n    view(query) {\n        if (query.length < 3 || this.loading) return;\n\n        if (!app.cache.byobuResults) {\n            app.cache.byobuResults = [];\n        }\n\n        this.query = query;\n\n        if (!app.cache.byobuResults[this.query]) {\n\n            this.loading = true;\n\n            app.cache.byobuResults[this.query] = [];\n            app.store.find('users', {\n                filter: {q: this.query + ' allows-pd'},\n                page: {limit: 5}\n            }).then(this.pushResults.bind(this));\n        } else\n\n            return [\n                <li className=\"Dropdown-header\">{app.translator.trans('core.forum.search.users_heading')}</li>,\n                app.cache.byobuResults[this.query].map(user => {\n                    const name = username(user);\n                    name.children[0] = highlight(name.children[0], this.query);\n\n                    return (\n                        <li className='SearchResult' data-index={'users:' + user.id()}>\n                            <a data-index={'users:' + user.id()}>\n                                {avatar(user)}\n                                {name}\n                            </a>\n                        </li>\n                    );\n                })\n            ];\n    }\n\n    pushResults(results) {\n        results.payload.data.map(result => {\n            var user = app.store.getById('users', result.id);\n            app.cache.byobuResults[this.query].push(user);\n        });\n        this.loading = false;\n        m.redraw();\n    }\n}\n","import Model from \"flarum/Model\";\nimport Discussion from \"flarum/models/Discussion\";\nimport User from \"flarum/models/User\";\nimport addRecipientComposer from \"./addRecipientComposer\";\nimport addRecipientLabels from \"./addRecipientLabels\";\nimport addRecipientsControl from \"./addRecipientsControl\";\nimport addHasRecipientsBadge from \"./addHasRecipientsBadge\";\nimport addDiscussPrivatelyControl from './addDiscussPrivatelyControl';\nimport addPrivacySetting from './addPrivacySetting';\nimport addPrivateDiscussionsPage from \"./addPrivateDiscussionsPage\";\nimport addPrivateMessageSessionDropdownLinkButton from './addPrivateMessageSessionDropdownLinkButton';\nimport removeTagComposer from './removeTagComposer';\n\nimport PrivateDiscussionIndex from \"./components/PrivateDiscussionIndex\";\nimport RecipientsModified from \"./components/RecipientsModified\";\n\napp.initializers.add('fof-byobu', function(app) {\n    app.routes.private_discussions = {path: '/private-discussions', component: PrivateDiscussionIndex.component()};\n\n    Discussion.prototype.recipientUsers = Model.hasMany('recipientUsers');\n    Discussion.prototype.oldRecipientUsers = Model.hasMany('oldRecipientUsers');\n    Discussion.prototype.recipientGroups = Model.hasMany('recipientGroups');\n    Discussion.prototype.oldRecipientGroups = Model.hasMany('oldRecipientGroups');\n\n    Discussion.prototype.canEditRecipients = Model.attribute('canEditRecipients');\n    Discussion.prototype.canEditUserRecipients = Model.attribute('canEditUserRecipients');\n    Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n    Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n\n    User.prototype.blocksPd = Model.attribute('blocksPd');\n    User.prototype.cannotBeDirectMessaged = Model.attribute('cannotBeDirectMessaged');\n\n    app.postComponents.recipientsModified = RecipientsModified;\n\n    addRecipientComposer(app);\n    addRecipientLabels();\n    addRecipientsControl();\n    addHasRecipientsBadge();\n    addPrivacySetting();\n    addPrivateMessageSessionDropdownLinkButton();\n\n    addDiscussPrivatelyControl();\n\n    addPrivateDiscussionsPage();\n\n    removeTagComposer();\n});\n","import { extend, override } from \"flarum/extend\";\nimport PrivateDiscussionComposer from \"./components/PrivateDiscussionComposer\";\n\nexport default function () {\n    PrivateDiscussionComposer.prototype.tags = [];\n\n    extend(PrivateDiscussionComposer.prototype, 'headerItems', function (items) {\n        items.remove('tags');\n    });\n\n    override(PrivateDiscussionComposer.prototype, 'onsubmit', function (original) {\n        const tag = app.store.getBy('tags', 'slug', 'general-discussion');\n\n        this.tags = [tag];\n\n        original();\n    });\n\n    extend(PrivateDiscussionComposer.prototype, 'data', function (data) {\n        data.relationships = data.relationships || {};\n        data.relationships.tags = this.tags;\n    });\n}\n","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['components/Badge'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/DiscussionComposer'];","module.exports = flarum.core.compat['components/DiscussionHero'];","module.exports = flarum.core.compat['components/DiscussionList'];","module.exports = flarum.core.compat['components/DiscussionListItem'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['components/EventPost'];","module.exports = flarum.core.compat['components/LinkButton'];","module.exports = flarum.core.compat['components/LoadingIndicator'];","module.exports = flarum.core.compat['components/LogInModal'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['components/Search'];","module.exports = flarum.core.compat['components/Select'];","module.exports = flarum.core.compat['components/SelectDropdown'];","module.exports = flarum.core.compat['components/SessionDropdown'];","module.exports = flarum.core.compat['components/SettingsPage'];","module.exports = flarum.core.compat['components/Switch'];","module.exports = flarum.core.compat['components/UserPage'];","module.exports = flarum.core.compat['components/WelcomeHero'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/avatar'];","module.exports = flarum.core.compat['helpers/highlight'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['helpers/listItems'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['models/Discussion'];","module.exports = flarum.core.compat['models/Group'];","module.exports = flarum.core.compat['models/User'];","module.exports = flarum.core.compat['utils/DiscussionControls'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['utils/UserControls'];","module.exports = flarum.core.compat['utils/classList'];","module.exports = flarum.core.compat['utils/extract'];","module.exports = flarum.core.compat['utils/extractText'];"],"sourceRoot":""}
>>>>>>> parent of 43050ed... Notifications for new PD created
