{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/byobu/webpack/bootstrap","webpack://@fof/byobu/webpack/runtime/compat get default export","webpack://@fof/byobu/webpack/runtime/define property getters","webpack://@fof/byobu/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/byobu/webpack/runtime/make namespace object","webpack://@fof/byobu/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/EventPost']\"","webpack://@fof/byobu/./src/forum/events/MadePublic.ts","webpack://@fof/byobu/./src/forum/events/RecipientLeft.js","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack://@fof/byobu/external root \"flarum.core.compat['common/models/User']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/models/Group']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/byobu/./src/forum/pages/labels/RecipientLabel.tsx","webpack://@fof/byobu/./src/forum/pages/labels/recipientsLabels.tsx","webpack://@fof/byobu/./src/forum/events/RecipientsModified.js","webpack://@fof/byobu/./src/forum/events/index.js","webpack://@fof/byobu/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@fof/byobu/./src/forum/extend/SettingsPage.js","webpack://@fof/byobu/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/states/SearchState']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/Search']\"","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/byobu/external root \"flarum.core.compat['common/helpers/highlight']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@fof/byobu/./src/forum/search/sources/UserSearchSource.js","webpack://@fof/byobu/./src/forum/search/sources/GroupSearchSource.js","webpack://@fof/byobu/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@fof/byobu/./src/forum/search/RecipientSearch.js","webpack://@fof/byobu/./src/forum/modals/AddRecipientModal.js","webpack://@fof/byobu/external root \"flarum.core.compat['tags/components/TagDiscussionModal']\"","webpack://@fof/byobu/./src/forum/modals/ByobuTagDiscussionModal.js","webpack://@fof/byobu/external root \"flarum.core.compat['components/DiscussionPage']\"","webpack://@fof/byobu/./src/forum/extend/Discussion.js","webpack://@fof/byobu/external root \"flarum.core.compat['forum/utils/UserControls']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@fof/byobu/./src/forum/pages/discussions/PrivateDiscussionComposer.js","webpack://@fof/byobu/./src/forum/pages/labels/recipientCountLabel.js","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@fof/byobu/./src/forum/helpers/canStartPrivateDiscussion.js","webpack://@fof/byobu/./src/forum/extend/User.js","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@fof/byobu/./src/forum/states/PrivateDiscussionListState.js","webpack://@fof/byobu/external root \"flarum.core.compat['common/components/Dropdown']\"","webpack://@fof/byobu/external root \"flarum.core.compat['common/helpers/listItems']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@fof/byobu/./src/forum/pages/discussions/PrivateDiscussionList.js","webpack://@fof/byobu/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://@fof/byobu/./src/forum/pages/PrivateComposing.js","webpack://@fof/byobu/./src/forum/pages/PrivateDiscussionsUserPage.js","webpack://@fof/byobu/./src/forum/pages/routes.js","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/NotificationGrid']\"","webpack://@fof/byobu/external root \"flarum.core.compat['forum/components/Notification']\"","webpack://@fof/byobu/./src/forum/notifications/PrivateDiscussionNotification.js","webpack://@fof/byobu/./src/forum/notifications/PrivateDiscussionReplyNotification.js","webpack://@fof/byobu/./src/forum/notifications/PrivateDiscussionUserLeftNotification.js","webpack://@fof/byobu/./src/forum/notifications/PrivateDiscussionAddedNotification.js","webpack://@fof/byobu/external root \"flarum.core.compat['components/Notification']\"","webpack://@fof/byobu/./src/forum/notifications/PrivateDiscussionMadePublicNotification.js","webpack://@fof/byobu/./src/forum/modals/index.js","webpack://@fof/byobu/./src/forum/pages/discussions/index.js","webpack://@fof/byobu/./src/forum/index.ts","webpack://@fof/byobu/./src/forum/pages/PrivateDiscussionsPage.js","webpack://@fof/byobu/./src/forum/notifications/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/EventPost'];","import app from 'flarum/forum/app';\nimport EventPost from 'flarum/forum/components/EventPost';\n\nexport default class MadePublic extends EventPost {\n  static initAttrs(attrs: any) {\n    super.initAttrs(attrs);\n  }\n\n  icon() {\n    return app.forum.attribute('byobu.icon-postAction');\n  }\n\n  descriptionKey() {\n    return 'fof-byobu.forum.post.recipients_modified.made_public';\n  }\n}\n","import app from 'flarum/forum/app';\nimport EventPost from 'flarum/forum/components/EventPost';\n\nexport default class RecipientLeft extends EventPost {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n  }\n\n  icon() {\n    return app.forum.attribute('byobu.icon-postAction');\n  }\n\n  descriptionKey() {\n    return 'fof-byobu.forum.post.recipients_modified.removed_self';\n  }\n}\n","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/User'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Group'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","import type * as Mithril from 'mithril';\nimport username from 'flarum/common/helpers/username';\nimport User from 'flarum/common/models/User';\nimport Group from 'flarum/common/models/Group';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport classList from 'flarum/common/utils/classList';\nimport app from 'flarum/forum/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\n\nexport interface IRecipientLabelAttrs extends ComponentAttrs, Mithril.Attributes {\n  recipient: User | Group;\n  link: string;\n}\n\nexport default class RecipientLabel extends Component<IRecipientLabelAttrs> {\n  view(vnode: Mithril.Vnode) {\n    const { recipient, link, ...newAttrs } = this.attrs;\n\n    newAttrs.style = newAttrs.style || {};\n    newAttrs.className = classList('RecipientLabel', newAttrs?.className);\n\n    if (link && recipient instanceof User) {\n      newAttrs.href = app.route.user(recipient);\n    }\n\n    let label: string;\n\n    if (recipient instanceof User) {\n      label = username(recipient);\n\n      if (!newAttrs.href && recipient.id() !== app?.session?.user?.id()) {\n        newAttrs.href = app.route.user(recipient);\n      }\n    } else if (recipient instanceof Group) {\n      return <span class={newAttrs.className}>{recipient.namePlural()}</span>;\n    } else {\n      newAttrs.className += ' none';\n      label = app.translator.trans('core.lib.username.deleted_text');\n    }\n\n    return <LinkButton {...newAttrs}>{label}</LinkButton>;\n  }\n}\n","import Group from 'flarum/common/models/Group';\nimport User from 'flarum/common/models/User';\nimport classList from 'flarum/common/utils/classList';\nimport RecipientLabel from './RecipientLabel';\n\nexport default function recipientsLabel(recipients?: (User | Group)[], attrs: Record<string, unknown> = {}): JSX.Element {\n  const { link, className, ...otherAttrs } = attrs;\n\n  otherAttrs.className = classList('RecipientsLabel', className);\n\n  return (\n    <span {...otherAttrs}>\n      {recipients?.map((recipient, index) => {\n        const type = recipient instanceof User ? 'u' : 'g';\n\n        return <RecipientLabel key={`${type}-${index}`} recipient={recipient} link={link} />;\n      })}\n      {!recipients && <RecipientLabel />}\n    </span>\n  );\n}\n","import app from 'flarum/forum/app';\nimport EventPost from 'flarum/forum/components/EventPost';\nimport recipientsLabel from '../pages/labels/recipientsLabels';\n\nexport default class RecipientsModified extends EventPost {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    function diff(diff1, diff2, store) {\n      return diff1.filter((item) => diff2.indexOf(item) === -1).map((id) => app.store.getById(store, id));\n    }\n\n    const content = attrs.post.content();\n\n    // For event posts existing before groups functionality.\n    if (!content['new'] && content.length == 2) {\n      const oldRecipients = attrs.post.content()[0];\n      const newRecipients = attrs.post.content()[1];\n      attrs.added = diff(newRecipients, oldRecipients, 'users');\n      attrs.removed = diff(oldRecipients, newRecipients, 'users');\n    } else {\n      let usersAdded = diff(content['new']['users'], content['old']['users'], 'users');\n      let usersRemoved = diff(content['old']['users'], content['new']['users'], 'users');\n      let groupsAdded = diff(content['new']['groups'], content['old']['groups'], 'groups');\n      let groupsRemoved = diff(content['old']['groups'], content['new']['groups'], 'groups');\n\n      attrs.added = usersAdded.concat(groupsAdded);\n      attrs.removed = usersRemoved.concat(groupsRemoved);\n    }\n  }\n\n  icon() {\n    return app.forum.attribute('byobu.icon-postAction');\n  }\n\n  descriptionKey() {\n    var localeBase = 'fof-byobu.forum.post.recipients_modified.';\n\n    if (this.attrs.added.length) {\n      if (this.attrs.removed.length) {\n        return localeBase + 'added_and_removed';\n      }\n\n      return localeBase + 'added';\n    }\n\n    return localeBase + 'removed';\n  }\n\n  descriptionData() {\n    const data = {};\n\n    if (this.attrs.added.length) {\n      data.added = recipientsLabel(this.attrs.added, { link: true });\n    }\n\n    if (this.attrs.removed.length) {\n      data.removed = recipientsLabel(this.attrs.removed, { link: true });\n    }\n\n    return data;\n  }\n}\n","import app from 'flarum/forum/app';\nimport MadePublic from './MadePublic';\nimport RecipientLeft from './RecipientLeft';\nimport RecipientsModified from './RecipientsModified';\n\nexport default () => {\n  app.postComponents.recipientsModified = RecipientsModified;\n  app.postComponents.recipientLeft = RecipientLeft;\n  app.postComponents.madePublic = MadePublic;\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\nimport Switch from 'flarum/common/components/Switch';\n\nexport default () => {\n  privacyToggle();\n};\n\nfunction privacyToggle() {\n  extend(SettingsPage.prototype, 'privacyItems', function (items) {\n    items.add(\n      'byobu-block-dm',\n      Switch.component(\n        {\n          state: this.user.blocksPd(),\n          onchange: (value) => {\n            this.blocksPdLoading = true;\n\n            this.user.save({ blocksPd: value }).then(() => {\n              this.blocksPdLoading = false;\n              m.redraw();\n            });\n          },\n          loading: this.blocksPdLoading,\n        },\n        app.translator.trans('fof-byobu.forum.user.settings.block_pd')\n      )\n    );\n  });\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionListItem'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionHero'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/SearchState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/Search'];","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/highlight'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","import app from 'flarum/forum/app';\nimport highlight from 'flarum/common/helpers/highlight';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\n\nexport default class UserSearchSource {\n  view(query) {\n    if (query.length < 3 || this.loading) return;\n\n    if (!app.cache.byobuResults) {\n      app.cache.byobuResults = [];\n    }\n\n    this.query = query;\n\n    if (!app.cache.byobuResults[this.query]) {\n      this.loading = true;\n\n      app.cache.byobuResults[this.query] = [];\n      app.store\n        .find('users', {\n          filter: { q: this.query + ' allows-pd' },\n          page: { limit: 5 },\n        })\n        .then(this.pushResults.bind(this));\n    } else\n      return [\n        <li className=\"Dropdown-header\">{app.translator.trans('core.forum.search.users_heading')}</li>,\n        app.cache.byobuResults[this.query].map((user) => {\n          const name = username(user);\n          const children = [highlight(name.text, this.query)];\n\n          return (\n            <li className=\"SearchResult\" data-index={'users:' + user.id()}>\n              <a data-index={'users:' + user.id()}>\n                {avatar(user)}\n                {{ ...name, text: undefined, children }}\n              </a>\n            </li>\n          );\n        }),\n      ];\n  }\n\n  pushResults(results) {\n    results.payload.data.map((result) => {\n      var user = app.store.getById('users', result.id);\n      app.cache.byobuResults[this.query].push(user);\n    });\n    this.loading = false;\n    m.redraw();\n  }\n}\n","import app from 'flarum/forum/app';\nimport highlight from 'flarum/common/helpers/highlight';\n\nexport default class GroupSearchSource {\n  search(query) {\n    return app.store.find('groups', {\n      filter: { q: query },\n      page: { limit: 5 },\n    });\n  }\n\n  view(query) {\n    query = query.toLowerCase();\n\n    const results = app.store.all('groups').filter((group) => group.namePlural().toLowerCase().substr(0, query.length) === query);\n\n    if (!results.length) return '';\n\n    return [\n      <li className=\"Dropdown-header\">{app.translator.trans('fof-byobu.forum.search.headings.groups')}</li>,\n      results.map((group) => {\n        const groupName = group.namePlural();\n        var name = highlight(groupName, query);\n\n        return (\n          <li className=\"SearchResult\" data-index={'groups:' + group.id()}>\n            <a data-index={'groups:' + group.id()}>\n              <span class=\"groupName\">{name}</span>\n            </a>\n          </li>\n        );\n      }),\n    ];\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","import app from 'flarum/forum/app';\nimport Search from 'flarum/forum/components/Search';\nimport UserSearchSource from './sources/UserSearchSource';\nimport GroupSearchSource from './sources/GroupSearchSource';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport RecipientLabel from '../pages/labels/RecipientLabel';\nimport User from 'flarum/common/models/User';\nimport Group from 'flarum/common/models/Group';\nimport Tooltip from 'flarum/common/components/Tooltip';\n\nexport default class RecipientSearch extends Search {\n  /**\n   * Used to prevent duplicate IDs. Doesn't remove the possibility, but is extremely low.\n   */\n  inputUuid;\n\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.inputUuid = Math.random().toString(36).substring(2);\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    const $search = this;\n\n    this.$('.Search-results').on('click', (e) => {\n      const target = this.$('.SearchResult.active');\n\n      $search.addRecipient(target.data('index'));\n      $search.$('.RecipientsInput').focus();\n    });\n\n    this.$('.Search-results').on('touchstart', (e) => {\n      const target = this.$(e.target.parentNode);\n\n      $search.addRecipient(target.data('index'));\n      $search.$('.RecipientsInput').focus();\n    });\n\n    $('.RecipientsInput')\n      .on('input', () => {\n        clearTimeout(this.typingTimer);\n        this.doSearch = false;\n        this.typingTimer = setTimeout(() => {\n          this.doSearch = true;\n          m.redraw();\n        }, 900);\n      })\n      .on('keydown', () => {\n        clearTimeout(this.typingTimer);\n      });\n\n    super.oncreate(vnode);\n  }\n\n  view() {\n    if (typeof this.searchState.getValue() === 'undefined') {\n      this.searchState.setValue('');\n    }\n\n    const loading = this.searchState.getValue() && this.searchState.getValue().length >= 3;\n\n    if (!this.sources) {\n      this.sources = this.sourceItems().toArray();\n    }\n\n    return (\n      <div role=\"search\" className=\"Search\">\n        <div className=\"RecipientsInput-selected RecipientsLabel\" aria-live=\"polite\">\n          <h4>{app.translator.trans('fof-byobu.forum.modal.labels.selected_users')}</h4>\n          <p>{app.translator.trans('fof-byobu.forum.modal.help.selected_users')}</p>\n\n          {this.attrs\n            .selected()\n            .toArray()\n            .map((recipient) => {\n              return (\n                <Tooltip text={app.translator.trans('fof-byobu.forum.modal.help.click_user_to_remove_tooltip')}>\n                  <RecipientLabel data-container=\"body\" recipient={recipient} onclick={(e) => this.removeRecipient(recipient, e)} />\n                </Tooltip>\n              );\n            })}\n        </div>\n\n        <div className=\"Form-group\">\n          <label for={`byobu-addrecipient-search-input-${this.inputUuid}`}>{app.translator.trans('fof-byobu.forum.modal.labels.search_field')}</label>\n\n          <div className=\"AddRecipientModal-form-input Search-input\">\n            <input\n              id={`byobu-addrecipient-search-input-${this.inputUuid}`}\n              className={classList('RecipientsInput', 'FormControl', {\n                open: !!this.searchState.getValue(),\n                focused: !!this.searchState.getValue(),\n                active: !!this.searchState.getValue(),\n                loading: !!this.loadingSources,\n              })}\n              oncreate={(vnode) => vnode.dom.focus()}\n              type=\"search\"\n              placeholder={extractText(app.translator.trans('fof-byobu.forum.input.search_recipients'))}\n              value={this.searchState.getValue()}\n              oninput={(e) => this.searchState.setValue(e.target.value)}\n              onfocus={() => (this.hasFocus = true)}\n              onblur={() => (this.hasFocus = false)}\n            />\n            <ul\n              className={classList('Dropdown-menu', 'Search-results', 'fade', {\n                in: !!loading,\n              })}\n            >\n              {!this.doSearch\n                ? LoadingIndicator.component({ size: 'tiny', className: 'Button Button--icon Button--link' })\n                : this.sources.map((source) => source.view(this.searchState.getValue()))}\n            </ul>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  /**\n   * Build an item list of SearchSources.\n   *\n   * @return {ItemList}\n   */\n  sourceItems() {\n    const items = new ItemList();\n\n    // Add user source based on permissions.\n    if (\n      (!this.attrs.discussion && app.forum.attribute('canStartPrivateDiscussionWithUsers')) ||\n      (this.attrs.discussion && this.attrs.discussion.canEditUserRecipients())\n    ) {\n      items.add('users', new UserSearchSource());\n    }\n\n    // Add group source based on permissions.\n    if (\n      (!this.attrs.discussion && app.forum.attribute('canStartPrivateDiscussionWithGroups')) ||\n      (this.attrs.discussion && this.attrs.discussion.canEditGroupRecipients())\n    ) {\n      items.add('groups', new GroupSearchSource());\n    }\n\n    return items;\n  }\n\n  /**\n   * Adds a recipient.\n   *\n   * @param value\n   */\n  addRecipient(value) {\n    let values = value.split(':'),\n      type = values[0],\n      id = values[1];\n\n    let recipient = this.findRecipient(type, id);\n\n    this.attrs.selected().add(value, recipient);\n\n    this.searchState.clear();\n  }\n\n  /**\n   * Removes a recipient.\n   *\n   * @param recipient\n   */\n  removeRecipient(recipient, e) {\n    e.preventDefault();\n\n    let type;\n\n    if (recipient instanceof User) {\n      type = 'users';\n    }\n    if (recipient instanceof Group) {\n      type = 'groups';\n    }\n\n    this.attrs.selected().remove(type + ':' + recipient.id());\n  }\n\n  /**\n   * Loads a recipient from the global store.\n   *\n   * @param store\n   * @param id\n   * @returns {Model}\n   */\n  findRecipient(store, id) {\n    return app.store.getById(store, id);\n  }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\nimport Button from 'flarum/common/components/Button';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Stream from 'flarum/common/utils/Stream';\nimport SearchState from 'flarum/forum/states/SearchState';\nimport RecipientSearch from '../search/RecipientSearch';\nimport User from 'flarum/common/models/User';\nimport Group from 'flarum/common/models/Group';\n\nexport default class AddRecipientModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.selected = Stream(new ItemList());\n\n    if (this.attrs.discussion) {\n      // Adds recipients of the currently viewed discussion.\n      this.assignInitialRecipients(this.attrs.discussion);\n    } else if (this.attrs.selectedRecipients && this.attrs.selectedRecipients.toArray().length > 0) {\n      // Adds previously selected recipients.\n      this.selected().merge(this.attrs.selectedRecipients);\n    } else {\n      // Adds the current user in case there are no selected recipients yet and this is a new discussion.\n      this.selected().add('users:' + app.session.user.id(), app.session.user);\n    }\n\n    this.recipientSearch = new SearchState();\n  }\n\n  isDismissible() {\n    return false;\n  }\n\n  assignInitialRecipients(discussion) {\n    discussion.recipientUsers().map((user) => {\n      this.selected().add('users:' + user.id(), user);\n    });\n    discussion.recipientGroups().map((group) => {\n      this.selected().add('groups:' + group.id(), group);\n    });\n  }\n\n  className() {\n    return 'AddRecipientModal';\n  }\n\n  title() {\n    return this.attrs.discussion\n      ? app.translator.trans('fof-byobu.forum.modal.titles.update_recipients', { title: <em>{this.attrs.discussion.title()}</em> })\n      : app.translator.trans('fof-byobu.forum.modal.titles.add_recipients');\n  }\n\n  helpText() {\n    return this.attrs.discussion\n      ? app.translator.trans('fof-byobu.forum.modal.help.update_recipients')\n      : app.translator.trans('fof-byobu.forum.modal.help.add_recipients');\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n        <div class=\"AddRecipientModal-help\">{this.helpText()}</div>\n        <div className=\"AddRecipientModal-form\">\n          {RecipientSearch.component({\n            state: this.recipientSearch,\n            selected: this.selected,\n            discussion: this.attrs.discussion,\n          })}\n          <div className=\"AddRecipientModal-form-submit App-primaryControl\">\n            {Button.component(\n              {\n                type: 'submit',\n                className: 'Button Button--primary',\n                icon: 'fas fa-check',\n              },\n              app.translator.trans('fof-byobu.forum.buttons.submit')\n            )}\n            {Button.component(\n              {\n                onclick: this.hide.bind(this),\n                className: 'Button Button--cancel',\n              },\n              app.translator.trans('fof-byobu.forum.buttons.cancel')\n            )}\n          </div>\n        </div>\n      </div>,\n    ];\n  }\n\n  select(e) {\n    // Ctrl + Enter submits the selection, just Enter completes the current entry\n    if (e.metaKey || e.ctrlKey || this.selected.indexOf(this.index) !== -1) {\n      if (this.selected().length) {\n        this.$('form').submit();\n      }\n    }\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    const discussion = this.attrs.discussion;\n    const recipients = this.selected();\n\n    let recipientGroups = [];\n    let recipientUsers = [];\n\n    recipients.toArray().forEach((recipient) => {\n      if (recipient instanceof User) {\n        recipientUsers.push(recipient);\n      }\n      if (recipient instanceof Group) {\n        recipientGroups.push(recipient);\n      }\n    });\n\n    // Recipients are updated here for existing discussions here.\n    if (discussion) {\n      discussion.save({ relationships: { recipientUsers, recipientGroups } }).then(() => {\n        if (app.current instanceof DiscussionPage) {\n          app.current.stream.update();\n        }\n        m.redraw();\n      });\n    }\n\n    // Use the onsubmit callback to trigger an update in the DiscussionComposer\n    if (this.attrs.onsubmit) this.attrs.onsubmit(recipients);\n\n    app.modal.close();\n\n    if (!this.attrs.discussion) {\n      app.composer.show();\n    }\n\n    e.redraw = false;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/components/TagDiscussionModal'];","import app from 'flarum/forum/app';\nimport TagDiscussionModal from 'flarum/tags/components/TagDiscussionModal';\n\nexport default class ByobuTagDiscussionModal extends TagDiscussionModal {\n  static isDismissible = false;\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    const tags = this.selected;\n\n    if (this.attrs.resolve) this.attrs.resolve(tags);\n\n    this.hide();\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/DiscussionPage'];","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport Model from 'flarum/common/Model';\nimport Badge from 'flarum/common/components/Badge';\nimport Discussion from 'flarum/common/models/Discussion';\nimport User from 'flarum/common/models/User';\nimport Group from 'flarum/common/models/Group';\nimport Button from 'flarum/common/components/Button';\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport recipientsLabel from '../pages/labels/recipientsLabels';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport AddRecipientModal from './../modals/AddRecipientModal';\nimport ByobuTagDiscussionModal from '../modals/ByobuTagDiscussionModal';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\n\nexport default () => {\n  attributes();\n  badges();\n  index();\n  hero();\n  apiInclude();\n  controls();\n};\n\nconst add = function (discussion, items, long) {\n  let recipients = [];\n\n  if (discussion.recipientUsers().length) {\n    recipients = recipients.concat(discussion.recipientUsers());\n  }\n\n  if (discussion.recipientGroups().length) {\n    recipients = recipients.concat(discussion.recipientGroups());\n  }\n\n  if (recipients && recipients.length) {\n    if (long) {\n      items.add('recipients', recipientsLabel(recipients), 10);\n    } else {\n      items.add('recipients', recipientsLabel(recipients, { link: true }), 4);\n    }\n  }\n};\n\nfunction badges() {\n  extend(Discussion.prototype, 'badges', function (badges) {\n    if (this.recipientUsers().length || this.recipientGroups().length) {\n      badges.add(\n        'private',\n        Badge.component({\n          type: 'private',\n          label: app.translator.trans('fof-byobu.forum.badges.is_private.tooltip'),\n          icon: app.forum.data.attributes['byobu.icon-badge'],\n        }),\n        10\n      );\n    }\n  });\n}\n\nfunction index() {\n  extend(DiscussionListItem.prototype, 'infoItems', function (items) {\n    const discussion = this.attrs.discussion;\n\n    add(discussion, items, true);\n  });\n}\n\nfunction hero() {\n  extend(DiscussionHero.prototype, 'items', function (items) {\n    const discussion = this.attrs.discussion;\n\n    add(discussion, items, false);\n  });\n}\n\nfunction apiInclude() {\n  extend(DiscussionListState.prototype, 'requestParams', function (params) {\n    params.include.push('recipientUsers');\n    params.include.push('recipientGroups');\n  });\n}\n\nfunction controls() {\n  extend(DiscussionControls, 'moderationControls', function (items, discussion) {\n    if (discussion.canEditRecipients()) {\n      items.add(\n        'recipients',\n        Button.component(\n          {\n            icon: app.forum.data.attributes['byobu.icon-badge'],\n            onclick: () => app.modal.show(AddRecipientModal, { discussion }),\n          },\n          app.translator.trans('fof-byobu.forum.buttons.edit_recipients')\n        )\n      );\n    }\n    if (discussion && discussion.recipientUsers().find((user) => user.id() === app.session.user.id())) {\n      items.add(\n        'remove',\n        Button.component(\n          {\n            icon: 'fas fa-user-slash',\n            onclick: () => {\n              if (discussion) {\n                let recipients = new ItemList();\n                discussion.recipientUsers().map((user) => {\n                  if (app.session.user.id() !== user.id()) {\n                    recipients.add('users:' + user.id(), user);\n                  }\n                });\n\n                let recipientGroups = [];\n                let recipientUsers = [];\n\n                recipients.toArray().forEach((recipient) => {\n                  if (recipient instanceof User) {\n                    recipientUsers.push(recipient);\n                  }\n                  if (recipient instanceof Group) {\n                    recipientGroups.push(recipient);\n                  }\n                });\n\n                discussion\n                  .save({\n                    relationships: {\n                      recipientUsers,\n                      recipientGroups,\n                    },\n                  })\n                  .then(() => app.history.back());\n              }\n            },\n          },\n          app.translator.trans('fof-byobu.forum.buttons.remove_from_discussion')\n        )\n      );\n\n      if (discussion?.isPrivateDiscussion?.() && discussion?.canMakePublic?.()) {\n        items.add(\n          'transform-public',\n          <Button\n            icon=\"far fa-eye\"\n            onclick={() => {\n              if (discussion && confirm(app.translator.trans('fof-byobu.forum.confirm.make_public'))) {\n                const recipientGroups = [];\n                const recipientUsers = [];\n\n                if (flarum.extensions['flarum-tags']) {\n                  new Promise((resolve, reject) => {\n                    app.modal.show(ByobuTagDiscussionModal, { discussion, resolve, reject });\n                  }).then((tags) => {\n                    discussion.save({ relationships: { recipientUsers, recipientGroups }, public: discussion.id() }).then(() => {\n                      discussion.save({ relationships: { tags } }).then(() => {\n                        if (app.current.matches(DiscussionPage)) {\n                          app.current.get('stream').update();\n                        }\n                        m.redraw();\n                      });\n                    });\n                  });\n                } else {\n                  discussion.save({ relationships: { recipientUsers, recipientGroups }, public: discussion.id() }).then(() => m.redraw());\n                }\n              }\n            }}\n          >\n            {app.translator.trans('fof-byobu.forum.buttons.make_public')}\n          </Button>\n        );\n      }\n    }\n  });\n}\n\nfunction attributes() {\n  Discussion.prototype.recipientUsers = Model.hasMany('recipientUsers');\n  Discussion.prototype.oldRecipientUsers = Model.hasMany('oldRecipientUsers');\n  Discussion.prototype.recipientGroups = Model.hasMany('recipientGroups');\n  Discussion.prototype.oldRecipientGroups = Model.hasMany('oldRecipientGroups');\n\n  Discussion.prototype.canEditRecipients = Model.attribute('canEditRecipients');\n  Discussion.prototype.canEditUserRecipients = Model.attribute('canEditUserRecipients');\n  Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n  Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n  Discussion.prototype.canMakePublic = Model.attribute('canMakePublic');\n\n  Discussion.prototype.isPrivateDiscussion = Model.attribute('isPrivateDiscussion');\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/UserControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","import app from 'flarum/forum/app';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\nimport AddRecipientModal from '../../modals/AddRecipientModal';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport recipientCountLabel from '../labels/recipientCountLabel';\nimport User from 'flarum/common/models/User';\nimport Group from 'flarum/common/models/Group';\n\nexport default class PrivateDiscussionComposer extends DiscussionComposer {\n  /**\n   * Tells other extensions that this composer is a Byobu composer.\n   */\n  _isByobuComposer = true;\n\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    attrs.titlePlaceholder = app.translator.trans('fof-byobu.forum.composer_private_discussion.title_placeholder');\n    attrs.submitLabel = app.translator.trans('fof-byobu.forum.composer_private_discussion.submit_button');\n  }\n\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.composer.fields.recipients = this.attrs.recipients || new ItemList();\n\n    this.composer.fields.recipientUsers = this.attrs.recipientUsers || [];\n    this.composer.fields.recipientGroups = this.attrs.recipientGroups || [];\n\n    const username = m.route.param('username');\n\n    if (typeof username !== 'undefined') {\n      this.addDefaultRecipients(username);\n    }\n  }\n\n  data() {\n    let data = super.data();\n\n    const users = [];\n    const groups = [];\n\n    if (this.composer.fields.recipients !== undefined) {\n      this.composer.fields.recipients.toArray().forEach((recipient) => {\n        if (recipient instanceof User) {\n          users.push(recipient);\n        }\n\n        if (recipient instanceof Group) {\n          groups.push(recipient);\n        }\n      });\n    }\n\n    data.relationships = data.relationships || {};\n\n    if (users.length) {\n      data.relationships.recipientUsers = users;\n    }\n\n    if (groups.length) {\n      data.relationships.recipientGroups = groups;\n    }\n\n    delete data.relationships.tags;\n\n    return data;\n  }\n\n  chooseRecipients() {\n    app.modal.show(AddRecipientModal, {\n      selectedRecipients: this.composer.fields.recipients,\n      onsubmit: (recipients) => {\n        this.composer.fields.recipients = recipients;\n\n        // Focus on recipient autocomplete field.\n        this.$('.RecipientsInput').focus();\n      },\n    });\n  }\n\n  headerItems() {\n    let items = super.headerItems();\n\n    items.remove('tags');\n\n    if (app.session.user && app.forum.attribute('canStartPrivateDiscussion')) {\n      const recipients = this.composer.fields.recipients.toArray();\n\n      items.add(\n        'recipients',\n        <a className=\"PrivateDiscussionComposer-changeRecipients\" onclick={this.chooseRecipients.bind(this)}>\n          {recipients.length ? (\n            recipientCountLabel(recipients.length)\n          ) : (\n            <span className=\"RecipientLabel none\">{app.translator.trans('fof-byobu.forum.buttons.add_recipients')}</span>\n          )}\n        </a>,\n        5\n      );\n    }\n\n    return items;\n  }\n\n  addDefaultRecipients(username) {\n    const user = app.store.getBy('users', 'username', username);\n\n    this.composer.fields.recipients.add('users:' + app.session.user.id(), app.session.user);\n\n    if (user.id() !== app.session.user.id()) {\n      this.composer.fields.recipients.add('users:' + user.id(), user);\n    }\n  }\n\n  onsubmit() {\n    this.loading = true;\n\n    const recipients = this.composer.fields.recipients.toArray();\n\n    if (recipients.length < 2) {\n      this.chooseRecipients();\n\n      this.loading = false;\n    } else {\n      const data = this.data();\n\n      app.store\n        .createRecord('discussions')\n        .save(data)\n        .then((discussion) => {\n          if (app.cache.discussionList) {\n            app.cache.discussionList.refresh();\n          }\n          m.route.set(app.route.discussion(discussion));\n\n          app.composer.hide();\n        }, this.loaded.bind(this));\n    }\n  }\n}\n","import app from 'flarum/forum/app';\n\nexport default function recipientCountLabel(count, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'RecipientLabel ' + (attrs.className || '');\n\n  var label = app.translator.trans('fof-byobu.forum.labels.recipients', { count });\n\n  return m('span', attrs, <span className=\"RecipientLabel-text\">{label}</span>);\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","import app from 'flarum/forum/app';\n\nexport default function canStartPrivateDiscussion(recipient) {\n  return (\n    app.session.user &&\n    app.session.user.id() !== recipient.id() &&\n    app.forum.attribute('canStartPrivateDiscussion') &&\n    (!recipient.blocksPd() || (app.forum.attribute('canStartPrivateDiscussionWithBlockers') && recipient.cannotBeDirectMessaged()))\n  );\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\nimport UserControls from 'flarum/forum/utils/UserControls';\nimport PrivateDiscussionComposer from './../pages/discussions/PrivateDiscussionComposer';\nimport Button from 'flarum/common/components/Button';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport canStartPrivateDiscussion from '../helpers/canStartPrivateDiscussion';\n\nexport default () => {\n  attributes();\n  message();\n  sharedMessageHistory();\n};\n\nfunction message() {\n  extend(UserControls, 'userControls', function (items, user) {\n    if (canStartPrivateDiscussion(user)) {\n      items.add(\n        'private-discussion',\n        Button.component(\n          {\n            icon: app.forum.attribute('byobu.icon-badge'),\n            onclick: (e) => {\n              e.preventDefault();\n\n              return new Promise((resolve) => {\n                let recipients = new ItemList();\n                recipients.add('users:' + app.session.user.id(), app.session.user);\n                recipients.add('users:' + user.id(), user);\n\n                PrivateDiscussionComposer.prototype.recipients = recipients;\n\n                app.composer.load(PrivateDiscussionComposer, {\n                  user: app.session.user,\n                  recipients: recipients,\n                  recipientUsers: recipients,\n                  titlePlaceholder: app.translator.trans('fof-byobu.forum.composer_private_discussion.title_placeholder'),\n                  submitLabel: app.translator.trans('fof-byobu.forum.composer_private_discussion.submit_button'),\n                });\n                app.composer.show();\n\n                return resolve(app.composer);\n              });\n            },\n          },\n          app.translator.trans('fof-byobu.forum.buttons.send_pd', { username: user.username() })\n        )\n      );\n    }\n\n    return items;\n  });\n}\n\nfunction sharedMessageHistory() {\n  extend(UserPage.prototype, 'navItems', function (items) {\n    const href = app.route('byobuUserPrivate', { username: this.user.slug() });\n\n    // Hide links from guests if they are not already on the page\n    if (!app.session.user && m.route.get() !== href) return;\n    // Hide link for your own page.\n    if (app.session.user === this.user) return;\n\n    items.add(\n      'byobu',\n      LinkButton.component(\n        {\n          href,\n          icon: app.forum.attribute('byobu.icon-badge'),\n        },\n        app.translator.trans('fof-byobu.forum.user.byobu_link')\n      ),\n      85\n    );\n  });\n}\n\nfunction attributes() {\n  User.prototype.blocksPd = Model.attribute('blocksPd');\n  User.prototype.cannotBeDirectMessaged = Model.attribute('cannotBeDirectMessaged');\n  User.prototype.unreadPrivateMessagesCount = Model.attribute('unreadPrivateMessagesCount');\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","import DiscussionListState from 'flarum/forum/states/DiscussionListState';\n\nexport default class PrivateDiscussionListState extends DiscussionListState {}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Dropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/listItems'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","import DiscussionList from 'flarum/forum/components/DiscussionList';\n\nexport default class PrivateDiscussionList extends DiscussionList {}\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","import app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport PrivateDiscussionComposer from './discussions/PrivateDiscussionComposer';\n\nexport default class PrivateComposing {\n  constructor(recipient) {\n    this.recipient = recipient;\n  }\n\n  action(e) {\n    e.preventDefault();\n\n    return new Promise((resolve, reject) => {\n      if (app.session.user) {\n        let recipients = new ItemList();\n\n        recipients.add('users:' + app.session.user.id(), app.session.user);\n\n        if (this.recipient && app.session.user.id() !== this.recipient.id()) {\n          recipients.add('users:' + this.recipient.id(), this.recipient);\n        }\n\n        app.composer.load(PrivateDiscussionComposer, {\n          user: app.session.user,\n          recipients: recipients,\n          recipientUsers: recipients,\n        });\n\n        app.composer.show();\n\n        return resolve();\n      } else {\n        app.modal.show(LogInModal);\n\n        return reject();\n      }\n    });\n  }\n\n  component() {\n    return Button.component(\n      {\n        icon: 'fas fa-pen',\n        className: 'Button Button--primary IndexPage-newDiscussion',\n        itemClassName: 'App-primaryControl fof-byobu_primaryControl',\n        onclick: this.action.bind(this),\n        disabled: !this.canStartDiscussion,\n      },\n      app.translator.trans(this.canStartDiscussion ? 'fof-byobu.forum.nav.start_button' : 'core.forum.index.cannot_start_discussion_button')\n    );\n  }\n\n  get canStartDiscussion() {\n    return app.session.user && app.forum.attribute('canStartPrivateDiscussion');\n  }\n}\n","import app from 'flarum/forum/app';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport PrivateDiscussionListState from '../states/PrivateDiscussionListState';\nimport Button from 'flarum/common/components/Button';\nimport Dropdown from 'flarum/common/components/Dropdown';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport listItems from 'flarum/common/helpers/listItems';\nimport PrivateDiscussionList from './discussions/PrivateDiscussionList';\nimport PrivateComposing from './PrivateComposing';\nimport canStartPrivateDiscussion from '../helpers/canStartPrivateDiscussion';\n\nexport default class PrivateDiscussionsUserPage extends UserPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.changeSort('latest');\n  }\n\n  show(user) {\n    // We can not create the list in init because the user will not be available if it has to be loaded asynchronously\n    this.list = new PrivateDiscussionListState({\n      q: `byobu:${user.slug()} is:private`,\n      sort: this.sort,\n    });\n\n    this.list.refresh();\n\n    // We call the parent method after creating the list, this way the this.list property\n    // is set before content() is called for the first time\n    super.show(user);\n  }\n\n  handleChangeSort(sort, e) {\n    e.preventDefault();\n\n    this.changeSort(sort);\n  }\n\n  changeSort(sort) {\n    this.sort = sort;\n    this.loadUser(m.route.param('username'));\n  }\n\n  content() {\n    return (\n      <div className=\"DiscussionsUserPage\">\n        <div className=\"DiscussionsUserPage-toolbar\">\n          <ul className=\"DiscussionsUserPage-toolbar-action\">{listItems(this.actionItems().toArray())}</ul>\n          <ul className=\"DiscussionsUserPage-toolbar-view\">{listItems(this.viewItems().toArray())}</ul>\n        </div>\n        <PrivateDiscussionList state={this.list}></PrivateDiscussionList>\n      </div>\n    );\n  }\n\n  actionItems() {\n    let composing = new PrivateComposing(this.user);\n\n    const items = new ItemList();\n\n    if (canStartPrivateDiscussion(this.user)) {\n      items.add('start_private', composing.component());\n    }\n\n    return items;\n  }\n\n  viewItems() {\n    const items = new ItemList();\n    const sortMap = this.list.sortMap();\n\n    const sortOptions = {};\n    for (const i in sortMap) {\n      sortOptions[i] = app.translator.trans('core.forum.index_sort.' + i + '_button');\n    }\n\n    items.add(\n      'sort',\n      Dropdown.component(\n        {\n          buttonClassName: 'Button',\n          label: sortOptions[this.sort] || Object.keys(sortMap).map((key) => sortOptions[key])[0],\n        },\n        Object.keys(sortOptions).map((value) => {\n          const label = sortOptions[value];\n          const active = (this.sort || Object.keys(sortMap)[0]) === value;\n\n          return Button.component(\n            {\n              icon: active ? 'fas fa-check' : true,\n              onclick: this.handleChangeSort.bind(this, value),\n              active: active,\n            },\n            label\n          );\n        })\n      )\n    );\n\n    return items;\n  }\n}\n","import app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport PrivateDiscussionsUserPage from './PrivateDiscussionsUserPage';\n\nexport default () => {\n  app.routes.byobuUserPrivate = { path: '/u/:username/private', component: PrivateDiscussionsUserPage };\n  app.routes.byobuPrivate = { path: '/private', component: IndexPage };\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/NotificationGrid'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/Notification'];","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\n\nexport default class PrivateDiscussionNotification extends Notification {\n  icon() {\n    return app.forum.attribute('byobu.icon-badge');\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    const user = this.attrs.notification.fromUser();\n    return app.translator.trans('fof-byobu.forum.notifications.pd_text', {\n      user: user,\n    });\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\n\nexport default class PrivateDiscussionReplyNotification extends Notification {\n  icon() {\n    return 'fas fa-reply';\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const discussion = notification.subject();\n    const content = notification.content() || {};\n\n    return app.route.discussion(discussion, content.postNumber);\n  }\n\n  content() {\n    const user = this.attrs.notification.fromUser();\n    return app.translator.trans('fof-byobu.forum.notifications.pd_reply_text', {\n      user: user,\n    });\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\n\nexport default class PrivateDiscussionUserLeftNotification extends Notification {\n  icon() {\n    return app.forum.attribute('byobu.icon-badge');\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    const user = this.attrs.notification.fromUser();\n    return app.translator.trans('fof-byobu.forum.notifications.pd_user_left_text', {\n      user: user,\n    });\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\n\nexport default class PrivateDiscussionAddedNotification extends Notification {\n  icon() {\n    return app.forum.attribute('byobu.icon-badge');\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    const user = this.attrs.notification.fromUser();\n    return app.translator.trans('fof-byobu.forum.notifications.pd_added_text', {\n      user: user,\n    });\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/Notification'];","import app from 'flarum/forum/app';\nimport Notification from 'flarum/components/Notification';\n\nexport default class PrivateDiscussionMadePublicNotification extends Notification {\n  icon() {\n    return app.forum.attribute('byobu.icon-badge');\n  }\n\n  href() {\n    const notification = this.props.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    const user = this.props.notification.fromUser();\n    return app.translator.trans('fof-byobu.forum.notifications.pd_made_public_text', {\n      user: user,\n    });\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","import AddRecipientModal from './AddRecipientModal';\n\nexport const modals = {\n  AddRecipientModal: AddRecipientModal,\n};\n","import PrivateDiscussionComposer from './PrivateDiscussionComposer';\nimport PrivateDiscussionList from './PrivateDiscussionList';\n\nexport const discussions = {\n  PrivateDiscussionComposer: PrivateDiscussionComposer,\n  PrivateDiscussionList: PrivateDiscussionList,\n};\n","import app from 'flarum/forum/app';\nimport events from './events';\nimport extend from './extend';\nimport pages from './pages';\nimport notifications from './notifications';\n\nexport * from './modals';\nexport * from './pages/discussions';\n\napp.initializers.add('fof-byobu', function () {\n  events();\n  extend();\n\n  pages();\n  notifications();\n});\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport PrivateComposing from './PrivateComposing';\n\nexport default () => {\n  extend(IndexPage.prototype, 'navItems', (items) => {\n    const user = app.session.user;\n\n    if (user) {\n      items.add(\n        'privateDiscussions',\n        LinkButton.component(\n          {\n            icon: app.forum.data.attributes['byobu.icon-badge'],\n            href: app.route('byobuPrivate'),\n          },\n          app.translator.trans('fof-byobu.forum.nav.nav_item')\n        ),\n        75\n      );\n    }\n  });\n\n  extend(IndexPage.prototype, 'setTitle', function () {\n    if (app.current.get('routeName') === 'byobuPrivate') {\n      app.setTitle(app.translator.trans('fof-byobu.forum.user.dropdown_label'));\n    }\n  });\n\n  extend(DiscussionListState.prototype, 'requestParams', function (params) {\n    if (app.current.get('routeName') === 'byobuPrivate') {\n      params.filter.q = (params.filter.q || '') + ' is:private';\n\n      params.include.push('recipientUsers');\n      params.include.push('recipientGroups');\n    }\n  });\n\n  extend(IndexPage.prototype, 'sidebarItems', function (items) {\n    if (app.current.get('routeName') === 'byobuPrivate') {\n      let compose = new PrivateComposing();\n\n      items.replace('newDiscussion', compose.component());\n    }\n  });\n};\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport NotificationGrid from 'flarum/forum/components/NotificationGrid';\nimport PrivateDiscussionNotification from './PrivateDiscussionNotification';\nimport PrivateDiscussionRepliedNotification from './PrivateDiscussionReplyNotification';\nimport PrivateDiscussionUserLeftNotification from './PrivateDiscussionUserLeftNotification';\nimport PrivateDiscussionAddedNotification from './PrivateDiscussionAddedNotification';\nimport PrivateDiscussionMadePublicNotification from './PrivateDiscussionMadePublicNotification';\n\nexport default function () {\n  app.notificationComponents.byobuPrivateDiscussionCreated = PrivateDiscussionNotification;\n  app.notificationComponents.byobuPrivateDiscussionReplied = PrivateDiscussionRepliedNotification;\n  app.notificationComponents.byobuRecipientRemoved = PrivateDiscussionUserLeftNotification;\n  app.notificationComponents.byobuPrivateDiscussionAdded = PrivateDiscussionAddedNotification;\n  app.notificationComponents.byobuPrivateDiscussionMadePubic = PrivateDiscussionMadePublicNotification;\n\n  grid();\n}\n\nfunction grid() {\n  // Add notification preferences.\n  extend(NotificationGrid.prototype, 'notificationTypes', function (items) {\n    items.add('byobuPrivateDiscussionCreated', {\n      name: 'byobuPrivateDiscussionCreated',\n      icon: app.forum.data.attributes['byobu.icon-badge'],\n      label: app.translator.trans('fof-byobu.forum.notifications.pd_label'),\n    });\n    items.add('byobuPrivateDiscussionReplied', {\n      name: 'byobuPrivateDiscussionReplied',\n      icon: app.forum.data.attributes['byobu.icon-badge'],\n      label: app.translator.trans('fof-byobu.forum.notifications.pd_reply_label'),\n    });\n    items.add('byobuPrivateDiscussionAdded', {\n      name: 'byobuPrivateDiscussionAdded',\n      icon: app.forum.data.attributes['byobu.icon-badge'],\n      label: app.translator.trans('fof-byobu.forum.notifications.pd_added_label'),\n    });\n    items.add('byobuRecipientRemoved', {\n      name: 'byobuRecipientRemoved',\n      icon: app.forum.data.attributes['byobu.icon-badge'],\n      label: app.translator.trans('fof-byobu.forum.notifications.pd_user_left_label'),\n    });\n  });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","create","constructor","MadePublic","initAttrs","attrs","icon","app","descriptionKey","EventPost","RecipientLeft","_objectWithoutPropertiesLoose","source","excluded","i","target","sourceKeys","keys","length","indexOf","RecipientLabel","view","vnode","label","this","recipient","link","newAttrs","style","className","classList","User","href","username","id","user","Group","class","namePlural","Component","recipientsLabel","recipients","otherAttrs","map","index","type","RecipientsModified","diff","diff1","diff2","store","filter","item","content","post","usersAdded","usersRemoved","groupsAdded","groupsRemoved","added","concat","removed","oldRecipients","newRecipients","localeBase","descriptionData","data","_extends","assign","arguments","apply","UserSearchSource","query","loading","name","children","highlight","text","avatar","undefined","q","page","limit","then","pushResults","bind","results","payload","result","push","m","redraw","GroupSearchSource","search","toLowerCase","group","substr","groupName","RecipientSearch","inputUuid","oninit","Math","random","toString","substring","oncreate","$search","$","on","e","addRecipient","focus","parentNode","clearTimeout","typingTimer","doSearch","setTimeout","searchState","getValue","setValue","sources","sourceItems","toArray","role","selected","onclick","removeRecipient","for","open","focused","active","loadingSources","dom","placeholder","extractText","oninput","onfocus","hasFocus","onblur","in","LoadingIndicator","size","items","ItemList","discussion","canEditUserRecipients","add","canEditGroupRecipients","values","split","findRecipient","clear","preventDefault","remove","Search","AddRecipientModal","Stream","assignInitialRecipients","selectedRecipients","merge","recipientSearch","SearchState","isDismissible","recipientUsers","recipientGroups","title","helpText","component","state","Button","hide","select","metaKey","ctrlKey","submit","onsubmit","forEach","save","relationships","DiscussionPage","Modal","ByobuTagDiscussionModal","tags","resolve","TagDiscussionModal","long","PrivateDiscussionComposer","_isByobuComposer","titlePlaceholder","submitLabel","composer","fields","route","param","addDefaultRecipients","users","groups","chooseRecipients","headerItems","count","recipientCountLabel","set","loaded","DiscussionComposer","canStartPrivateDiscussion","blocksPd","cannotBeDirectMessaged","PrivateDiscussionListState","DiscussionListState","PrivateDiscussionList","DiscussionList","_defineProperties","props","descriptor","configurable","writable","PrivateComposing","Constructor","protoProps","action","Promise","reject","LogInModal","itemClassName","disabled","canStartDiscussion","PrivateDiscussionsUserPage","changeSort","show","list","slug","sort","refresh","handleChangeSort","loadUser","listItems","actionItems","viewItems","composing","sortMap","sortOptions","Dropdown","buttonClassName","UserPage","PrivateDiscussionNotification","notification","subject","fromUser","excerpt","Notification","PrivateDiscussionReplyNotification","postNumber","PrivateDiscussionUserLeftNotification","PrivateDiscussionAddedNotification","PrivateDiscussionMadePublicNotification","modals","discussions","Discussion","Model","extend","badges","Badge","DiscussionListItem","DiscussionHero","params","include","DiscussionControls","canEditRecipients","find","isPrivateDiscussion","canMakePublic","confirm","extensions","public","update","SettingsPage","Switch","onchange","blocksPdLoading","UserControls","LinkButton","path","IndexPage","compose","replace","PrivateDiscussionRepliedNotification","NotificationGrid"],"sourceRoot":""}